import{j as e,$ as B,a0 as E,a1 as j,a2 as I,a3 as z,a4 as H,r as n,u as R,C as $,q as M,m as O,M as G,g as y,h as C,s as J,t as g,a as K,b as L,c as P}from"./index-DvA_wB1j.js";import{W as U}from"./WarehouseModal-DMvBjeny.js";const Y=({warehouses:u,onWarehouseClick:h})=>e.jsxs(B,{responsive:!0,hover:!0,children:[e.jsx(E,{children:e.jsx(j,{children:e.jsx(I,{children:"Depo Adı"})})}),e.jsx(z,{children:u.map(d=>e.jsx(j,{onClick:()=>h(d),style:{cursor:"pointer"},children:e.jsx(H,{children:d.adi})},d.id))})]}),f="https://speedsofttest.com/api",Q=()=>{const[u,h]=n.useState([]),[d,W]=n.useState([]),[k,c]=n.useState(!1),[x,i]=n.useState(!1),[p,m]=n.useState(null),S=n.useRef(),T=R(),o=(a,t="success")=>{const s=Date.now(),l=e.jsxs(K,{autohide:!0,visible:!0,delay:5e3,className:t==="error"?"bg-danger text-white":"bg-success text-white",children:[e.jsx(L,{closeButton:!0,children:e.jsx("strong",{className:"me-auto",children:t==="error"?"Hata":"Başarılı"})}),e.jsx(P,{children:a})]},s);return W(r=>[...r,l]),s},b=async()=>{var a,t;try{i(!0);const{data:s}=await g.get(`${f}/depo/get-all`),l=Array.isArray(s)?s.filter(r=>r.durumu===1):[];h(l)}catch(s){o(((t=(a=s.response)==null?void 0:a.data)==null?void 0:t.message)||"Depolar yüklenemedi.","error")}finally{i(!1)}};n.useEffect(()=>{b()},[]);const D=async a=>{var s,l;const t=JSON.parse(localStorage.getItem("user"))||{id:0};if(t.id===0){o("Geçerli bir kullanıcı oturumu bulunamadı.","error");return}try{i(!0);const r={adi:a.adi,durumu:1,KullaniciId:t.id},{data:v}=await g.post(`${f}/depo/create`,r);h(A=>[...A,v]),c(!1),o("Depo başarıyla eklendi.","success")}catch(r){o(((l=(s=r.response)==null?void 0:s.data)==null?void 0:l.message)||"Depo eklenemedi.","error")}finally{i(!1)}},F=async a=>{var s,l;const t=JSON.parse(localStorage.getItem("user"))||{id:0};if(t.id===0){o("Geçerli bir kullanıcı oturumu bulunamadı.","error");return}if(!p){o("Düzenlenecek depo bulunamadı.","error");return}try{i(!0);const r={...p,adi:a.adi,durumu:1,KullaniciId:t.id,guncellenmeTarihi:new Date().toISOString()};await g.put(`${f}/depo/update`,r),await b(),c(!1),m(null),o("Depo başarıyla güncellendi.","success")}catch(r){o(((l=(s=r.response)==null?void 0:s.data)==null?void 0:l.message)||"Depo güncellenemedi.","error")}finally{i(!1)}},w=a=>{m(a),c(!0)},N=a=>{T(`/app/warehouse-detail/${a.id}`,{state:{warehouse:a}})};return e.jsxs(e.Fragment,{children:[e.jsx($,{ref:S,placement:"top-end",className:"p-3",children:d.map(a=>a)}),e.jsx("div",{className:"d-flex gap-2 mb-3",children:e.jsxs(M,{color:"success",className:"text-light",onClick:()=>{m(null),c(!0)},disabled:x,children:[e.jsx(O,{icon:G,size:"m"})," Yeni Depo Ekle"]})}),x&&e.jsx(y,{className:"mb-3",children:e.jsx(C,{children:"Yükleniyor..."})}),e.jsxs(y,{className:"my-3",children:[e.jsx(J,{style:{backgroundColor:"#2965A8",color:"#FFFFFF",fontSize:"large",fontWeight:"bold"},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100",children:[e.jsx("span",{children:"Depolar"}),e.jsxs("div",{style:{backgroundColor:"#FFFFFF",color:"#2965A8",padding:"5px 10px",borderRadius:"4px",fontWeight:"bold",fontSize:"14px",minWidth:"40px",textAlign:"center"},children:["Toplam Depo: ",u.length]})]})}),e.jsxs(C,{children:[e.jsx("p",{children:"Bir depoya tıklayarak detaylarını görüntüleyebilirsiniz."}),e.jsx(Y,{warehouses:u,onWarehouseClick:N,onEditWarehouse:w})]})]}),e.jsx(U,{visible:k,onClose:()=>{c(!1),m(null)},onSubmit:p?F:D,loading:x,editingWarehouse:p})]})};export{Q as default};
