import{ah as Gs,J as Ps,u as Hs,r as i,j as e,t as g,g as I,s as v,h as T,q as p,C as Ks,e as j,f as n,m as D,B as Us,D as Os,E as qs,F as H,k as K,l as U,o as b,$ as O,a0 as q,a1 as F,a2 as o,an as le,a3 as J,a4 as u,a5 as Ye,a6 as Ge,N as ne,Q as de,S as ce,T as oe,i as be,U as C,W as ue,V as Ce,a as Js,b as Vs,c as _s}from"./index-DvA_wB1j.js";import{C as Qs}from"./CustomerModal-CMzspKBE.js";import{c as Pe,a as V}from"./cil-search-nEZ3-dQ_.js";import{C as Ws,a as _,b as Q,c as Xs,d as W}from"./CTabPane-JmNGvmD-.js";const f="https://speedsofttest.com/api",we=()=>{try{return(JSON.parse(localStorage.getItem("user"))||{id:0}).id}catch(h){return console.error("Kullanıcı ID'si alınırken hata:",h),0}},Zs=()=>{try{return parseInt(localStorage.getItem("selectedEdmId"))||null}catch(h){return console.error("Seçili EDM ID'si alınırken hata:",h),null}},gr=()=>{var ze;const{id:h}=Gs(),{state:he}=Ps(),Ie=Hs(),[S,He]=i.useState((he==null?void 0:he.customer)||null),[me,ve]=i.useState([]),[Ke,Te]=i.useState([]),[Ue,Oe]=i.useState([]),[N,qe]=i.useState({total:0,status:"neutral"}),[er,sr]=i.useState([]),[rr,ar]=i.useState([]),[Je,Ve]=i.useState([]),[_e,De]=i.useState([]),[tr,ir]=i.useState(!1),[lr,nr]=i.useState(null),[dr,cr]=i.useState(""),[Qe,X]=i.useState(!1),[We,Z]=i.useState(!1),[Xe,Ze]=i.useState(null),[es,Be]=i.useState(!1),[or,ss]=i.useState(!1),[m,B]=i.useState({adi:"",adres:"",kodu:"",aktif:!0}),[ur,rs]=i.useState({tutar:"",aciklama:"",musteriId:h,musteriSatisId:null}),[x,R]=i.useState({barkod:"",urunAdi:"",fiyat:"",birim:"adet",miktar:"",toplamFiyat:"",musteriId:h,urunId:"",depoId:""}),[hr,mr]=i.useState([]),[as,xe]=i.useState({}),[M,y]=i.useState(!1),[xr,Ae]=i.useState(null),[ts,is]=i.useState([]),[ls,je]=i.useState(!1),[ns,Fe]=i.useState([]),[ds,ee]=i.useState(!1),[jr,Me]=i.useState(!1),[kr,cs]=i.useState(null),[se,os]=i.useState([]),[E,re]=i.useState([]),[c,Ne]=i.useState(we()),[A,z]=i.useState("sales"),[ke,us]=i.useState(()=>{const s=localStorage.getItem(`invoicedSales_${h}`);return s?new Set(JSON.parse(s)):new Set}),[$e,hs]=i.useState(""),[Le,ms]=i.useState(""),[fe,xs]=i.useState(""),[ye,js]=i.useState(""),[pe,ks]=i.useState("");i.useEffect(()=>{const s=r=>{if(r.key==="user"){const t=we();Ne(t)}};window.addEventListener("storage",s);const a=we();return Ne(a),()=>window.removeEventListener("storage",s)},[]),i.useEffect(()=>{localStorage.setItem(`invoicedSales_${h}`,JSON.stringify([...ke]))},[ke,h]);const l=i.useCallback((s,a="success")=>{const r=e.jsxs(Js,{autohide:!0,visible:!0,delay:5e3,children:[e.jsx(Vs,{closeButton:!0,children:e.jsx("strong",{className:"me-auto",children:a==="error"?"Hata":a==="warning"?"Uyarı":"Başarılı"})}),e.jsx(_s,{children:s})]},Date.now());is(t=>[...t,r])},[]),fs=()=>{re([]),rs({tutar:"",aciklama:"",musteriId:h,musteriSatisId:null}),ss(!0)},ae=async(s,a)=>{var r,t,d,w;try{const{data:k}=await g.get(s),L=Array.isArray(k)?k.filter(Ys=>Ys.durumu===1):(k==null?void 0:k.durumu)===1?[k]:[];return a(L),L}catch(k){return console.error("Veri Yükleme Hatası:",{url:s,message:k.message,status:(r=k.response)==null?void 0:r.status,data:(t=k.response)==null?void 0:t.data}),l(((w=(d=k.response)==null?void 0:d.data)==null?void 0:w.message)||"Veriler yüklenemedi.","error"),null}},Y=i.useCallback(async()=>{try{const{data:s}=await g.get(`${f}/musteriSatis/musteriCari-get-by-musteri/${h}`);Oe(s||[]),Ve(s.filter(a=>a.islemTuruId===1003)||[])}catch{l("Cari hareketler yüklenemedi.","error")}},[h,l]),G=i.useCallback(async()=>{try{const{data:s}=await g.get(`${f}/musteriSatis/musteriCari-bakiye-get-by-musteri/${h}`);qe(s||{total:0,status:"neutral"})}catch{l("Bakiye hesaplanamadı.","error")}},[h,l]),te=async()=>{try{const{data:s}=await g.get(`${f}/musteriSatis/musteriSatis-faturaget-all`),a=s.map(r=>({...r,faturaDurumu:r.faturaDurumu!==void 0?r.faturaDurumu:ke.has(r.satisId)?1:0}));Te(a||[])}catch(s){console.error("Gruplanmış satışları getirme hatası:",s),l("Gruplanmış satışlar yüklenemedi.","error")}},ys=async s=>{var r,t;if(!c||c===0){l("Kullanıcı kimliği bulunamadı. Lütfen oturum açın.","error");return}const a=Zs();if(!a){l("Lütfen bir EDM seçin.","error");return}y(!0);try{const d=[{SatisId:s.toString()}],w=await g.post(`${f}/FaturaEkle/generate-invoice-list?EDMId=${a}`,d);w.status===200||w.data.success?(l(`Satış ID ${s} için fatura oluşturuldu.`,"success"),us(k=>new Set([...k,s])),Te(k=>k.map(L=>L.satisId===s?{...L,faturaDurumu:1}:L))):l("Fatura oluşturulamadı.","error")}catch(d){console.error("Fatura oluşturma hatası:",d),l(((t=(r=d.response)==null?void 0:r.data)==null?void 0:t.message)||"Fatura oluşturulamadı.","error")}finally{y(!1)}},ps=async s=>{let a="Bilinmiyor";try{if(s.musteriSiniflandirmaId){const r=ns.find(t=>t.id===s.musteriSiniflandirmaId);if(r)a=r.adi;else{const t=await ae(`${f}/musteriSiniflandirma/get-by-id/${s.musteriSiniflandirmaId}`,Fe);a=t&&t.length>0?t[0].adi:"Bilinmiyor"}}}catch(r){console.error("Dönüşüm Hatası:",r),a="Bilinmiyor"}return{id:s.id,name:s.unvani||"Bilinmiyor",openBalance:s.acilisBakiye||0,chequeBalance:0,bondBalance:0,turnover:0,phone:s.telefon||"",phone2:s.telefon2||"",classification:a,email:s.email||"",address:s.adres||"",taxOffice:s.vergiDairesi||"",taxOrIdNumber:s.vergiNumarasi||"",accountingCode:s.kodu||"",note:s.aciklama||"",currency:s.paraBirimi||"TRY",riskLimit:s.riskLimiti||0,dueDate:s.vade||"",isTaxExempt:s.vergiMuaf||!1,bankInfo:s.bankaBilgileri||"",contactPerson:s.yetkiliKisi||"",otherContact:s.diger||"",image:s.fotograf||null}},Ee=i.useCallback(async()=>{var s,a,r,t;y(!0);try{await ae(`${f}/musteriSiniflandirma/get-all`,Fe);const{data:d}=await g.get(`${f}/musteri/musteri-get-by-id/${h}`),w=Array.isArray(d)?d[0]:d;if(!w||w.durumu!==1)throw new Error("Müşteri bulunamadı veya aktif değil.");const k=await ps(w);He(k),Ae(null)}catch(d){console.error("Müşteri Yükleme Hatası:",{message:d.message,status:(s=d.response)==null?void 0:s.status,data:(a=d.response)==null?void 0:a.data}),Ae(((t=(r=d.response)==null?void 0:r.data)==null?void 0:t.message)||"Müşteri yüklenemedi."),l("Müşteri yüklenemedi.","error")}finally{y(!1)}},[h,l]),ie=async()=>{try{const s=await ae(`${f}/sube/sube-get-by-musteriId/${h}`,De);s&&De(s)}catch{l("Şube verileri yüklenemedi.","error")}},P=async()=>{try{const s=await ae(`${f}/musteriSatis/musteriSatis-get-by-musteri/${h}`,ve);s&&ve(s)}catch{l("Satış verileri yüklenemedi.","error")}},Ss=async()=>{try{const{data:s}=await g.get(`${f}/urun/urun-get-all`);os(s)}catch(s){console.error("Ürünleri Getirme Hatası:",s),l("Ürünler yüklenemedi.","error")}},Se=async s=>{try{const{data:a}=await g.get(`${f}/urun/urun-depolardaki-stoklar/${s}`);if(Array.isArray(a)){const r=a.filter(t=>t.durumu===1);xe(t=>({...t,[s]:r}))}else throw new Error("Depo verisi dizi formatında değil.")}catch(a){console.error("Depoları Getirme Hatası:",a),l(`Ürün ID ${s} için depolar yüklenemedi.`,"error"),xe(r=>({...r,[s]:[]}))}},gs=(s,a)=>{let r;return function(...d){const w=()=>{clearTimeout(r),s(...d)};clearTimeout(r),r=setTimeout(w,a)}},bs=async s=>{if(!(!s||s.length<3))try{const{data:a}=await g.get(`${f}/urun/urun-get-barcode?barkod=${s}`);if(a&&a.length>0){const r=a[0];R(t=>({...t,barkod:s,urunAdi:r.adi||"",fiyat:r.satisFiyat?r.satisFiyat.toString():"",birim:r.birimAdi||"adet",miktar:t.miktar||"1",toplamFiyat:t.miktar?(parseFloat(t.miktar)*r.satisFiyat).toFixed(2):r.satisFiyat.toString(),musteriId:h,urunId:r.id.toString(),depoId:""})),await Se(r.id),r.stokMiktari!==void 0&&r.stokMiktari<=0?l("Uyarı: Bu ürün stokta yok!","warning"):r.kritikStok&&r.stokMiktari<=r.kritikStok&&l(`Uyarı: Stok kritik seviyede (${r.stokMiktari} adet)`,"warning")}else l("Ürün bulunamadı.","error")}catch(a){console.error("Barkod ile ürün getirme hatası:",a),l("Ürün yüklenemedi.","error")}},Cs=i.useCallback(gs(s=>{bs(s)},800),[]),ws=async()=>{var s,a;if(!m.adi){l("Şube adı zorunludur.","error");return}if(!h||isNaN(parseInt(h))){l("Geçersiz müşteri ID'si.","error");return}if(!c||c===0){l("Kullanıcı kimliği bulunamadı. Lütfen oturum açın.","error");return}y(!0);try{const r={adi:m.adi,adres:m.adres||"",kodu:m.kodu||"",aktif:m.aktif?1:0,musteriId:parseInt(h),kullaniciId:c},{data:t}=await g.post(`${f}/sube/sube-create`,r);l(t.message||"Şube başarıyla eklendi.","success"),await ie(),X(!1),B({adi:"",adres:"",kodu:"",aktif:!0})}catch(r){console.error("Şube Ekleme Hatası:",r),l(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.message)||"Şube eklenemedi.","error")}finally{y(!1)}},Is=s=>{Ze(s),B({adi:s.adi,adres:s.adres,kodu:s.kodu,aktif:s.aktif===1}),Z(!0)},vs=async()=>{var s,a;if(!m.adi){l("Şube adı zorunludur.","error");return}if(!c||c===0){l("Kullanıcı kimliği bulunamadı. Lütfen oturum açın.","error");return}y(!0);try{const r={id:Xe.id,adi:m.adi,adres:m.adres||"",kodu:m.kodu||"",aktif:m.aktif?1:0,musteriId:parseInt(h),kullaniciId:c};await g.put(`${f}/sube/sube-update`,r),l("Şube güncellendi.","success"),Z(!1),await ie()}catch(r){l(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.message)||"Şube güncellenemedi.","error")}finally{y(!1)}},Ts=async s=>{var a,r;if(!c||c===0){l("Kullanıcı kimliği bulunamadı. Lütfen oturum açın.","error");return}y(!0);try{await g.delete(`${f}/sube/sube-delete/${s}?kullaniciId=${c}`),l("Şube başarıyla silindi.","success"),await ie()}catch(t){console.error("Şube Silme Hatası:",t),l(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.message)||"Şube silinemedi.","error")}finally{y(!1)}},Ds=s=>{var a,r;if(cs(s),R({id:s.id,barkod:s.barkod,urunAdi:s.urunAdi,fiyat:s.fiyat.toString(),birim:s.birim,miktar:s.miktar.toString(),toplamFiyat:s.toplamFiyat.toString(),musteriId:h,urunId:((a=se.find(t=>t.barkod===s.barkod))==null?void 0:a.id.toString())||"",depoId:((r=s.depoId)==null?void 0:r.toString())||""}),s.barkod){const t=se.find(d=>d.barkod===s.barkod);t&&Se(t.id)}Me(!0)},$=s=>{const{name:a,value:r}=s.target;if(R(t=>({...t,[a]:r})),a==="fiyat"||a==="miktar"){const t=a==="fiyat"?parseFloat(r)||0:parseFloat(x.fiyat)||0,d=a==="miktar"?parseFloat(r)||0:parseFloat(x.miktar)||0,w=(t*d).toFixed(2);R(k=>({...k,[a]:r,toplamFiyat:w}))}if(a==="barkod"&&Cs(r),a==="urunId"){const t=se.find(d=>d.id===parseInt(r));t&&(R(d=>({...d,urunId:r,barkod:t.barkod,urunAdi:t.adi,fiyat:t.satisFiyat.toString(),birim:t.birimAdi||"adet",miktar:d.miktar||"1",toplamFiyat:d.miktar?(parseFloat(d.miktar)*t.satisFiyat).toFixed(2):t.satisFiyat.toString(),depoId:""})),Se(t.id))}},Bs=async()=>{var s,a;if(!x.barkod||!x.urunAdi||!x.fiyat||!x.miktar||!x.depoId){l("Tüm alanlar (barkod, ürün adı, fiyat, miktar, depo) doldurulmalıdır.","error");return}if(!c||c===0){l("Kullanıcı kimliği bulunamadı. Lütfen oturum açın.","error");return}y(!0);try{const r={id:parseInt(x.id),barkod:x.barkod,urunAdi:x.urunAdi,fiyat:parseFloat(x.fiyat),birim:x.birim,miktar:parseFloat(x.miktar),toplamFiyat:parseFloat(x.toplamFiyat),musteriId:parseInt(h),kullaniciId:c,depoId:parseInt(x.depoId)};await g.put(`${f}/musteriSatis/musteriSatis-update`,r),l("Satış güncellendi.","success"),Me(!1),xe({}),P(),Y(),G(),te()}catch(r){l(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.message)||"Satış güncellenemedi.","error")}finally{y(!1)}},Re=i.useCallback(async s=>{var a,r;if(window.confirm(`${Array.isArray(s)?"Seçili satışları":"Bu satışı"} iptal etmek istediğinizden emin misiniz?`)){if(!c||c===0){l("Kullanıcı kimliği bulunamadı. Lütfen oturum açın.","error");return}y(!0);try{const t=Array.isArray(s)?[...new Set(s)]:[s];await Promise.all(t.map(async d=>{await g.post(`${f}/musteriSatis/musteriSatis-iptal`,null,{params:{satisId:d,kullaniciId:c}})})),l(`${t.length} satış iptal edildi.`),re([]),P(),Y(),G(),te()}catch(t){console.error("Satış İptal Hatası:",t),l(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.Message)||"Satış iptal edilemedi.","error")}finally{y(!1)}}},[l,P,Y,G,c]),As=s=>{re(a=>a.includes(s)?a.filter(r=>r!==s):[...a,s])},Fs=()=>{if(E.length===0){l("Lütfen en az bir satış seçin.","error");return}Re(E)},Ms=async s=>{var a,r;if(window.confirm("Bu satış kaydını silmek istediğinizden emin misiniz?")){if(!c||c===0){l("Kullanıcı kimliği bulunamadı. Lütfen oturum açın.","error");return}y(!0);try{await g.delete(`${f}/musteriSatis/musteriSatis-delete/${s}?kullaniciId=${c}`),l("Satış silindi.","success"),P(),Y(),G(),te()}catch(t){l(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.message)||"Satış silinemedi.","error")}finally{y(!1)}}},Ns=async()=>{var s,a;if(!c||c===0){l("Kullanıcı kimliği bulunamadı. Lütfen oturum açın.","error");return}ee(!1),y(!0);try{await g.delete(`${f}/musteri/musteri-delete/${S.id}?kullaniciId=${c}`),l("Müşteri silindi.","success"),Ie("/app/customers")}catch(r){console.error("Müşteri Silme Hatası:",r),l(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.message)||"Müşteri silinemedi.","error")}finally{y(!1)}};i.useEffect(()=>{h&&(Ee(),P(),ie(),Ss(),Y(),G(),te())},[h]);const ge=i.useMemo(()=>[...new Set(me.map(s=>s.satisId))],[me]),$s=me.filter(s=>s.satisId.toString().includes($e)),Ls=Ke.filter(s=>s.satisId.toString().includes(Le)),Es=Ue.filter(s=>{var a;return new Date(s.tarih).toLocaleDateString().includes(fe)||((a=s.aciklama)==null?void 0:a.includes(fe))}),Rs=Je.filter(s=>{var a;return new Date(s.tarih).toLocaleDateString().includes(ye)||((a=s.musteriSatisId)==null?void 0:a.toString().includes(ye))}),zs=_e.filter(s=>{var a,r;return((a=s.adi)==null?void 0:a.includes(pe))||((r=s.kodu)==null?void 0:r.includes(pe))});return M||!S?e.jsxs(I,{children:[e.jsx(v,{children:"Müşteri Bilgisi"}),e.jsxs(T,{children:[M?e.jsx("p",{children:"Yükleniyor..."}):e.jsx("p",{children:"Müşteri bulunamadı."}),e.jsx(p,{color:"primary",onClick:()=>Ie("/app/customers"),children:"Geri Dön"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ks,{placement:"top-end",className:"p-3",children:ts}),e.jsxs(j,{children:[e.jsx(n,{xs:12,children:e.jsxs(I,{children:[e.jsx(v,{style:{backgroundColor:"#2965A8",color:"#fff",fontSize:"24px"},children:e.jsxs(j,{className:"align-items-center",children:[e.jsx(n,{xs:2,children:e.jsx("img",{src:S.image?`https://speedsofttest.com/${S.image}`:"https://via.placeholder.com/100",alt:"Müşteri resmi",style:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"8px"}})}),e.jsxs(n,{xs:8,children:[e.jsx("h3",{children:S.name.toUpperCase()}),e.jsxs("p",{style:{fontSize:"14px"},children:[e.jsx("strong",{children:"Telefon:"})," ",S.phone]}),e.jsxs("p",{style:{fontSize:"14px"},children:[e.jsx("strong",{children:"Telefon 2:"})," ",S.phone2||"Yok"]}),e.jsxs("p",{style:{fontSize:"14px"},children:[e.jsx("strong",{children:"E-Posta:"})," ",S.email]}),e.jsxs("p",{style:{fontSize:"14px"},children:[e.jsx("strong",{children:"Adres:"})," ",S.address]}),e.jsxs("p",{style:{fontSize:"14px"},children:[e.jsx("strong",{children:"Vergi Dairesi/No:"})," ",S.taxOffice,"/",S.taxOrIdNumber]})]})]})}),e.jsx(T,{children:e.jsxs(j,{children:[e.jsx(n,{children:e.jsxs(I,{children:[e.jsxs(v,{className:N.status==="borclu"?"bg-danger":N.status==="alacakli"?"bg-success":"bg-secondary",style:{color:"white"},children:["Açık Bakiye (",N.status==="borclu"?"Borçlu":N.status==="alacakli"?"Alacaklı":"Nötr",")"]}),e.jsx(T,{children:e.jsxs("p",{className:"fw-bold",children:[Math.abs(N.total).toLocaleString("tr-TR")," TRY",N.status==="borclu"&&" (Borçlu)",N.status==="alacakli"&&" (Alacaklı)"]})})]})}),e.jsx(n,{children:e.jsxs(I,{children:[e.jsx(v,{className:"bg-warning",style:{color:"white"},children:"Çek Bakiyesi"}),e.jsx(T,{children:e.jsxs("p",{className:"fw-bold",children:[(S.chequeBalance||0).toLocaleString("tr-TR")," ","TRY"]})})]})}),e.jsx(n,{children:e.jsxs(I,{children:[e.jsx(v,{className:"bg-info",style:{color:"white"},children:"Senet Bakiyesi"}),e.jsx(T,{children:e.jsxs("p",{className:"fw-bold",children:[(S.bondBalance||0).toLocaleString("tr-TR")," ","TRY"]})})]})}),e.jsx(n,{children:e.jsxs(I,{children:[e.jsx(v,{className:"bg-success",style:{color:"white"},children:"Ciro"}),e.jsx(T,{children:e.jsxs("p",{className:"fw-bold",children:[(S.turnover||0).toLocaleString("tr-TR")," TRY"]})})]})})]})})]})}),e.jsx(n,{xs:12,className:"my-3 d-flex",children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(p,{color:"success",style:{color:"white"},onClick:()=>Be(!0),children:"Satış Yap"}),e.jsx(p,{color:"primary",style:{color:"white"},onClick:fs,children:"Ödeme Al"}),e.jsxs(p,{color:"warning",style:{color:"white"},onClick:Fs,disabled:E.length===0,children:[e.jsx(D,{icon:Pe})," Seçili Satışları İptal Et"]}),e.jsx(p,{color:"primary",style:{color:"white",backgroundColor:"#2965A8"},onClick:()=>X(!0),disabled:M,children:"Yeni Şube Ekle"}),e.jsxs(Us,{children:[e.jsx(Os,{color:"secondary",children:"Diğer İşlemler"}),e.jsxs(qs,{children:[e.jsx(H,{onClick:()=>je(!0),children:"Müşteri Bilgilerini Güncelle"}),e.jsx(H,{disabled:!0,children:"E-Posta Gönderi Durumu"}),e.jsx(H,{disabled:!0,children:"Alış Yap"}),e.jsx(H,{onClick:()=>ee(!0),children:"Müşteriyi Sil"}),e.jsx(H,{disabled:!0,children:"Etiket Yazdır"})]})]})]})}),e.jsxs(n,{xs:12,children:[e.jsxs(Ws,{variant:"tabs",role:"tablist",children:[e.jsx(_,{children:e.jsx(Q,{active:A==="sales",onClick:()=>z("sales"),children:"Önceki Satışlar"})}),e.jsx(_,{children:e.jsx(Q,{active:A==="groupedSales",onClick:()=>z("groupedSales"),children:"Gruplanmış Satışlar"})}),e.jsx(_,{children:e.jsx(Q,{active:A==="cari",onClick:()=>z("cari"),children:"Cari Hareketleri"})}),e.jsx(_,{children:e.jsx(Q,{active:A==="payments",onClick:()=>z("payments"),children:"Önceki Ödemeler"})}),e.jsx(_,{children:e.jsx(Q,{active:A==="branches",onClick:()=>z("branches"),children:"Şubeler"})})]}),e.jsxs(Xs,{children:[e.jsx(W,{visible:A==="sales",children:e.jsxs(I,{children:[e.jsx(v,{style:{backgroundColor:"#2965A8",color:"white"},children:e.jsxs(j,{className:"align-items-center",children:[e.jsx(n,{children:"Önceki Satışlar"}),e.jsx(n,{xs:4,children:e.jsxs(K,{children:[e.jsx(U,{children:e.jsx(D,{icon:V})}),e.jsx(b,{placeholder:"Satış ID Ara...",value:$e,onChange:s=>hs(s.target.value)})]})})]})}),e.jsx(T,{children:e.jsxs(O,{responsive:!0,striped:!0,hover:!0,children:[e.jsx(q,{color:"dark",children:e.jsxs(F,{children:[e.jsx(o,{children:e.jsx(le,{checked:E.length===ge.length,onChange:()=>re(E.length===ge.length?[]:ge)})}),e.jsx(o,{children:"Satış ID"}),e.jsx(o,{children:"Barkod"}),e.jsx(o,{children:"Ürün Adı"}),e.jsx(o,{children:"Fiyat"}),e.jsx(o,{children:"Birim"}),e.jsx(o,{children:"Miktar"}),e.jsx(o,{children:"Toplam Fiyat"}),e.jsx(o,{children:"Durumu"}),e.jsx(o,{children:"İşlemler"})]})}),e.jsx(J,{children:$s.map(s=>e.jsxs(F,{children:[e.jsx(u,{children:e.jsx(le,{checked:E.includes(s.satisId),onChange:()=>As(s.satisId)})}),e.jsx(u,{children:s.satisId}),e.jsx(u,{children:s.barkod}),e.jsx(u,{children:s.urunAdi}),e.jsxs(u,{children:[s.fiyat.toLocaleString("tr-TR")," TRY"]}),e.jsx(u,{children:s.birim}),e.jsx(u,{children:s.miktar}),e.jsxs(u,{children:[s.toplamFiyat.toLocaleString("tr-TR")," TRY"]}),e.jsx(u,{children:s.durumu===1?"Aktif":"İptal"}),e.jsx(u,{children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(p,{color:"info",size:"sm",onClick:()=>Ds(s),style:{color:"white"},children:e.jsx(D,{icon:Ye})}),e.jsx(p,{color:"danger",size:"sm",onClick:()=>Ms(s.id),style:{color:"white"},children:e.jsx(D,{icon:Ge})}),e.jsx(p,{color:"warning",size:"sm",onClick:()=>Re(s.satisId),style:{color:"white"},disabled:s.durumu===0,children:e.jsx(D,{icon:Pe})})]})})]},s.id))})]})})]})}),e.jsx(W,{visible:A==="groupedSales",children:e.jsxs(I,{children:[e.jsx(v,{style:{backgroundColor:"#2965A8",color:"white"},children:e.jsxs(j,{className:"align-items-center",children:[e.jsx(n,{children:"Gruplanmış Satışlar"}),e.jsx(n,{xs:4,children:e.jsxs(K,{children:[e.jsx(U,{children:e.jsx(D,{icon:V})}),e.jsx(b,{placeholder:"Satış ID Ara...",value:Le,onChange:s=>ms(s.target.value)})]})})]})}),e.jsx(T,{children:e.jsxs(O,{responsive:!0,striped:!0,hover:!0,children:[e.jsx(q,{color:"dark",children:e.jsxs(F,{children:[e.jsx(o,{children:"Satış ID"}),e.jsx(o,{children:"Tarih"}),e.jsx(o,{children:"Ürünler"}),e.jsx(o,{children:"Birimler"}),e.jsx(o,{children:"Toplam Fiyat"}),e.jsx(o,{children:"İşlemler"})]})}),e.jsx(J,{children:Ls.map(s=>e.jsxs(F,{children:[e.jsx(u,{children:s.satisId}),e.jsx(u,{children:new Date(s.eklenmeTarihi).toLocaleDateString()}),e.jsx(u,{children:s.urunAdi}),e.jsx(u,{children:s.birim}),e.jsxs(u,{children:[(s.toplamFiyat||0).toLocaleString("tr-TR")," TRY"]}),e.jsx(u,{children:e.jsx(p,{color:s.faturaDurumu===1?"secondary":"primary",size:"sm",onClick:()=>s.faturaDurumu===0&&ys(s.satisId),style:{color:"white"},disabled:M||s.faturaDurumu===1,children:s.faturaDurumu===1?"Fatura Kesildi":"Fatura Kes"})})]},s.satisId))})]})})]})}),e.jsx(W,{visible:A==="cari",children:e.jsxs(I,{children:[e.jsx(v,{style:{backgroundColor:"#2965A8",color:"white"},children:e.jsxs(j,{className:"align-items-center",children:[e.jsx(n,{children:"Cari Hareketleri"}),e.jsx(n,{xs:4,children:e.jsxs(K,{children:[e.jsx(U,{children:e.jsx(D,{icon:V})}),e.jsx(b,{placeholder:"Tarih veya Açıklama Ara...",value:fe,onChange:s=>xs(s.target.value)})]})})]})}),e.jsx(T,{children:e.jsxs(O,{responsive:!0,striped:!0,hover:!0,children:[e.jsx(q,{color:"dark",children:e.jsxs(F,{children:[e.jsx(o,{children:"Tarih"}),e.jsx(o,{children:"Tür"}),e.jsx(o,{children:"Açıklama"}),e.jsx(o,{children:"Tutar"}),e.jsx(o,{children:"Bakiye"})]})}),e.jsx(J,{children:Es.map((s,a)=>{var r;return e.jsxs(F,{children:[e.jsx(u,{children:new Date(s.tarih).toLocaleDateString()}),e.jsx(u,{children:s.islemTuruId===1001?"Satış":s.islemTuruId===1003?"Ödeme":"Diğer"}),e.jsx(u,{children:s.aciklama||"Yok"}),e.jsxs(u,{className:s.tutar<0?"text-danger":"text-success",children:[Math.abs(s.tutar).toLocaleString("tr-TR")," TRY ",s.tutar<0?"(Borç)":"(Alacak)"]}),e.jsxs(u,{children:[(r=s.bakiye)==null?void 0:r.toLocaleString("tr-TR")," TRY"]})]},a)})})]})})]})}),e.jsx(W,{visible:A==="payments",children:e.jsxs(I,{children:[e.jsx(v,{style:{backgroundColor:"#2965A8",color:"white"},children:e.jsxs(j,{className:"align-items-center",children:[e.jsx(n,{children:"Önceki Ödemeler"}),e.jsx(n,{xs:4,children:e.jsxs(K,{children:[e.jsx(U,{children:e.jsx(D,{icon:V})}),e.jsx(b,{placeholder:"Tarih veya Satış No Ara...",value:ye,onChange:s=>js(s.target.value)})]})})]})}),e.jsx(T,{children:e.jsxs(O,{responsive:!0,striped:!0,hover:!0,children:[e.jsx(q,{color:"dark",children:e.jsxs(F,{children:[e.jsx(o,{children:"Tarih"}),e.jsx(o,{children:"No"}),e.jsx(o,{children:"Durum"}),e.jsx(o,{children:"Tutar"})]})}),e.jsx(J,{children:Rs.map((s,a)=>e.jsxs(F,{children:[e.jsx(u,{children:new Date(s.tarih).toLocaleDateString()}),e.jsx(u,{children:s.musteriSatisId||"Yok"}),e.jsx(u,{children:s.islemTuruId===1003?"Ödeme":"Bilinmiyor"}),e.jsxs(u,{children:[(s.tutar||0).toLocaleString("tr-TR")," TRY"]})]},a))})]})})]})}),e.jsx(W,{visible:A==="branches",children:e.jsxs(I,{children:[e.jsx(v,{style:{backgroundColor:"#2965A8",color:"white"},children:e.jsxs(j,{className:"align-items-center",children:[e.jsx(n,{children:"Şubeler"}),e.jsx(n,{xs:4,children:e.jsxs(K,{children:[e.jsx(U,{children:e.jsx(D,{icon:V})}),e.jsx(b,{placeholder:"Şube Adı veya Kod Ara...",value:pe,onChange:s=>ks(s.target.value)})]})})]})}),e.jsx(T,{children:e.jsxs(O,{responsive:!0,striped:!0,hover:!0,children:[e.jsx(q,{color:"dark",children:e.jsxs(F,{children:[e.jsx(o,{children:"Şube Adı"}),e.jsx(o,{children:"Adres"}),e.jsx(o,{children:"Kod"}),e.jsx(o,{children:"Aktif"}),e.jsx(o,{children:"İşlemler"})]})}),e.jsx(J,{children:zs.map(s=>e.jsxs(F,{children:[e.jsx(u,{children:s.adi||"Bilinmiyor"}),e.jsx(u,{children:s.adres||"Yok"}),e.jsx(u,{children:s.kodu||"Yok"}),e.jsx(u,{children:s.aktif?"Evet":"Hayır"}),e.jsx(u,{children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(p,{color:"info",size:"sm",onClick:()=>Is(s),style:{color:"white"},children:e.jsx(D,{icon:Ye})}),e.jsx(p,{color:"danger",size:"sm",onClick:()=>Ts(s.id),style:{color:"white"},children:e.jsx(D,{icon:Ge})})]})})]},s.id))})]})})]})})]})]})]}),e.jsx(Qs,{visible:ls,onClose:()=>je(!1),customer:S,onSave:()=>{Ee(),je(!1)}}),e.jsxs(ne,{visible:Qe,onClose:()=>X(!1),children:[e.jsx(de,{children:e.jsx(ce,{children:"Yeni Şube Ekle"})}),e.jsx(oe,{children:e.jsxs(be,{children:[e.jsx(j,{className:"mb-3",children:e.jsxs(n,{children:[e.jsx(C,{children:"Şube Adı"}),e.jsx(b,{value:m.adi,onChange:s=>B({...m,adi:s.target.value}),required:!0})]})}),e.jsx(j,{className:"mb-3",children:e.jsxs(n,{children:[e.jsx(C,{children:"Adres"}),e.jsx(b,{value:m.adres,onChange:s=>B({...m,adres:s.target.value})})]})}),e.jsx(j,{className:"mb-3",children:e.jsxs(n,{children:[e.jsx(C,{children:"Kod"}),e.jsx(b,{value:m.kodu,onChange:s=>B({...m,kodu:s.target.value})})]})}),e.jsx(j,{className:"mb-3",children:e.jsx(n,{children:e.jsx(le,{label:"Aktif",checked:m.aktif,onChange:s=>B({...m,aktif:s.target.checked})})})})]})}),e.jsxs(ue,{children:[e.jsx(p,{color:"secondary",onClick:()=>X(!1),children:"İptal"}),e.jsx(p,{color:"primary",onClick:ws,disabled:M||!m.adi||!c||c===0,children:"Kaydet"})]})]}),e.jsxs(ne,{visible:We,onClose:()=>Z(!1),children:[e.jsx(de,{children:e.jsx(ce,{children:"Şube Güncelle"})}),e.jsx(oe,{children:e.jsxs(be,{children:[e.jsx(j,{className:"mb-3",children:e.jsxs(n,{children:[e.jsx(C,{children:"Şube Adı"}),e.jsx(b,{value:m.adi,onChange:s=>B({...m,adi:s.target.value}),required:!0})]})}),e.jsx(j,{className:"mb-3",children:e.jsxs(n,{children:[e.jsx(C,{children:"Adres"}),e.jsx(b,{value:m.adres,onChange:s=>B({...m,adres:s.target.value})})]})}),e.jsx(j,{className:"mb-3",children:e.jsxs(n,{children:[e.jsx(C,{children:"Kod"}),e.jsx(b,{value:m.kodu,onChange:s=>B({...m,kodu:s.target.value})})]})}),e.jsx(j,{className:"mb-3",children:e.jsx(n,{children:e.jsx(le,{label:"Aktif",checked:m.aktif,onChange:s=>B({...m,aktif:s.target.checked})})})})]})}),e.jsxs(ue,{children:[e.jsx(p,{color:"secondary",onClick:()=>Z(!1),children:"İptal"}),e.jsx(p,{color:"primary",onClick:vs,disabled:M||!m.adi||!c||c===0,children:"Güncelle"})]})]}),e.jsxs(ne,{visible:es,onClose:()=>Be(!1),size:"xl",children:[e.jsx(de,{children:e.jsx(ce,{children:"Satış Yap"})}),e.jsx(oe,{children:e.jsxs(be,{children:[e.jsxs(j,{className:"mb-3",children:[e.jsxs(n,{md:6,children:[e.jsx(C,{children:"Ürün Seç"}),e.jsxs(Ce,{name:"urunId",value:x.urunId,onChange:$,children:[e.jsx("option",{value:"",children:"Ürün Seçin"}),se.map(s=>e.jsxs("option",{value:s.id,children:[s.adi," (Barkod: ",s.barkod,", Fiyat: ",s.satisFiyat,")"]},s.id))]})]}),e.jsxs(n,{md:6,children:[e.jsx(C,{children:"Barkod"}),e.jsx(b,{name:"barkod",value:x.barkod,onChange:$})]})]}),e.jsxs(j,{className:"mb-3",children:[e.jsxs(n,{md:6,children:[e.jsx(C,{children:"Ürün Adı"}),e.jsx(b,{name:"urunAdi",value:x.urunAdi,onChange:$})]}),e.jsxs(n,{md:6,children:[e.jsx(C,{children:"Depo"}),e.jsxs(Ce,{name:"depoId",value:x.depoId,onChange:$,children:[e.jsx("option",{value:"",children:"Depo Seçin"}),x.urunId&&((ze=as[x.urunId])==null?void 0:ze.map(s=>{var a;return e.jsxs("option",{value:depo.depoId,children:[((a=depo.depo)==null?void 0:a.adi)||"Bilinmeyen Depo"," (Stok: ",depo.miktar,")"]},depo.depoId)}))]})]})]}),e.jsxs(j,{className:"mb-3",children:[e.jsxs(n,{md:4,children:[e.jsx(C,{children:"Fiyat"}),e.jsx(b,{name:"fiyat",type:"number",step:"0.01",value:x.fiyat,onChange:$})]}),e.jsxs(n,{md:4,children:[e.jsx(C,{children:"Birim"}),e.jsxs(Ce,{name:"birim",value:x.birim,onChange:$,children:[e.jsx("option",{value:"adet",children:"Adet"}),e.jsx("option",{value:"kg",children:"Kg"}),e.jsx("option",{value:"lt",children:"Lt"}),e.jsx("option",{value:"m",children:"Metre"})]})]}),e.jsxs(n,{md:4,children:[e.jsx(C,{children:"Miktar"}),e.jsx(b,{name:"miktar",type:"number",step:"0.01",value:x.miktar,onChange:$})]})]}),e.jsx(j,{className:"mb-3",children:e.jsxs(n,{children:[e.jsx(C,{children:"Toplam Fiyat"}),e.jsx(b,{value:x.toplamFiyat,readOnly:!0,disabled:!0})]})})]})}),e.jsx(ue,{children:e.jsx(p,{color:"primary",onClick:Bs,disabled:M||!x.depoId||!c,children:"Güncelle"})})]}),e.jsxs(ne,{visible:ds,onClose:()=>ee(!1),children:[e.jsx(de,{children:e.jsx(ce,{children:"Müşteriyi Sil"})}),e.jsx(oe,{children:e.jsxs("p",{children:[S.name," adlı müşteriyi silmek istediğinizden emin misiniz?"]})}),e.jsxs(ue,{children:[e.jsx(p,{color:"secondary",onClick:()=>ee(!1),children:"İptal"}),e.jsx(p,{color:"danger",onClick:Ns,disabled:M||!c,children:"Sil"})]})]})]})};export{gr as default};
