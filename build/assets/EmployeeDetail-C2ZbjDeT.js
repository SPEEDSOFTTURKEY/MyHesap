import{j as e,g as ve,s as De,h as Ae,m as K,n as $e,f as ke,q as j,X as Re,a6 as Be,B as Ee,D as Oe,E as Pe,F as je,ad as He,ae as Ue,r as p,Z as l,C as Le,a as Ve,b as Ge,c as qe,$ as _e,a0 as We,a1 as Me,a2 as ue,a3 as Je,a4 as he,af as Qe,N as ne,Q as ie,S as te,T as le,i as pe,ag as xe,U as g,V as w,ah as ge,o as J,W as oe,t as N,u as Xe,ai as Ze,J as ea,ac as aa,K as ra,aj as sa,e as na}from"./index-DtN76qeb.js";import{c as ia}from"./cil-money-Dk3vHnQB.js";import{c as ta}from"./cil-transfer-BeKoe_Wl.js";import{c as Te}from"./cil-file-CeQgYs_D.js";import{c as we}from"./cil-warning-C7g3f07Q.js";const la=({employee:i})=>e.jsxs(ve,{className:"mb-3 shadow-sm w-50",children:[e.jsx(De,{className:"p-3",style:{backgroundColor:"#2965A8",color:"#FFFFFF"},children:e.jsx("h4",{children:e.jsx("strong",{children:(i==null?void 0:i.adiSoyadi)||"Çalışan Bilgisi"})})}),e.jsxs(Ae,{className:"d-flex",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-center me-4",style:{width:"70px",height:"70px",borderRadius:"50%",overflow:"hidden",backgroundColor:"#e9ecef"},children:[i!=null&&i.fotograf?e.jsx("img",{src:i.fotograf,alt:"Çalışan Fotoğrafı",style:{width:"100%",height:"100%",objectFit:"cover"},onError:m=>{m.target.style.display="none",m.target.nextSibling.style.display="block"}}):null,e.jsx(K,{icon:$e,size:"xl",style:{display:i!=null&&i.fotograf?"none":"block"}})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Telefon:"})," ",(i==null?void 0:i.telefon)||"Bilinmiyor"]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"E-posta:"})," ",(i==null?void 0:i.email)||"Bilinmiyor"]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Bakiye:"})," ",(i==null?void 0:i.balance)||"Veri bulunamadı"]})]})]})]}),oa=({onUpdate:i,onDelete:m,onModalToggle:h,onExpense:M,onStatement:D,onDocuments:o,disableDocuments:Q})=>{const T={cursor:"pointer",padding:"8px 16px",fontSize:"14px","--cui-dropdown-link-hover-color":"#ffffff","--cui-dropdown-link-hover-bg":"#34A149","--cui-dropdown-link-active-color":"#ffffff","--cui-dropdown-link-active-bg":"#34A149"};return e.jsxs(ke,{className:"d-flex gap-2 flex-wrap",children:[e.jsxs(j,{className:"mx-1 text-white",color:"info",size:"sm",onClick:i,children:[e.jsx(K,{icon:Re})," Güncelle"]}),e.jsxs(j,{className:"mx-1 text-white",color:"danger",size:"sm",onClick:m,children:[e.jsx(K,{icon:Be})," Sil"]}),e.jsxs(Ee,{children:[e.jsxs(Oe,{className:"mx-1 text-white",color:"success",size:"sm",children:[e.jsx("span",{style:{fontSize:"medium"},children:"₺"})," Ödeme İşlemleri"]}),e.jsxs(Pe,{children:[e.jsx(je,{style:T,onClick:()=>h("accrual"),children:"Maaş/Prim Tahakkuku Yap"}),e.jsxs(je,{style:T,onClick:()=>h("payment"),children:[e.jsx(K,{icon:ia})," Ödeme Yap (Maaş/Prim/Avans)"]}),e.jsxs(je,{style:T,onClick:()=>h("advanceReturn"),children:[e.jsx(K,{icon:He})," Avans İadesi Al"]}),e.jsxs(je,{style:T,onClick:()=>h("debtCredit"),children:[e.jsx(K,{icon:ta})," Borç-Alacak Fişleri"]})]})]}),e.jsxs(j,{className:"mx-1 text-white",color:"danger",size:"sm",onClick:M,children:[e.jsx(K,{icon:Ue})," Masraf Kaydet"]}),e.jsxs(j,{className:"mx-1 text-white",color:"warning",size:"sm",onClick:D,children:[e.jsx(K,{icon:Te})," Hesap Ekstresi"]}),e.jsxs(j,{className:"mx-1 text-white",color:"secondary",size:"sm",onClick:o,disabled:Q,children:[e.jsx(K,{icon:Te})," Dökümanlar"]})]})},Ne="https://speedsofttest.com/api",ca=({transactions:i,loading:m,error:h,currency:M="TRY",onPrint:D,addToast:o,onRefresh:Q,expenseMainCategories:T,expenseSubCategories:ce})=>{const[q,ee]=p.useState(!1),[Y,U]=p.useState(!1),[k,B]=p.useState(null),[d,L]=p.useState({id:0,tarih:l(),masrafAnaKategoriId:"",masrafAltKategoriId:"",calisanId:0,durumu:"1",aciklama:"",borc:"",alacak:"",bakiye:""}),[u,z]=p.useState(!1),C=r=>{var y,S,A,E,X,s;B(r),L({id:r.id,tarih:r.tarih?l(r.tarih):l(),masrafAnaKategoriId:((y=r.masrafAnaKategoriId)==null?void 0:y.toString())||"",masrafAltKategoriId:((S=r.masrafAltKategoriId)==null?void 0:S.toString())||"",calisanId:r.calisanId,durumu:((A=r.durumu)==null?void 0:A.toString())||"1",aciklama:r.aciklama||"",borc:((E=r.borc)==null?void 0:E.toString())||"",alacak:((X=r.alacak)==null?void 0:X.toString())||"",bakiye:((s=r.bakiye)==null?void 0:s.toString())||""}),ee(!0)},$=r=>{B(r),U(!0)},ye=async()=>{var r,y;if(!(k!=null&&k.id)){o("Cari işlem ID'si eksik","hata");return}z(!0);try{await N.delete(`${Ne}/calisancari/calisancari-delete/${k.id}`,{headers:{accept:"*/*"}}),o("Cari işlem başarıyla silindi","başarılı"),Q()}catch(S){console.error("Cari işlem silinirken hata:",S),o("Cari işlem silinemedi: "+(((y=(r=S.response)==null?void 0:r.data)==null?void 0:y.message)||S.message),"hata")}finally{z(!1),U(!1),B(null)}},F=r=>{const{name:y,value:S}=r.target;L(A=>({...A,[y]:S,...y==="masrafAnaKategoriId"?{masrafAltKategoriId:""}:{}}))},be=async r=>{var y,S;r.preventDefault(),z(!0);try{const A={id:d.id,tarih:d.tarih.format("YYYY-MM-DD"),eklenmeTarihi:k.eklenmeTarihi||l().toISOString(),guncellenmeTarihi:l().toISOString(),masrafAnaKategoriId:parseInt(d.masrafAnaKategoriId)||0,masrafAltKategoriId:parseInt(d.masrafAltKategoriId)||0,calisanId:parseInt(d.calisanId),durumu:parseInt(d.durumu),aciklama:d.aciklama,borc:parseFloat(d.borc)||0,alacak:parseFloat(d.alacak)||0,bakiye:parseFloat(d.bakiye)||0};await N.put(`${Ne}/calisancari/calisancari-update`,A,{headers:{"Content-Type":"application/json",accept:"*/*"}}),o("Cari işlem başarıyla güncellendi","başarılı"),ee(!1),Q()}catch(A){console.error("Cari işlem güncellenirken hata:",A),o("Cari işlem güncellenemedi: "+(((S=(y=A.response)==null?void 0:y.data)==null?void 0:S.message)||A.message),"hata")}finally{z(!1)}},_=r=>{if(!r.masrafAnaKategoriId&&!r.masrafAltKategoriId)return"-";const y=T.find(E=>E.id===r.masrafAnaKategoriId),S=ce.find(E=>E.id===r.masrafAltKategoriId);let A="";return y&&(A+=y.adi),S&&(A+=A?` - ${S.adi}`:S.adi),A||"-"};return e.jsxs(e.Fragment,{children:[e.jsx(Le,{placement:"top-end",className:"p-3",children:h&&e.jsxs(Ve,{autohide:5e3,visible:!!h,color:"danger",children:[e.jsx(Ge,{closeButton:{label:"Kapat"},children:e.jsx("strong",{className:"me-auto",children:"Hata"})}),e.jsx(qe,{children:h})]})}),e.jsxs(ve,{className:"mb-3",children:[e.jsx(De,{className:"p-3",style:{backgroundColor:"#2965A8",color:"#ffffff"},children:e.jsx("h5",{children:"Önceki Cari İşlemler"})}),e.jsxs(Ae,{children:[m&&e.jsx("p",{children:"Yükleniyor..."}),!m&&!h&&i.length>0?e.jsxs(_e,{responsive:!0,children:[e.jsx(We,{children:e.jsxs(Me,{children:[e.jsx(ue,{children:"Tarih"}),e.jsx(ue,{children:"Masraf Kalemi"}),e.jsx(ue,{children:"Açıklama"}),e.jsx(ue,{children:"Borç"}),e.jsx(ue,{children:"Alacak"}),e.jsx(ue,{children:"Bakiye"}),e.jsx(ue,{children:"İşlemler"})]})}),e.jsx(Je,{className:"my-2",children:i.map(r=>e.jsxs(Me,{children:[e.jsx(he,{children:r.tarih?l(r.tarih).format("DD.MM.YYYY"):"-"}),e.jsx(he,{children:_(r)}),e.jsx(he,{children:r.aciklama||"-"}),e.jsx(he,{children:r.borc?`${r.borc.toLocaleString("tr-TR")} ${M}`:"-"}),e.jsx(he,{children:r.alacak?`${r.alacak.toLocaleString("tr-TR")} ${M}`:"-"}),e.jsx(he,{children:r.bakiye?`${r.bakiye.toLocaleString("tr-TR")} ${M}`:"-"}),e.jsxs(he,{children:[e.jsx(j,{color:"info",size:"sm",style:{color:"white",marginBottom:"3px"},onClick:()=>D("Yazdırma işlemi başlatıldı","başarılı"),className:"me-2",disabled:!0,children:e.jsx(K,{icon:Qe})}),e.jsx(j,{color:"warning",size:"sm",style:{color:"white",marginBottom:"3px"},onClick:()=>C(r),className:"me-2",disabled:u,children:e.jsx(K,{icon:Re})}),e.jsx(j,{color:"danger",size:"sm",style:{color:"white"},onClick:()=>$(r),disabled:u,children:e.jsx(K,{icon:Be})})]})]},r.id))})]}):!m&&!h&&e.jsx("p",{children:"Henüz işlem bulunmamaktadır."})]})]}),e.jsxs(ne,{visible:q,onClose:()=>ee(!1),backdrop:"static",keyboard:!1,children:[e.jsx(ie,{style:{backgroundColor:"#2965A2",color:"white"},children:e.jsx(te,{children:"Cari İşlem Düzenle"})}),e.jsx(le,{children:e.jsxs(pe,{onSubmit:be,children:[e.jsx(xe,{label:"Tarih",value:d.tarih,onChange:r=>L(y=>({...y,tarih:r}))}),e.jsx(g,{htmlFor:"masrafAnaKategoriId",className:"mt-3",children:"Masraf Ana Kategorisi"}),e.jsxs(w,{id:"masrafAnaKategoriId",name:"masrafAnaKategoriId",value:d.masrafAnaKategoriId,onChange:F,className:"mb-3",disabled:u,children:[e.jsx("option",{value:"",children:"Seçiniz"}),T.map(r=>e.jsx("option",{value:r.id,children:r.adi},r.id))]}),e.jsx(g,{htmlFor:"masrafAltKategoriId",className:"mt-3",children:"Masraf Alt Kategorisi"}),e.jsxs(w,{id:"masrafAltKategoriId",name:"masrafAltKategoriId",value:d.masrafAltKategoriId,onChange:F,className:"mb-3",disabled:u||!d.masrafAnaKategoriId,children:[e.jsx("option",{value:"",children:"Seçiniz"}),ce.filter(r=>{var y;return((y=r.masrafAnaKategoriId)==null?void 0:y.toString())===d.masrafAnaKategoriId}).map(r=>e.jsx("option",{value:r.id,children:r.adi},r.id))]}),e.jsx(g,{htmlFor:"durumu",className:"mt-3",children:"Durum"}),e.jsxs(w,{id:"durumu",name:"durumu",value:d.durumu,onChange:F,className:"mb-3",disabled:u,children:[e.jsx("option",{value:"1",children:"Aktif"}),e.jsx("option",{value:"0",children:"Pasif"})]}),e.jsx(g,{htmlFor:"aciklama",className:"mt-3",children:"Açıklama"}),e.jsx(ge,{id:"aciklama",name:"aciklama",rows:3,value:d.aciklama,onChange:F,className:"mb-3",disabled:u}),e.jsx(g,{htmlFor:"borc",className:"mt-3",children:"Borç"}),e.jsx(J,{type:"number",id:"borc",name:"borc",value:d.borc,onChange:F,placeholder:"0.00",step:"0.01",className:"mb-3",disabled:u}),e.jsx(g,{htmlFor:"alacak",className:"mt-3",children:"Alacak"}),e.jsx(J,{type:"number",id:"alacak",name:"alacak",value:d.alacak,onChange:F,placeholder:"0.00",step:"0.01",className:"mb-3",disabled:u}),e.jsx(g,{htmlFor:"bakiye",className:"mt-3",children:"Bakiye"}),e.jsx(J,{type:"number",id:"bakiye",name:"bakiye",value:d.bakiye,onChange:F,placeholder:"0.00",step:"0.01",className:"mb-3",disabled:u}),e.jsxs(oe,{children:[e.jsx(j,{color:"primary",type:"submit",disabled:u,children:"Kaydet"}),e.jsx(j,{color:"secondary",onClick:()=>ee(!1),disabled:u,children:"İptal"})]})]})})]}),e.jsxs(ne,{visible:Y,onClose:()=>{U(!1),B(null)},backdrop:"static",children:[e.jsx(ie,{style:{backgroundColor:"#DC3545",color:"white"},children:e.jsx(te,{children:"Silme Onayı"})}),e.jsx(le,{children:e.jsx("p",{children:"Bu cari işlemi silmek istediğinize emin misiniz? Bu işlem geri alınamaz."})}),e.jsxs(oe,{children:[e.jsx(j,{color:"secondary",style:{color:"white"},onClick:()=>{U(!1),B(null)},disabled:u,children:"Hayır"}),e.jsx(j,{color:"danger",style:{color:"white"},onClick:ye,disabled:u,children:"Evet"})]})]})]})},G="https://speedsofttest.com/api",da=({modalState:i,setModalState:m,employeeId:h,onSubmit:M,addToast:D})=>{var Se,Ye;const[o,Q]=p.useState([]),[T,ce]=p.useState([]),[q,ee]=p.useState([]),[Y,U]=p.useState({date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",expenseMainCategoryId:"",expenseSubCategoryId:"",description:""}),[k,B]=p.useState({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),[d,L]=p.useState({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),[u,z]=p.useState({transactionType:"Alacak",date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",description:"",expenseMainCategoryId:"",expenseSubCategoryId:""}),[C,$]=p.useState({date:l().format("YYYY-MM-DD"),documentNumber:"",expenseMainCategoryId:"",expenseSubCategoryId:"",amount:"",vatRate:"",currency:"TRY",description:""}),[ye,F]=p.useState(l()),[be,_]=p.useState(l()),[r,y]=p.useState(l()),[S,A]=p.useState(l()),[E,X]=p.useState(l()),[s,b]=p.useState(!1),ae=async()=>{var a,t,x;if(!(s||o.length>0&&T.length>0&&q.length>0))try{if(b(!0),!o.length){const c=await N.get(`${G}/Hesap/hesap-get-all`,{headers:{accept:"*/*"}}),I=Array.isArray(c.data)?c.data.map(f=>({id:f.id,userName:f.tanim,currency:f.paraBirimi,balance:f.guncelBakiye,accountNumber:f.hesapNo,labelColor:f.etiketRengi,spendingLimit:f.harcamaLimiti,type:f.hesapKategoriId})):[];Q(I)}if(!T.length){const c=await N.get(`${G}/masrafAnaKategori/masrafAnaKategori-get-all`,{headers:{accept:"*/*"}}),I=Array.isArray(c.data)?c.data:[];ce(I)}if(!q.length){const c=await N.get(`${G}/masrafAltKategori/masrafAltKategori-get-all`,{headers:{accept:"*/*"}}),I=Array.isArray(c.data)?c.data:[];ee(I)}}catch(c){console.error("Veri çekme hatası:",c,(a=c.response)==null?void 0:a.data),D("Hesaplar veya masraf kategorileri yüklenemedi: "+(((x=(t=c.response)==null?void 0:t.data)==null?void 0:x.message)||c.message),"hata")}finally{b(!1)}};p.useEffect(()=>{(i.payment||i.advanceReturn||i.accrual||i.debtCredit||i.expense)&&ae()},[i.payment,i.advanceReturn,i.accrual,i.debtCredit,i.expense]);const W=async()=>{try{const a=await N.get(`${G}/calisancari/calisancaricalisan-get-by-Id/${h}`);return(Array.isArray(a.data)?a.data:[]).reduce((c,I)=>{const f=I.borc||0,n=I.alacak||0;return c+(n-f)},0)}catch(a){throw console.error("Bakiye alınamadı:",a),D("Bakiye kontrolü başarısız.","hata"),a}},re=a=>{const{name:t,value:x}=a.target;U(c=>({...c,[t]:x,...t==="expenseMainCategoryId"?{expenseSubCategoryId:""}:{}}))},de=a=>{const{name:t,value:x}=a.target;B(c=>({...c,[t]:x}))},O=a=>{const{name:t,value:x}=a.target;L(c=>({...c,[t]:x}))},R=a=>{const{name:t,value:x}=a.target;z(c=>({...c,[t]:x,...t==="expenseMainCategoryId"?{expenseSubCategoryId:""}:{}}))},se=a=>{const{name:t,value:x}=a.target;$(c=>({...c,[t]:x,...t==="expenseMainCategoryId"?{expenseSubCategoryId:""}:{}}))},Ce=async a=>{var t,x,c,I,f;if(a.preventDefault(),!Y.amount||!Y.expenseMainCategoryId||!Y.expenseSubCategoryId){D("Tutar ve masraf kategorileri zorunlu.","hata");return}try{b(!0);const n=parseFloat(Y.amount),P=await W()+n,Z={id:0,tarih:new Date(Y.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:parseInt(Y.expenseMainCategoryId),masrafAltKategoriId:parseInt(Y.expenseSubCategoryId),calisanId:parseInt(h),durumu:0,aciklama:Y.description||"Maaş/Prim tahakkuku",borc:0,alacak:n,bakiye:P};await N.post(`${G}/calisancari/calisancari-create`,Z),D("Maaş tahakkuku kaydedildi","başarılı"),m(V=>({...V,accrual:!1})),U({date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",expenseMainCategoryId:"",expenseSubCategoryId:"",description:""}),F(l()),M(h)}catch(n){const v=((x=(t=n.response)==null?void 0:t.data)==null?void 0:x.message)||n.message;console.error("Tahakkuk hatası:",{message:v,status:(c=n.response)==null?void 0:c.status,url:(I=n.config)==null?void 0:I.url,data:(f=n.config)==null?void 0:f.data}),D("Maaş tahakkuku kaydedilemedi: "+v,"hata")}finally{b(!1)}},H=async a=>{var t,x,c,I,f;if(a.preventDefault(),!k.accountId||!k.amount){D("Hesap ve tutar zorunlu.","hata");return}try{b(!0);const n=parseFloat(k.amount),P=await W()-n,Z={id:0,tarih:new Date(k.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:0,masrafAltKategoriId:0,calisanId:parseInt(h),durumu:0,aciklama:k.description||"Maaş/Prim/Avans ödemesi",borc:n,alacak:0,bakiye:P};await N.post(`${G}/calisancari/calisancari-create`,Z);const V=o.find(me=>me.id===parseInt(k.accountId)),fe={id:0,kullanicilarId:parseInt(h),hesapId:parseInt(k.accountId),etkilenenHesapId:0,hesapKategoriId:V.type,islemTarihi:new Date(k.date).toISOString(),islemTuruId:2,bilgi:k.description,aciklama:"Maaş/Prim/Avans ödemesi",borc:n,alacak:0,bakiye:V.balance-n,eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString()};await N.post(`${G}/hesapHareket/hesapHareket-create`,fe),D("Ödeme kaydedildi","başarılı"),m(me=>({...me,payment:!1})),B({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),_(l()),M(h)}catch(n){const v=(t=n.response)==null?void 0:t.status,P=((c=(x=n.response)==null?void 0:x.data)==null?void 0:c.message)||n.message;console.error("Ödeme hatası:",{message:P,status:v,url:(I=n.config)==null?void 0:I.url,data:(f=n.config)==null?void 0:f.data}),D(`Ödeme kaydedilemedi: ${v?`Durum ${v}, `:""}${P}`,"hata")}finally{b(!1)}},Fe=async a=>{var t,x,c,I,f;if(a.preventDefault(),!d.accountId||!d.amount){D("Hesap ve tutar zorunlu.","hata");return}try{b(!0);const n=parseFloat(d.amount),P=await W()+n,Z={id:0,tarih:new Date(d.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:0,masrafAltKategoriId:0,calisanId:parseInt(h),durumu:0,aciklama:d.description||"Avans iadesi",borc:0,alacak:n,bakiye:P};await N.post(`${G}/calisancari/calisancari-create`,Z);const V=o.find(me=>me.id===parseInt(d.accountId)),fe={id:0,kullanicilarId:parseInt(h),hesapId:parseInt(d.accountId),etkilenenHesapId:0,hesapKategoriId:V.type,islemTarihi:new Date(d.date).toISOString(),islemTuruId:1,bilgi:d.description,aciklama:"Avans iadesi",borc:0,alacak:n,bakiye:V.balance+n,eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString()};await N.post(`${G}/hesapHareket/hesapHareket-create`,fe),D("Avans iadesi kaydedildi","başarılı"),m(me=>({...me,advanceReturn:!1})),L({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),y(l()),M(h)}catch(n){const v=((x=(t=n.response)==null?void 0:t.data)==null?void 0:x.message)||n.message;console.error("Avans iadesi hatası:",{message:v,status:(c=n.response)==null?void 0:c.status,url:(I=n.config)==null?void 0:I.url,data:(f=n.config)==null?void 0:f.data}),D("Avans iadesi kaydedilemedi: "+v,"hata")}finally{b(!1)}},Ke=async a=>{var t,x,c,I,f;if(a.preventDefault(),!u.amount){D("Tutar zorunlu.","hata");return}try{b(!0);const n=parseFloat(u.amount),v=u.transactionType==="Borç",P=await W(),Z=v?P-n:P+n,V={id:0,tarih:new Date(u.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:parseInt(u.expenseMainCategoryId)||0,masrafAltKategoriId:parseInt(u.expenseSubCategoryId)||0,calisanId:parseInt(h),durumu:0,aciklama:u.description||"Borç/Alacak fişi",borc:v?n:0,alacak:v?0:n,bakiye:Z};await N.post(`${G}/calisancari/calisancari-create`,V),D("Borç/Alacak fişi kaydedildi","başarılı"),m(fe=>({...fe,debtCredit:!1})),z({transactionType:"Alacak",date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",description:"",expenseMainCategoryId:"",expenseSubCategoryId:""}),A(l()),M(h)}catch(n){const v=((x=(t=n.response)==null?void 0:t.data)==null?void 0:x.message)||n.message;console.error("Borç/Alacak hatası:",{message:v,status:(c=n.response)==null?void 0:c.status,url:(I=n.config)==null?void 0:I.url,data:(f=n.config)==null?void 0:f.data}),D("Borç/Alacak fişi kaydedilemedi: "+v,"hata")}finally{b(!1)}},ze=async a=>{var t,x,c,I,f;if(a.preventDefault(),!C.amount||!C.expenseMainCategoryId||!C.expenseSubCategoryId){D("Tutar ve masraf kategorileri zorunlu.","hata");return}try{b(!0);const n=parseFloat(C.amount),P=await W()+n,Z={id:0,tarih:new Date(C.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:parseInt(C.expenseMainCategoryId),masrafAltKategoriId:parseInt(C.expenseSubCategoryId),calisanId:parseInt(h),durumu:0,aciklama:C.description||`Masraf kaydı: ${C.documentNumber}`,borc:0,alacak:n,bakiye:P,fisBelgeNo:C.documentNumber||"",kdvOrani:parseFloat(C.vatRate)||0};await N.post(`${G}/calisancari/calisancari-create`,Z),D("Masraf kaydı kaydedildi","başarılı"),m(V=>({...V,expense:!1})),$({date:l().format("YYYY-MM-DD"),documentNumber:"",expenseMainCategoryId:"",expenseSubCategoryId:"",amount:"",vatRate:"",currency:"TRY",description:""}),X(l()),M(h)}catch(n){const v=((x=(t=n.response)==null?void 0:t.data)==null?void 0:x.message)||n.message;console.error("Masraf hatası:",{message:v,status:(c=n.response)==null?void 0:c.status,url:(I=n.config)==null?void 0:I.url,data:(f=n.config)==null?void 0:f.data}),D("Masraf kaydı kaydedilemedi: "+v,"hata")}finally{b(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(ne,{visible:i.accrual,backdrop:"static",keyboard:!1,onClose:()=>{m(a=>({...a,accrual:!1})),U({date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",expenseMainCategoryId:"",expenseSubCategoryId:"",description:""}),F(l())},children:[e.jsx(ie,{children:e.jsx(te,{children:"Maaş/Prim Tahakkuku Yap"})}),e.jsxs(le,{children:[s&&e.jsx("p",{children:"Veriler yükleniyor..."}),e.jsxs(pe,{onSubmit:Ce,children:[e.jsx("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:e.jsx("p",{className:"mb-0",children:"'Hakedilen Net Maaş' alanına çalışanın hak ettiği net maaş/prim tutarını yazın. Kaydettiğinizde hem çalışan için alacak kaydı, hem de seçtiğiniz masraf kalemi için gider yazılacaktır. 'Açıklama' alanına 'Şubat maaşı' vb. yazabilirsiniz."})}),e.jsxs("p",{style:{fontWeight:"bold",color:"#dc3545",display:"flex",alignItems:"center",marginBottom:"20px"},children:[e.jsx(K,{icon:we,style:{marginRight:"5px"}}),"Bu işlem kasa ya da banka hesabınızı etkilemez, sadece çalışanı alacaklandırır. Bu işlemden sonra, ödeme yapmak için 'Ödeme Yap' seçeneğini kullanın."]}),e.jsx(xe,{label:"Hakediş Tarihi",value:ye,onChange:a=>{F(a),U(t=>({...t,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(g,{htmlFor:"amount",children:"Hakedilen Net Maaş"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(J,{type:"number",id:"amount",name:"amount",value:Y.amount,onChange:re,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(w,{name:"currency",value:Y.currency,onChange:re,style:{width:"100px"},disabled:s,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(g,{htmlFor:"expenseMainCategoryId",className:"mt-3",children:"Masraf Ana Kategorisi"}),e.jsxs(w,{id:"expenseMainCategoryId",name:"expenseMainCategoryId",value:Y.expenseMainCategoryId,onChange:re,required:!0,className:"mb-3",disabled:s,children:[e.jsx("option",{value:"",children:"Seçiniz"}),T.length>0?T.map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Ana kategoriler yüklenemedi"})]}),e.jsx(g,{htmlFor:"expenseSubCategoryId",className:"mt-3",children:"Masraf Alt Kategorisi"}),e.jsxs(w,{id:"expenseSubCategoryId",name:"expenseSubCategoryId",value:Y.expenseSubCategoryId,onChange:re,required:!0,className:"mb-3",disabled:s||!Y.expenseMainCategoryId,children:[e.jsx("option",{value:"",children:"Seçiniz"}),q.filter(a=>{var t;return((t=a.masrafAnaKategoriId)==null?void 0:t.toString())===Y.expenseMainCategoryId}).map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id))]}),e.jsx(g,{htmlFor:"description",children:"Açıklama"}),e.jsx(ge,{name:"description",rows:3,value:Y.description,onChange:re,placeholder:"Ör: Şubat maaşı",className:"mb-3"}),e.jsxs(oe,{children:[e.jsx(j,{color:"primary",type:"submit",disabled:s,children:"Maaş Tahakkuku Oluştur"}),e.jsx(j,{color:"secondary",onClick:()=>{m(a=>({...a,accrual:!1})),U({date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",expenseMainCategoryId:"",expenseSubCategoryId:"",description:""}),F(l())},children:"İptal"})]})]})]})]}),e.jsxs(ne,{visible:i.payment,backdrop:"static",keyboard:!0,onClose:()=>{m(a=>({...a,payment:!1})),B({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),_(l())},children:[e.jsx(ie,{children:e.jsx(te,{children:"Ödeme Yap (Maaş/Prim/Avans)"})}),e.jsxs(le,{children:[s&&e.jsx("p",{children:"Hesaplar yükleniyor..."}),e.jsxs(pe,{onSubmit:H,children:[e.jsx("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:e.jsx("p",{className:"mb-0",children:"Ödemeyi kaydetiğinizde sistem seçtiğiniz kasa/banka hesabından 'Ödediğiniz Net Tutar' kadar miktarı çalışana borç yazdıracaktır."})}),e.jsxs("p",{style:{fontWeight:"bold",color:"#dc3545",display:"flex",alignItems:"center",marginBottom:"20px"},children:[e.jsx(K,{icon:we,style:{marginRight:"5px"}}),"Maaş ya da prim ödemesi yapmadan önce 'Maaş/Prim Tahakkuku Yap' seçeneği ile çalışanıınızı alacaklandırmayı ve şirketiniz için masraf oluşturmayı unutmayın."]}),e.jsx(xe,{label:"Ödeme Tarihi",value:be,onChange:a=>{_(a),B(t=>({...t,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(g,{htmlFor:"accountId",children:"Hesap Seç"}),e.jsxs(w,{id:"accountId",name:"accountId",value:k.accountId,onChange:de,required:!0,className:"mb-3",disabled:s,children:[e.jsx("option",{value:"",children:"Seçiniz"}),o.length>0?o.map(a=>e.jsxs("option",{value:a.id,children:[a.userName," (",a.currency,")"]},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Hesap bulunamadı"})]}),e.jsxs("p",{className:"mt-2 mb-3",children:[e.jsx("strong",{children:"Güncel bakiye: "}),k.accountId?`${(((Se=o.find(a=>a.id===parseInt(k.accountId)))==null?void 0:Se.balance)||0).toLocaleString("tr-TR")} ${((Ye=o.find(a=>a.id===parseInt(k.accountId)))==null?void 0:Ye.currency)||"TRY"}`:"0.00 TRY"]}),e.jsx(g,{htmlFor:"paymentAmount",children:"Ödediğiniz Net Tutar"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(J,{type:"number",id:"paymentAmount",name:"amount",value:k.amount,onChange:de,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(w,{name:"currency",value:k.currency,onChange:de,style:{width:"100px"},disabled:s,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(g,{htmlFor:"paymentDescription",children:"Açıklama"}),e.jsx(ge,{name:"description",rows:3,value:k.description,onChange:de,placeholder:"Ör: Maaş ödemesi",className:"mb-3"}),e.jsxs(oe,{children:[e.jsx(j,{color:"primary",type:"submit",disabled:s,children:"Ödemeyi Kaydet"}),e.jsx(j,{color:"secondary",onClick:()=>{m(a=>({...a,payment:!1})),B({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),_(l())},children:"İptal"})]})]})]})]}),e.jsxs(ne,{visible:i.advanceReturn,backdrop:"true",keyboard:!0,onClose:()=>{m(a=>({...a,advanceReturn:!1})),L({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),y(l())},children:[e.jsx(ie,{children:e.jsx(te,{children:"Avans İadesi Al"})}),e.jsxs(le,{children:[s&&e.jsx("p",{children:"Hesaplar yükleniyor..."}),e.jsxs(pe,{onSubmit:Fe,children:[e.jsx(xe,{label:"İşlem Tarihi",value:r,onChange:a=>{y(a),L(t=>({...t,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(g,{htmlFor:"advanceReturnAccountId",children:"Hesap Seç"}),e.jsxs(w,{id:"advanceReturnAccountId",name:"accountId",value:d.accountId,onChange:O,required:!0,className:"mb-3",disabled:s,children:[e.jsx("option",{value:"",children:"Seçiniz"}),o.length>0?o.map(a=>e.jsxs("option",{value:a.id,children:[a.userName," (",a.currency,")"]},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Hesap bulunamadı"})]}),e.jsx(g,{htmlFor:"advanceReturnAmount",children:"İade Tutarı"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(J,{type:"number",id:"advanceReturnAmount",name:"amount",value:d.amount,onChange:O,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(w,{name:"currency",value:d.currency,onChange:O,style:{width:"100px"},disabled:s,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(g,{htmlFor:"advanceReturnDescription",children:"Açıklama"}),e.jsx(ge,{name:"description",rows:3,value:d.description,onChange:O,placeholder:"Ör: Avans iadesi",className:"mb-3"}),e.jsxs(oe,{children:[e.jsx(j,{color:"primary",type:"submit",disabled:s,children:"Avans İadesi Kaydet"}),e.jsx(j,{color:"secondary",onClick:()=>{m(a=>({...a,advanceReturn:!1})),L({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),y(l())},children:"İptal"})]})]})]})]}),e.jsxs(ne,{visible:i.debtCredit,backdrop:"true",keyboard:!0,onClose:()=>{m(a=>({...a,debtCredit:!1})),z({transactionType:"Alacak",date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",description:"",expenseMainCategoryId:"",expenseSubCategoryId:""}),A(l())},children:[e.jsx(ie,{children:e.jsx(te,{children:"Borç/Alacak Fişleri"})}),e.jsx(le,{children:e.jsxs(pe,{onSubmit:Ke,children:[e.jsx("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:e.jsx("p",{className:"mb-0",children:"Herhangi bir ödeme, masraf, maaş ya da prim işlemi olmadan çalışanın bakiyesini değiştirmek için borç ya da alacak fişi kaydı oluşturabilirsiniz. Çalışanın güncel bakiyesi burada gireceğiniz tutar kadar değişecektir."})}),e.jsx(g,{htmlFor:"transactionType",children:"İşlem Tipi"}),e.jsxs(w,{id:"transactionType",name:"transactionType",value:u.transactionType,onChange:R,className:"mb-3",children:[e.jsx("option",{value:"Alacak",children:"Alacak Fişi"}),e.jsx("option",{value:"Borç",children:"Borç Fişi"})]}),e.jsx("p",{className:"mb-3",children:u.transactionType==="Alacak"?"Çalışan alacaklanacak.":"Çalışan borçlanacak."}),e.jsx(g,{htmlFor:"expenseMainCategoryId",className:"mt-3",children:"Masraf Ana Kategorisi"}),e.jsxs(w,{id:"expenseMainCategoryId",name:"expenseMainCategoryId",value:u.expenseMainCategoryId,onChange:R,className:"mb-3",disabled:s,children:[e.jsx("option",{value:"",children:"Seçiniz (İsteğe bağlı)"}),T.length>0?T.map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Ana kategoriler yüklenemedi"})]}),e.jsx(g,{htmlFor:"expenseSubCategoryId",className:"mt-3",children:"Masraf Alt Kategorisi"}),e.jsxs(w,{id:"expenseSubCategoryId",name:"expenseSubCategoryId",value:u.expenseSubCategoryId,onChange:R,className:"mb-3",disabled:s||!u.expenseMainCategoryId,children:[e.jsx("option",{value:"",children:"Seçiniz (İsteğe bağlı)"}),q.filter(a=>{var t;return((t=a.masrafAnaKategoriId)==null?void 0:t.toString())===u.expenseMainCategoryId}).map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id))]}),e.jsx(xe,{label:"İşlem Tarihi",value:S,onChange:a=>{A(a),z(t=>({...t,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(g,{htmlFor:"debtCreditAmount",children:"Tutar"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(J,{type:"number",name:"amount",id:"debtCreditAmount",value:u.amount,onChange:R,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(w,{name:"currency",value:u.currency,onChange:R,style:{width:"100px"},disabled:s,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(g,{htmlFor:"debtCreditDescription",children:"Açıklama"}),e.jsx(ge,{name:"description",rows:3,value:u.description,onChange:R,placeholder:"Ör: Borç/Alacak düzeltmesi",className:"mb-3"}),e.jsxs(oe,{children:[e.jsx(j,{color:"primary",type:"submit",disabled:s,children:"Kaydet"}),e.jsx(j,{color:"secondary",onClick:()=>{m(a=>({...a,debtCredit:!1})),z({transactionType:"Alacak",date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",description:"",expenseMainCategoryId:"",expenseSubCategoryId:""}),A(l())},children:"Vazgeç"})]})]})})]}),e.jsxs(ne,{visible:i.expense,backdrop:"true",keyboard:!0,onClose:()=>{m(a=>({...a,expense:!1})),$({date:l().format("YYYY-MM-DD"),documentNumber:"",expenseMainCategoryId:"",expenseSubCategoryId:"",amount:"",vatRate:"",currency:"TRY",description:""}),X(l())},children:[e.jsx(ie,{children:e.jsx(te,{children:"Masraf Girişi"})}),e.jsxs(le,{children:[s&&e.jsx("p",{children:"Veriler yükleniyor..."}),e.jsxs(pe,{onSubmit:ze,children:[e.jsx("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:e.jsx("p",{className:"mb-0",children:"Çalışanınızın size getirdiği masrafları buradan girebilirsiniz. Masraf kaydından sonra çalışan alacaklanır."})}),e.jsx(xe,{label:"Masraf Tarihi",value:E,onChange:a=>{X(a),$(t=>({...t,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(g,{htmlFor:"documentNumber",children:"Fiş/Belge No"}),e.jsx(J,{id:"documentNumber",name:"documentNumber",value:C.documentNumber,onChange:se,placeholder:"Ör: Fatura123",className:"mb-3"}),e.jsx(g,{htmlFor:"expenseMainCategoryId",children:"Masraf Ana Kategorisi"}),e.jsxs(w,{id:"expenseMainCategoryId",name:"expenseMainCategoryId",value:C.expenseMainCategoryId,onChange:se,required:!0,className:"mb-3",disabled:s,children:[e.jsx("option",{value:"",children:"Seçiniz"}),T.length>0?T.map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Ana kategoriler yüklenemedi"})]}),e.jsx(g,{htmlFor:"expenseSubCategoryId",children:"Masraf Alt Kategorisi"}),e.jsxs(w,{id:"expenseSubCategoryId",name:"expenseSubCategoryId",value:C.expenseSubCategoryId,onChange:se,required:!0,className:"mb-3",disabled:s||!C.expenseMainCategoryId,children:[e.jsx("option",{value:"",children:"Seçiniz"}),q.filter(a=>{var t;return((t=a.masrafAnaKategoriId)==null?void 0:t.toString())===C.expenseMainCategoryId}).map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id))]}),e.jsx(g,{htmlFor:"amount",children:"Tutar (KDV Dahil)"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(J,{type:"number",id:"amount",name:"amount",value:C.amount,onChange:se,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(w,{name:"currency",value:C.currency,onChange:se,style:{width:"100px"},disabled:s,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(g,{htmlFor:"vatRate",children:"KDV Oranı (%)"}),e.jsx(J,{type:"number",id:"vatRate",name:"vatRate",value:C.vatRate,onChange:se,placeholder:"Ör: 20",step:"0.01",className:"mb-3"}),e.jsx(g,{htmlFor:"description",children:"Açıklama"}),e.jsx(ge,{name:"description",rows:3,value:C.description,onChange:se,placeholder:"Ör: Seyahat masrafı",className:"mb-3"}),e.jsxs(oe,{children:[e.jsx(j,{color:"primary",type:"submit",disabled:s,children:"Masrafı Kaydet"}),e.jsx(j,{color:"secondary",onClick:()=>{m(a=>({...a,expense:!1})),$({date:l().format("YYYY-MM-DD"),documentNumber:"",expenseMainCategoryId:"",expenseSubCategoryId:"",amount:"",vatRate:"",currency:"TRY",description:""}),X(l())},children:"İptal"})]})]})]})]})]})},Ie="https://speedsofttest.com/api",ma="https://speedsofttest.com",ua="/default-profile.png",ha=i=>{if(!i||typeof i!="string"||i==="null")return ua;if(i.startsWith("https"))return`${i}?t=${new Date().getTime()}`;const m=i.startsWith("/")?i:`/${i}`;return`${ma}${m}?t=${new Date().getTime()}`},fa=()=>{const[i,m]=p.useState(!1),h=Xe(),{employeeId:M}=Ze(),{state:D}=ea(),{selectedEmployee:o,fetchEmployeeById:Q,deleteEmployee:T,employeeBalances:ce,fetchEmployeeBalance:q,loading:ee,error:Y}=aa(),{users:U}=ra(),[k,B]=p.useState([]),[d,L]=p.useState({mainCategories:[],subCategories:[]}),[u,z]=p.useState(!1),[C,$]=p.useState(null),[ye,F]=p.useState([]),[be,_]=p.useState({accrual:!1,payment:!1,advanceReturn:!1,debtCredit:!1,expense:!1}),r=(s,b="başarılı")=>{F(ae=>[...ae,{id:Date.now(),message:s,type:b}])},y=async()=>{m(!0)},S=(s,b={})=>{h(s,{state:b})},A=async()=>{if(console.log("silme baslası"),!(o!=null&&o.id)){r("Silinecek çalışan bulunamadı.","hata"),m(!1);return}const s=await T(o.id);r(s.message,s.success?"başarılı":"hata"),s.success&&h("/app/employees"),m(!1)},E=p.useCallback(async s=>{var b,ae,W,re,de;if(!s||isNaN(s)){$("Çalışan ID'si eksik veya geçersiz."),r("Çalışan bilgisi eksik","hata");return}z(!0);try{const O=await N.get(`${Ie}/calisancari/calisancaricalisan-get-by-Id/${s}`,{headers:{accept:"*/*"}});console.log("ÇalışanCari Get By ID: ",O);const R=O.data,Ce=(Array.isArray(R)?R:R?[R]:[]).map(H=>({id:H.id,tarih:H.tarih||"",masrafAnaKategoriId:H.masrafAnaKategoriId||0,masrafAltKategoriId:H.masrafAltKategoriId||0,aciklama:H.aciklama||"-",borc:H.borc||0,alacak:H.alacak||0,bakiye:H.bakiye||0,calisanId:H.calisanId||s,durumu:H.durumu||0}));B(Ce),$(null),await q(s)}catch(O){const R=((ae=(b=O.response)==null?void 0:b.data)==null?void 0:ae.message)||O.message;console.error("Cari işlemler hatası:",{message:R,status:(W=O.response)==null?void 0:W.status,url:(re=O.config)==null?void 0:re.url}),((de=O.response)==null?void 0:de.status)===404?($(`Çalışan ID ${s} için cari işlem bulunamadı.`),r(`Çalışan ID ${s} için cari işlem bulunamadı`,"hata")):($("Cari işlemler alınamadı: "+R),r("Cari işlemler yüklenemedi: "+R,"hata")),B([])}finally{z(!1)}},[q]),X=async()=>{try{const s=await N.get(`${Ie}/masrafAnaKategori/masrafAnaKategori-get-all`,{headers:{accept:"*/*"}}),b=await N.get(`${Ie}/masrafAltKategori/masrafAltKategori-get-all`,{headers:{accept:"*/*"}}),ae=Array.isArray(s.data)?s.data:[],W=Array.isArray(b.data)?b.data:[];L({mainCategories:ae,subCategories:W})}catch(s){console.error("Masraf kategorileri alınamadı:",s),r("Masraf kategorileri yüklenemedi","hata")}};return p.useEffect(()=>{M&&M!=="new"&&!isNaN(M)?(Q(Number(M)),E(Number(M)),X()):($("Çalışan ID'si eksik veya geçersiz."),r("Çalışan bilgisi eksik veya geçersiz","hata"),h("/app/employees"))},[M,Q,E,h]),ee?e.jsx("div",{children:"Yükleniyor..."}):Y||!o?e.jsxs(ve,{children:[e.jsx(De,{children:"Çalışan Bilgisi"}),e.jsxs(Ae,{children:[e.jsx("p",{children:Y||"Çalışan bulunamadı."}),e.jsx(j,{color:"primary",onClick:()=>h("/app/employees"),children:"Geri Dön"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(sa,{toasts:ye}),e.jsxs(na,{children:[e.jsx(ke,{xs:12,children:e.jsx(la,{employee:{...o,fotograf:ha(o.fotograf),balance:ce[o.id]!==void 0?`${ce[o.id].toLocaleString("tr-TR")} ${o.paraBirimi||"TRY"}`:"Veri bulunamadı"}})}),e.jsx(ke,{xs:12,className:"mb-3",children:e.jsx(oa,{onUpdate:()=>S("/app/employee-update",{employee:o,mode:"update"}),onDelete:y,onModalToggle:s=>_(b=>({...b,[s]:!0})),onExpense:()=>_(s=>({...s,expense:!0})),onStatement:()=>S(`/app/employee-statement/${M}`,{employee:o,expenseCategories:d}),onDocuments:()=>S("/app/employee-documents",{employeeId:o.id}),disableDocuments:!0})}),e.jsx(ke,{xs:12,children:e.jsx(ca,{transactions:k,loading:u,error:C,currency:(o==null?void 0:o.paraBirimi)||"TRY",onPrint:(s,b)=>r(s,b),addToast:r,onRefresh:()=>E(o.id),expenseMainCategories:d.mainCategories||[],expenseSubCategories:d.subCategories||[]})})]}),e.jsxs(ne,{visible:i,onClose:()=>m(!1),backdrop:"static",children:[e.jsx(ie,{children:e.jsx(te,{children:"Silme Onayı"})}),e.jsx(le,{children:e.jsxs("p",{children:["Çalışan ",e.jsxs("strong",{children:['"',o==null?void 0:o.adiSoyadi,'"']})," silinecek. Emin misiniz?"]})}),e.jsxs(oe,{children:[e.jsx(j,{color:"secondary",onClick:()=>m(!1),children:"İptal"}),e.jsx(j,{color:"danger",onClick:A,children:"Sil"})]})]}),e.jsx(da,{modalState:be,setModalState:_,employeeId:o.id,onSubmit:()=>E(o.id),addToast:r})]})};export{fa as default};
