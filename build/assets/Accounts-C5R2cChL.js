import{L as ue,j as e,g as Ie,h as Te,s as Ce,e as Me,f as Oe,q as M,m as me,X as Ve,B as Fe,D as Ye,E as Be,F as he,Y as Ue,o as le,Z as D,$ as _e,a0 as We,a1 as ve,a2 as ce,a3 as Qe,a4 as de,a5 as qe,a6 as Xe,a7 as Ze,N as ge,Q as fe,S as ke,T as be,W as xe,t as k,u as Le,r as ye,i as $e,U as ae,a8 as Je,a9 as Ke,aa as Pe,ab as ze,K as ea,V as aa,C as sa,a as ra,b as ia,c as ta,ac as na}from"./index-DAwD_DDx.js";import{c as la}from"./cil-action-redo-BJFkhFcp.js";import{c as oa}from"./cil-arrow-thick-top-BXOgyfTr.js";import{c as ca}from"./cil-transfer-BeKoe_Wl.js";import{C as Re}from"./CCardText-DxgAXbza.js";const da=()=>{const{selectedUser:C,getTextColor:H,getCurrencySymbol:u}=ue();return C?e.jsxs(Ie,{className:"mb-3 shadow-sm w-50",children:[e.jsx(Ce,{className:"p-3",style:{backgroundColor:C.labelColor||"var(--primary-color)",color:H(C.labelColor)},children:e.jsx("h4",{children:e.jsx("strong",{children:C.userName})})}),e.jsxs(Te,{className:"d-flex",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center me-4",style:{fontSize:"2.5rem",fontWeight:"bold",width:"70px",height:"70px",borderRadius:"50%",backgroundColor:C.labelColor||"#eee",color:H(C.labelColor)},children:u(C.currency)}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Hesap No:"})," ",C.accountNumber||"Bilinmiyor"]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Bakiye:"})," ",(C.balance||0).toLocaleString("tr-TR",{minimumFractionDigits:2})," ",C.currency||"TRY"]})]})]})]}):e.jsx(Ie,{className:"mb-3 shadow-sm",children:e.jsx(Te,{children:e.jsx("p",{children:"Lütfen bir hesap seçin."})})})},ma=()=>{const{setModalVisible:C,setTransactionModalVisible:H,setTransactionType:u,setTransactionForm:f,setVisibleTransferModal:n,setTransferDirection:F,setFilterPeriod:t,searchQuery:l,setSearchQuery:O,setEditingTransaction:d}=ue(),s={"--cui-dropdown-link-hover-color":"#ffffff","--cui-dropdown-link-hover-bg":"#f0b942","--cui-dropdown-link-active-color":"#ffffff","--cui-dropdown-link-active-bg":"#eead20"},p={"--cui-dropdown-link-hover-color":"#ffffff","--cui-dropdown-link-hover-bg":"#504fb0","--cui-dropdown-link-active-color":"#ffffff","--cui-dropdown-link-active-bg":"#5e5cd0"},Y=()=>C(!0),j=V=>{d(null),u(V),f({rawAmount:"",formattedAmount:"",description:"",date:D().format("YYYY-MM-DD"),recipientAccount:"",submissionTimestamp:null}),H(!0)},W=V=>{d(null),F(V),f({rawAmount:"",formattedAmount:"",description:"",date:D().format("YYYY-MM-DD"),recipientAccount:"",submissionTimestamp:null}),n(!0)},I=V=>{const Q=V.target.value||"";try{O(Q),console.log("Arama terimi:",Q)}catch(se){console.error("Arama güncelleme hatası:",se)}};return e.jsx(Me,{className:"d-flex gap-2 flex-wrap mb-2",children:e.jsxs(Oe,{children:[e.jsxs(M,{className:"mx-1 text-white",color:"info",size:"sm",onClick:Y,children:[e.jsx(me,{icon:Ve})," Hesabı Güncelle"]}),e.jsxs(M,{className:"mx-1 text-white",color:"success",size:"sm",onClick:()=>j("in"),children:[e.jsx(me,{icon:la})," Para Girişi"]}),e.jsxs(M,{className:"mx-1 text-white",color:"danger",size:"sm",onClick:()=>j("out"),children:[e.jsx(me,{icon:oa})," Para Çıkışı"]}),e.jsxs(Fe,{children:[e.jsxs(Ye,{className:"mx-1 text-white",size:"sm",color:"warning",children:[e.jsx(me,{icon:ca})," Hesaplar Arası Transfer"]}),e.jsxs(Be,{children:[e.jsx(he,{style:s,onClick:()=>W("outgoing"),children:"Bu hesaptan başka hesaba para aktar"}),e.jsx(he,{style:s,onClick:()=>W("incoming"),children:"Başka hesaptan bu hesaba para aktar"})]})]}),e.jsxs(Fe,{children:[e.jsxs(Ye,{className:"mx-1 text-white",size:"sm",color:"primary",children:[e.jsx(me,{icon:Ue})," Listele"]}),e.jsxs(Be,{children:[e.jsx(he,{style:p,onClick:()=>t("all"),children:"Tümünü Göster"}),e.jsx(he,{style:p,onClick:()=>t("today"),children:"Bugün"}),e.jsx(he,{style:p,onClick:()=>t("last7days"),children:"Son 7 gün"}),e.jsx(he,{style:p,onClick:()=>t("last30days"),children:"Son 30 gün"}),e.jsx(he,{style:p,onClick:()=>t("last1year"),children:"Son 1 yıl"})]})]}),e.jsx(le,{type:"text",style:{margin:"5px",width:"200px",display:"inline-block"},size:"sm",placeholder:"Hesaplarda ara...",value:l||"",onChange:I,className:"my-2"})]})})},X="https://speedsofttest.com/api",ua=()=>{const{transactions:C,handleEditTransaction:H,handleCancelTransaction:u,handleDeleteTransaction:f,showDeleteTransactionModal:n,setShowDeleteTransactionModal:F,transactionToDelete:t,setTransactionToDelete:l,showCancelTransactionModal:O,setShowCancelTransactionModal:d,transactionToCancel:s,setTransactionToCancel:p,rawTransactions:Y,setRawTransactions:j,setTransactions:W,selectedUser:I,setSelectedUser:V,users:Q,setUsers:se,userId:K,setToast:g,fetchTransactions:U}=ue(),h=async(i,b,T,w,o,a,r)=>{var S,x,P;try{const L=await k.get(`${X}/hesapHareket/hesapHareket-get-by-Id/${a}/${b}/${r}`),v=(Array.isArray(L.data)?L.data:[]).find(c=>c.etkilenenHesapId===i&&parseFloat(c.tutar)===parseFloat(T)&&c.islemTarihi===w&&c.islemTuruId===(o?4:3));return v||console.warn("fetchRelatedTransaction: Karşı işlem bulunamadı",{hesapId:i,etkilenenHesapId:b,amount:T,islemTarihi:w}),v||null}catch(L){return console.error("fetchRelatedTransaction error:",{message:L.message,response:(S=L.response)==null?void 0:S.data,status:(x=L.response)==null?void 0:x.status,url:(P=L.config)==null?void 0:P.url}),null}},B=async()=>{var i,b,T,w,o;if(!(t!=null&&t.id)||!(t!=null&&t.hesapId)){console.error("Invalid transaction or account ID:",t),g({message:"Geçersiz işlem veya hesap ID'si.",color:"danger"}),F(!1),l(null);return}try{console.log("Transaction ID:",t.id,"User ID:",K);const a=t.hesapKategoriId||(await k.get(`${X}/Hesap/Hesap-get-by-Id/${t.hesapId}`)).data.hesapKategoriId||1;console.log("Hesap Kategori ID:",a);const r=await k.get(`${X}/hesapHareket/hesapHareket-get-by-Id/${K}/${t.hesapId}/${a}`);if(console.log("Exists Response:",r.data),!r.data||r.data.length===0){g({message:"Silinecek işlem bulunamadı.",color:"danger"}),F(!1),l(null);return}const S=parseFloat(t.tutar)||0,x=t.islemTuruId===3,P=t.islemTuruId===4,L=x||P,v=(await k.get(`${X}/Hesap/Hesap-get-by-Id/${t.hesapId}`)).data;let z=parseFloat(v.guncelBakiye)||0,G=null,A=null,q=null;if(L){if(!t.etkilenenHesapId){g({message:"Transfer işlemi için karşı hesap ID'si eksik.",color:"danger"}),console.warn("confirmDeleteTransaction: etkilenenHesapId eksik",t),F(!1),l(null);return}A=(await k.get(`${X}/Hesap/Hesap-get-by-Id/${t.etkilenenHesapId}`)).data;let $=parseFloat(A.guncelBakiye)||0;if(q=await h(t.hesapId,t.etkilenenHesapId,S,t.islemTarihi,x,K,A.hesapKategoriId),!q){g({message:"İlgili transfer işlemi bulunamadı.",color:"danger"}),console.warn("confirmDeleteTransaction: Karşı işlem bulunamadı",t.etkilenenHesapId),F(!1),l(null);return}x?(z+=S,G=$-S):(z-=S,G=$+S);const R=async y=>{var E,Z,pe;try{return await k.delete(`${X}/hesapHareket/hesapHareket-delete/${y}`),console.log(`Transaction ${y} deleted successfully`),!0}catch(ne){return console.error(`Delete error for transaction ${y}:`,{error:ne.message,response:(E=ne.response)==null?void 0:E.data,status:(Z=ne.response)==null?void 0:Z.status,url:(pe=ne.config)==null?void 0:pe.url}),!1}},re=2;for(let y=0;y<re&&!(await R(t.id)&&await R(q.id));y++)y<re-1&&(console.log(`Retrying delete operation... Attempt ${y+1}`),await new Promise(E=>setTimeout(E,1e3)))}else{if(t.islemTuruId===1)z-=S;else if(t.islemTuruId===2)z+=S;else{g({message:"Yalnızca para girişi, çıkışı veya transfer işlemleri silinebilir.",color:"warning"}),F(!1),l(null);return}await k.delete(`${X}/hesapHareket/hesapHareket-delete/${t.id}`)}await k.put(`${X}/Hesap/hesap-update`,{id:t.hesapId,tanim:v.tanim,hesapNo:v.hesapNo,guncelBakiye:z,paraBirimi:v.paraBirimi,etiketRengi:v.etiketRengi,harcamaLimiti:v.harcamaLimiti||0,guncellenmeTarihi:new Date().toISOString(),hesapKategoriId:v.hesapKategoriId||1,durumu:v.durumu||1,aktif:v.aktif||1,eklenmeTarihi:v.eklenmeTarihi||new Date().toISOString()}),L&&A&&await k.put(`${X}/Hesap/hesap-update`,{id:t.etkilenenHesapId,tanim:A.tanim,hesapNo:A.hesapNo,guncelBakiye:G,paraBirimi:A.paraBirimi,etiketRengi:A.etiketRengi,harcamaLimiti:A.harcamaLimiti||0,guncellenmeTarihi:new Date().toISOString(),hesapKategoriId:A.hesapKategoriId||1,durumu:A.durumu||1,aktif:A.aktif||1});const te=Y.filter(m=>m.id!==t.id&&m.id!==((q==null?void 0:q.id)||null)).sort((m,$)=>D($.islemTarihi).isAfter(D(m.islemTarihi))?1:-1);j(te),W(te.filter(m=>m.hesapId===(I==null?void 0:I.id)));const oe=Q.map(m=>m.id===t.hesapId?{...m,balance:z}:m.id===t.etkilenenHesapId&&G!==null?{...m,balance:G}:m);se(oe),(I==null?void 0:I.id)===t.hesapId?V(m=>({...m,balance:z})):L&&(I==null?void 0:I.id)===t.etkilenenHesapId&&V(m=>({...m,balance:G})),await U(K,I.id,I.hesapKategoriId),g({message:"İşlem silindi.",color:"success"})}catch(a){console.error("Silme hatası:",{message:a.message,response:(i=a.response)==null?void 0:i.data,status:(b=a.response)==null?void 0:b.status,url:(T=a.config)==null?void 0:T.url}),g({message:"İşlem silme sırasında hata oluştu: "+(((o=(w=a.response)==null?void 0:w.data)==null?void 0:o.message)||a.message),color:"danger"})}finally{F(!1),l(null)}},_=async()=>{var i,b,T,w,o;if(!s||!s.hesapId||!s.id||!s.etkilenenHesapId){console.error("Invalid transaction or account ID:",s),g({message:"Geçersiz işlem veya hesap ID'si.",color:"danger"}),d(!1),p(null);return}if(s.islemTuruId!==3&&s.islemTuruId!==4){g({message:"Yalnızca transfer işlemleri iptal edilebilir.",color:"warning"}),d(!1),p(null);return}try{const a=parseFloat(s.tutar)||0,r=s.islemTuruId===3;console.log("Fetching sender account");const S=await k.get(`${X}/Hesap/Hesap-get-by-Id/${s.hesapId}`);console.log("Creating sender transaction");const x=S.data;let P=parseFloat(x.guncelBakiye)||0;const N=(await k.get(`${X}/Hesap/Hesap-get-by-Id/${s.etkilenenHesapId}`)).data;let v=parseFloat(N.guncelBakiye)||0;const c=await h(s.hesapId,s.etkilenenHesapId,a,s.islemTarihi,r,K,N.hesapKategoriId);if(!c){g({message:"İlgili alıcı işlemi bulunamadı.",color:"danger"}),console.warn("confirmCancelTransaction: Karşı işlem bulunamadı",s.etkilenenHesapId),d(!1),p(null);return}let z,G;r?(z=P+a,G=v-a):(z=P-a,G=v+a);const A={id:0,kullanicilarId:K,hesapId:s.hesapId,etkilenenHesapId:s.etkilenenHesapId,hesapKategoriId:x.hesapKategoriId||1,islemTarihi:new Date().toISOString(),islemTuruId:r?4:3,durumu:1,bilgi:`İptal: ${s.bilgi||s.aciklama||"Transfer İptali"}`,aciklama:r?"Transfer Giriş (İptal)":"Transfer Çıkış (İptal)",tutar:a,borc:r?0:a,alacak:r?a:0,bakiye:z,eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString()},q={id:0,kullanicilarId:K,hesapId:s.etkilenenHesapId,etkilenenHesapId:s.hesapId,hesapKategoriId:N.hesapKategoriId||1,islemTarihi:new Date().toISOString(),islemTuruId:r?3:4,durumu:1,bilgi:`İptal: ${c.bilgi||c.aciklama||"Transfer İptali"}`,aciklama:r?"Transfer Çıkış (İptal)":"Transfer Giriş (İptal)",tutar:a,borc:r?a:0,alacak:r?0:a,bakiye:G,eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString()},te=await k.post(`${X}/hesapHareket/hesapHareket-create`,A),oe=await k.post(`${X}/hesapHareket/hesapHareket-create`,q);await k.put(`${X}/Hesap/hesap-update`,{id:s.hesapId,tanim:x.tanim,hesapNo:x.hesapNo,guncelBakiye:z,paraBirimi:x.paraBirimi,etiketRengi:x.etiketRengi,harcamaLimiti:x.harcamaLimiti||0,guncellenmeTarihi:new Date().toISOString(),hesapKategoriId:x.hesapKategoriId||1,durumu:x.durumu||1,aktif:x.aktif||1,eklenmeTarihi:x.eklenmeTarihi||new Date().toISOString()}),await k.put(`${X}/Hesap/hesap-update`,{id:s.etkilenenHesapId,tanim:N.tanim,hesapNo:N.hesapNo,guncelBakiye:G,paraBirimi:N.paraBirimi,etiketRengi:N.etiketRengi,harcamaLimiti:N.harcamaLimiti||0,guncellenmeTarihi:new Date().toISOString(),hesapKategoriId:N.hesapKategoriId||1,durumu:N.durumu||1,aktif:N.aktif||1,eklenmeTarihi:N.eklenmeTarihi||new Date().toISOString()});const m={id:te.data.id||Date.now(),date:D().format("DD.MM.YYYY"),type:r?"Transfer Giriş (İptal)":"Transfer Çıkış (İptal)",userName:x.tanim,accountNumber:N.hesapNo,description:A.bilgi,debit:r?"-":`${a.toLocaleString("tr-TR",{minimumFractionDigits:2})}`,credit:r?`${a.toLocaleString("tr-TR",{minimumFractionDigits:2})}`:"-",islemTarihi:new Date().toISOString(),islemTuruId:r?4:3,tutar:a,etkilenenHesapId:s.etkilenenHesapId,hesapId:s.hesapId,isCancelled:!0},$={id:oe.data.id||Date.now()+1,date:D().format("DD.MM.YYYY"),type:r?"Transfer Çıkış (İptal)":"Transfer Giriş (İptal)",userName:N.tanim,accountNumber:x.hesapNo,description:q.bilgi,debit:r?`${a.toLocaleString("tr-TR",{minimumFractionDigits:2})}`:"-",credit:r?"-":`${a.toLocaleString("tr-TR",{minimumFractionDigits:2})}`,islemTarihi:new Date().toISOString(),islemTuruId:r?3:4,tutar:a,etkilenenHesapId:s.hesapId,hesapId:s.etkilenenHesapId,isCancelled:!0},R=[...Y,m,$].sort((y,E)=>D(E.islemTarihi).isAfter(D(y.islemTarihi))?1:-1);j(R),W(R.filter(y=>y.hesapId===(I==null?void 0:I.id)));const re=Q.map(y=>y.id===s.hesapId?{...y,balance:z}:y.id===s.etkilenenHesapId?{...y,balance:G}:y);se(re),(I==null?void 0:I.id)===s.hesapId?V(y=>({...y,balance:z})):(I==null?void 0:I.id)===s.etkilenenHesapId&&V(y=>({...y,balance:G})),await U(K,I.id,I.hesapKategoriId),g({message:"Transfer işlemi başarıyla iptal edildi.",color:"success"})}catch(a){console.error("Cancel transaction error:",{message:a.message,response:(i=a.response)==null?void 0:i.data,status:(b=a.response)==null?void 0:b.status,url:(T=a.config)==null?void 0:T.url,transactionToCancel:s}),g({message:`İşlem iptal edilirken hata oluştu: ${((o=(w=a.response)==null?void 0:w.data)==null?void 0:o.message)||a.message}`,color:"danger"})}finally{d(!1),p(null)}};return e.jsxs(Ie,{className:"mb-4",children:[e.jsx(Ce,{className:"p-3",style:{backgroundColor:"var(--primary-color)",color:"var(--white-color)"},children:e.jsx("h5",{children:"İşlem Geçmişi"})}),e.jsx(Te,{children:C.length>0?e.jsxs(_e,{responsive:!0,children:[e.jsx(We,{children:e.jsxs(ve,{children:[e.jsx(ce,{children:"Tarih"}),e.jsx(ce,{children:"İşlem"}),e.jsx(ce,{children:"Kullanıcı"}),e.jsx(ce,{children:"Hesap No"}),e.jsx(ce,{children:"Açıklama"}),e.jsx(ce,{children:"Borç"}),e.jsx(ce,{children:"Alacak"}),e.jsx(ce,{children:"İşlemler"})]})}),e.jsx(Qe,{className:"my-2",children:C.map((i,b)=>e.jsxs(ve,{children:[e.jsx(de,{children:i.date||"-"}),e.jsx(de,{children:i.type||"-"}),e.jsx(de,{children:i.userName||"Bilinmiyor"}),e.jsx(de,{children:i.accountNumber||"-"}),e.jsx(de,{children:i.bilgi||i.description||"-"}),e.jsx(de,{children:i.debit||"-"}),e.jsx(de,{children:i.credit||"-"}),e.jsxs(de,{children:[e.jsx(M,{color:"info",size:"sm",className:"me-2",style:{color:"white",marginBottom:"3px"},onClick:()=>H(i),disabled:i.isCancelled,children:e.jsx(me,{icon:qe})}),e.jsx(M,{color:"warning",size:"sm",className:"me-2",style:{color:"white",marginBottom:"3px"},onClick:()=>u(i),disabled:i.islemTuruId!==3&&i.islemTuruId!==4||i.isCancelled,children:e.jsx(me,{icon:Xe})}),e.jsx(M,{color:"danger",size:"sm",style:{color:"white"},onClick:()=>{l(i),F(!0)},disabled:i.islemTuruId!==1&&i.islemTuruId!==2&&i.islemTuruId!==3&&i.islemTuruId!==4||i.isCancelled,children:e.jsx(me,{icon:Ze})})]})]},i.id||b))})]}):e.jsx("p",{children:"Henüz işlem bulunmamaktadır."})}),e.jsxs(ge,{visible:n,onClose:()=>{F(!1),l(null)},className:"shadow-sm",backdrop:"static",children:[e.jsx(fe,{style:{backgroundColor:"var(--danger-color)",color:"var(--white-color)"},children:e.jsx(ke,{children:"Silme Onayı"})}),e.jsx(be,{children:e.jsxs("p",{children:['"',e.jsx("strong",{children:(t==null?void 0:t.description)||"Bu işlem"}),'" tablodan kaldırılacak, emin misiniz? Bu işlem geri alınamaz.']})}),e.jsxs(xe,{children:[e.jsx(M,{color:"secondary",onClick:()=>{F(!1),l(null)},children:"İptal"}),e.jsx(M,{color:"danger",onClick:B,className:"text-white",children:"Sil"})]})]}),e.jsxs(ge,{visible:O,onClose:()=>{d(!1),p(null)},className:"shadow-sm",backdrop:"static",children:[e.jsx(fe,{style:{backgroundColor:"var(--cancel-color)",color:"var(--white-color)"},children:e.jsx(ke,{children:"İptal Onayı"})}),e.jsx(be,{children:e.jsxs("p",{children:['"',e.jsx("strong",{children:(s==null?void 0:s.description)||"Bu transfer"}),'" iptal edilecek, emin misiniz? Bu işlem geri alınamaz.']})}),e.jsxs(xe,{children:[e.jsx(M,{color:"secondary",onClick:()=>{d(!1),p(null)},children:"İptal"}),e.jsx(M,{color:"warning",onClick:_,className:"text-white",children:"Onayla"})]})]})]})},Ae="https://speedsofttest.com/api",pa=()=>{const{modalVisible:C,setModalVisible:H,formData:u,setFormData:f,selectedUser:n,setSelectedUser:F,users:t,setUsers:l,setToast:O}=ue(),d=Le(),[s,p]=ye.useState(!1),[Y,j]=ye.useState(!1),W=g=>{const{name:U,value:h}=g.target;f(B=>({...B,[U]:h}))},I=async()=>{var U,h,B,_;if(!((U=u.userName)!=null&&U.trim())||!((h=u.accountNumber)!=null&&h.trim())){O({message:"Hesap Adı ve Hesap No zorunlu alanlardır.",color:"danger"});return}if(t.some(i=>i.accountNumber===u.accountNumber&&i.id!==n.id)){O({message:"Bu hesap numarası zaten kullanımda.",color:"danger"});return}const g={...n,userName:u.userName.trim(),accountNumber:u.accountNumber.trim(),labelColor:u.labelColor||"#cccccc",description:u.description||"",spendingLimit:parseFloat(u.spendingLimit)||0,balance:n.balance,currency:n.currency||"TRY",transactions:n.transactions,type:n.type,hesapKategoriId:n.hesapKategoriId};try{await k.put(`${Ae}/Hesap/hesap-update`,{id:g.id,tanim:g.userName,hesapNo:g.accountNumber,guncelBakiye:g.balance,paraBirimi:g.currency,etiketRengi:g.labelColor,harcamaLimiti:g.spendingLimit,guncellenmeTarihi:new Date().toISOString(),hesapKategoriId:g.hesapKategoriId,durumu:n.durumu||1,aktif:n.aktif||1,eklenmeTarihi:n.eklenmeTarihi||new Date().toISOString()}),F(g),l(i=>i.map(b=>b.id===g.id?g:b)),O({message:"Hesap başarıyla güncellendi.",color:"success"}),H(!1)}catch(i){O({message:"Hesap güncellenirken hata oluştu: "+(((_=(B=i.response)==null?void 0:B.data)==null?void 0:_.message)||i.message),color:"danger"})}},V=()=>{j(!0)},Q=async()=>{var g,U;if(!(n!=null&&n.id)){O({message:"Hesap ID'si eksik.",color:"danger"}),j(!1);return}try{await k.put(`${Ae}/Hesap/hesap-update`,{id:n.id,tanim:n.userName,hesapNo:n.accountNumber,guncelBakiye:n.balance,paraBirimi:n.currency,etiketRengi:n.labelColor,harcamaLimiti:n.spendingLimit||0,guncellenmeTarihi:new Date().toISOString(),hesapKategoriId:n.hesapKategoriId,durumu:0,aktif:0,eklenmeTarihi:n.eklenmeTarihi||new Date().toISOString()});const h={...n,durumu:0,aktif:0};F(h),l(B=>B.map(_=>_.id===n.id?h:_)),O({message:`Hesap "${u.userName}" pasif yapıldı.`,color:"warning"}),H(!1),j(!1),d("/app/dashboard")}catch(h){O({message:"Hesap pasif yapılırken hata oluştu: "+(((U=(g=h.response)==null?void 0:g.data)==null?void 0:U.message)||h.message),color:"danger"}),j(!1)}},se=()=>{p(!0)},K=async()=>{var g,U;if(!(n!=null&&n.id)){O({message:"Hesap ID'si eksik.",color:"danger"}),p(!1);return}try{await k.delete(`${Ae}/Hesap/hesap-delete/${n.id}`),l(h=>h.filter(B=>B.id!==n.id)),F(null),O({message:"Hesap silindi.",color:"success"}),H(!1),p(!1),d("/app/dashboard")}catch(h){O({message:"Hesap silinirken hata oluştu: "+(((U=(g=h.response)==null?void 0:g.data)==null?void 0:U.message)||h.message),color:"danger"}),p(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(ge,{visible:C,backdrop:"static",keyboard:!1,onClose:()=>H(!1),className:"shadow-sm",children:[e.jsx(fe,{style:{backgroundColor:"#2965A8",color:"#FFFFFF"},children:e.jsx(ke,{children:"Hesap Güncelle"})}),e.jsx(be,{children:e.jsxs($e,{children:[e.jsx(ae,{htmlFor:"userName",children:"Hesap Adı"}),e.jsx(le,{name:"userName",value:u.userName,onChange:W}),e.jsx(ae,{htmlFor:"accountNumber",className:"mt-3",children:"Hesap No"}),e.jsx(le,{name:"accountNumber",value:u.accountNumber,onChange:W}),e.jsx(ae,{htmlFor:"labelColor",className:"mt-3",children:"Etiket Rengi"}),e.jsx(le,{type:"color",name:"labelColor",value:u.labelColor,onChange:W}),e.jsx(ae,{htmlFor:"spendingLimit",className:"mt-3",children:"Harcama Limiti"}),e.jsx(le,{type:"number",name:"spendingLimit",value:u.spendingLimit,onChange:W}),e.jsx(ae,{htmlFor:"description",className:"mt-3",children:"Açıklama"}),e.jsx(Je,{name:"description",rows:3,value:u.description,onChange:W})]})}),e.jsxs(xe,{className:"d-flex justify-content-between",children:[e.jsxs("div",{children:[e.jsx(M,{color:"warning",className:"me-2",style:{color:"white"},onClick:V,children:"Pasif Yap"}),e.jsx(M,{color:"danger",style:{color:"white"},onClick:se,children:"Sil"})]}),e.jsx(M,{color:"primary",onClick:I,children:"Kaydet"})]})]}),e.jsxs(ge,{visible:s,onClose:()=>p(!1),className:"shadow-sm",backdrop:"static",children:[e.jsx(fe,{style:{backgroundColor:"#dc3545",color:"#FFFFFF"},children:e.jsx(ke,{children:"Silme Onayı"})}),e.jsx(be,{children:e.jsxs("p",{children:['Hesap "',e.jsx("strong",{children:(u==null?void 0:u.userName)||"Bilinmeyen Hesap"}),'" silinecek, emin misiniz? Bu işlem geri alınamaz.']})}),e.jsxs(xe,{children:[e.jsx(M,{color:"secondary",onClick:()=>p(!1),children:"İptal"}),e.jsx(M,{color:"danger",onClick:K,className:"text-white",children:"Sil"})]})]}),e.jsxs(ge,{visible:Y,onClose:()=>j(!1),className:"shadow-sm",backdrop:"static",children:[e.jsx(fe,{style:{backgroundColor:"#F6A213",color:"#FFFFFF"},children:e.jsx(ke,{children:"Pasif Yapma Onayı"})}),e.jsx(be,{children:e.jsxs("p",{children:['Hesap "',e.jsx("strong",{children:(u==null?void 0:u.userName)||"Bilinmeyen Hesap"}),'" pasif yapılacak, emin misiniz?']})}),e.jsxs(xe,{children:[e.jsx(M,{color:"secondary",onClick:()=>j(!1),children:"İptal"}),e.jsx(M,{color:"warning",onClick:Q,className:"text-white",children:"Pasif Yap"})]})]})]})},je="https://speedsofttest.com/api",ha=`
  .custom-modal .close {
    color: #FFFFFF !important;
    opacity: 1 !important;
  }
  .custom-modal .close:hover {
    color: #FFFFFF !important;
    opacity: 0.8 !important;
  }
`,ga=()=>{const{transactionModalVisible:C,setTransactionModalVisible:H,transactionType:u,transactionForm:f,setTransactionForm:n,value:F,setValue:t,selectedUser:l,setSelectedUser:O,setToast:d,editingTransaction:s,setEditingTransaction:p,isSubmitting:Y,setIsSubmitting:j,rawTransactions:W,setRawTransactions:I,processedSubmissions:V,userId:Q,setUsers:se,setTransactions:K}=ue(),g=B=>{const{name:_,value:i}=B.target;n(b=>({...b,[_]:i}))},U=B=>{const i=B.target.value.replace(/[^\d,]/g,"").replace(/,/g,"");if(!i){n(a=>({...a,rawAmount:"",formattedAmount:""}));return}let b=i.slice(0,-2)||"0",T=i.slice(-2).padStart(2,"0");const w=parseFloat(`${b}.${T}`),o=`${parseInt(b,10).toLocaleString("tr-TR")},${T}`;n(a=>({...a,rawAmount:w.toString(),formattedAmount:o}))},h=async B=>{var x,P,L,N,v;if(B.preventDefault(),Y)return;if(!l){d({message:"Lütfen bir kullanıcı seçin.",color:"danger"});return}const _=Date.now();if(V.current.has(_))return;j(!0),n(c=>({...c,submissionTimestamp:_}));const i=parseFloat(f.rawAmount);if(isNaN(i)||i<=0){d({message:"Lütfen geçerli bir tutar girin.",color:"danger"}),j(!1);return}const b=u==="in";if(!b&&!(u==="out")){d({message:"Geçersiz işlem türü.",color:"danger"}),j(!1);return}let w;if(!l||!l.id){d({message:"Hesap seçilmedi veya geçersiz.",color:"danger"}),j(!1);return}try{const c=await k.get(`${je}/Hesap/Hesap-get-by-Id/${l.id}`);if(console.log("API'den gelen yanıt:",c.data),!c.data||!Array.isArray(c.data)||c.data.length===0){d({message:"Hesap bilgisi alınamadı.",color:"danger"}),j(!1);return}w=parseFloat(c.data[0].guncelBakiye)||0}catch(c){console.error("Bakiye alma hatası:",c.response||c),d({message:"Bakiye kontrolü başarısız.",color:"danger"}),j(!1);return}let o=0,a=null;if(s){if(!s.id){d({message:"Geçersiz işlem ID'si.",color:"danger"}),j(!1);return}try{if(a=(await k.get(`${je}/hesapHareket/hesapHareket-get-by-Id/${Q}/${l.id}/${l.hesapKategoriId}`)).data.find(z=>z.id===s.id),a)if(o=parseFloat(a.tutar)||0,a.islemTuruId===1)w-=o;else if(a.islemTuruId===2)w+=o;else{d({message:"Yalnızca Para Girişi veya Çıkışı işlemleri düzenlenebilir.",color:"danger"}),j(!1);return}else{console.warn(`İşlem ID ${s.id} bulunamadı`),d({message:"Düzenlenecek işlem bulunamadı.",color:"danger"}),j(!1);return}}catch(c){console.error("İşlem alma hatası:",c.response||c),d({message:"İşlem detayları alınamadı.",color:"danger"}),j(!1);return}}const r=f.date?D(f.date,"DD.MM.YYYY").isValid()?D(f.date,"DD.MM.YYYY").toISOString():new Date().toISOString():new Date().toISOString(),S={id:s?s.id:0,kullanicilarId:Q,hesapId:l.id,etkilenenHesapId:l.etkilenenHesapId??l.id,hesapKategoriId:l.hesapKategoriId||1,islemTarihi:r,islemTuruId:b?1:2,bilgi:f.description||"",aciklama:f.description||(b?"Para Girişi":"Para Çıkışı"),tutar:i,borc:b?0:i,alacak:b?i:0,bakiye:0,eklenmeTarihi:s?(a==null?void 0:a.eklenmeTarihi)||new Date().toISOString():new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),durumu:1};console.log("API'ye gönderilen işlem objesi:",S),j(!0);try{let c;s?c=await k.put(`${je}/hesapHareket/hesapHareket-update`,S):c=await k.post(`${je}/hesapHareket/hesapHareket-create`,S);const G={id:s?s.id:c.data.id||Date.now(),date:f.date||D().format("DD.MM.YYYY"),type:b?"Para Girişi":"Para Çıkışı",description:f.description||(b?"Para Girişi":"Para Çıkışı"),debit:b?"-":`${i.toLocaleString("tr-TR",{minimumFractionDigits:2})}`,credit:b?`${i.toLocaleString("tr-TR",{minimumFractionDigits:2})}`:"-",islemTarihi:r,islemTuruId:b?1:2,tutar:i,etkilenenHesapId:l.etkilenenHesapId||l.id,hesapId:l.id,borc:b?0:i,alacak:b?i:0,durumu:1};console.log("Yeni işlem:",G);let A=[...W];s&&a&&(A=A.filter($=>$.id!==s.id)),A.push(G);const q=A.filter($=>$.durumu===1),te=q.reduce(($,R)=>$+(R.alacak||0),0),oe=q.reduce(($,R)=>$+(R.borc||0),0),m=te-oe;console.log("Yeni bakiye:",m),await k.put(`${je}/Hesap/hesap-update`,{id:l.id,tanim:l.tanim||l.userName,hesapNo:l.hesapNo||l.accountNumber,guncelBakiye:m,paraBirimi:l.paraBirimi||l.currency,etiketRengi:l.etiketRengi||l.labelColor,harcamaLimiti:l.harcamaLimiti||l.spendingLimit||0,guncellenmeTarihi:new Date().toISOString(),hesapKategoriId:l.hesapKategoriId||1,durumu:1,aktif:1}),A.sort(($,R)=>D(R.islemTarihi).isAfter(D($.islemTarihi))?1:-1),I(A),K(A.filter($=>$.durumu===1)),se($=>$.map(R=>R.id===l.id?{...R,balance:m}:R)),O($=>({...$,balance:m})),V.current.add(_),d({message:s?`İşlem güncellendi: ${o.toLocaleString("tr-TR",{minimumFractionDigits:2})} ${l.currency} -> ${i.toLocaleString("tr-TR",{minimumFractionDigits:2})} ${l.currency}`:"İşlem başarıyla eklendi!",color:"success"}),H(!1),p(null),n({rawAmount:"",formattedAmount:"",description:"",date:D().format("DD.MM.YYYY"),recipientAccount:"",submissionTimestamp:null})}catch(c){console.error("Transaction error:",{message:c.message,response:(x=c.response)==null?void 0:x.data,status:(P=c.response)==null?void 0:P.status,url:(L=c.config)==null?void 0:L.url,payload:S}),d({message:"İşlem sırasında hata oluştu: "+(((v=(N=c.response)==null?void 0:N.data)==null?void 0:v.message)||c.message),color:"danger"})}finally{j(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:ha}),e.jsxs(ge,{visible:C,backdrop:"static",keyboard:!1,onClose:()=>{H(!1),p(null),n({rawAmount:"",formattedAmount:"",description:"",date:D().format("DD.MM.YYYY"),recipientAccount:"",submissionTimestamp:null})},className:"custom-modal",children:[e.jsx(fe,{style:{backgroundColor:u==="in"?"var(--income-color)":"var(--outcome-color)",color:"white"},children:e.jsx(ke,{children:u==="in"?"Para Girişi Ekle":"Para Çıkışı Ekle"})}),e.jsx(be,{children:e.jsxs($e,{onSubmit:h,children:[e.jsx(ae,{htmlFor:"date",className:"block text-sm font-semibold mb-3",children:"İşlem Tarihi"}),e.jsx(Ke,{dateAdapter:Pe,children:e.jsx(ze,{value:F,onChange:B=>{t(B),n(_=>({..._,date:B?B.format("DD.MM.YYYY"):""}))},format:"DD.MM.YYYY",slotProps:{textField:{fullWidth:!0,variant:"outlined",size:"small"}}})}),e.jsx(ae,{htmlFor:"amount",className:"mt-3",children:"Tutar"}),e.jsx(le,{type:"text",id:"amount",name:"amount",value:f.formattedAmount,onChange:U,placeholder:"0,00"}),e.jsx(ae,{htmlFor:"description",className:"mt-3",children:"Açıklama"}),e.jsx(le,{type:"text",name:"description",value:f.description,onChange:g}),e.jsxs(xe,{children:[e.jsx(M,{color:"primary",type:"submit",disabled:Y,children:Y?"İşleniyor...":s?"Güncelle":"Ekle"}),e.jsx(M,{color:"secondary",onClick:()=>{H(!1),p(null),n({rawAmount:"",formattedAmount:"",description:"",date:D().format("DD.MM.YYYY"),recipientAccount:"",submissionTimestamp:null})},children:"İptal"})]})]})})]})]})},ee="https://speedsofttest.com/api",fa=[{categoryId:1,accountName:"Banka Hesapları",type:"bank"},{categoryId:2,accountName:"Kasa Tanımları",type:"cash"},{categoryId:3,accountName:"Kredi Kartları",type:"creditCard"},{categoryId:4,accountName:"Pos Hesapları",type:"pos"},{categoryId:5,accountName:"Şirket Ortakları Hesapları",type:"partner"},{categoryId:6,accountName:"Veresiye Hesapları",type:"debt"}],ka=()=>{const{visibleTransferModal:C,setVisibleTransferModal:H,transferDirection:u,transactionForm:f,setTransactionForm:n,setTransactions:F,value:t,setValue:l,isSubmitting:O,setIsSubmitting:d,selectedUser:s,setToast:p,editingTransaction:Y,setEditingTransaction:j,rawTransactions:W,setRawTransactions:I,processedSubmissions:V,userId:Q,setSelectedUser:se}=ue(),{users:K,setUsers:g,fetchUsers:U}=ea(),h=ye.useRef(!1);ye.useEffect(()=>{K.length||(console.log("Fetching users..."),U().catch(T=>{console.error("Fetch users error:",T),p({message:"Hesaplar yüklenirken hata oluştu.",color:"danger"})}))},[K,U]);const B=T=>{const{name:w,value:o}=T.target;n(a=>({...a,[w]:o}))},_=T=>{const o=T.target.value.replace(/[^\d]/g,"");if(!o){n(P=>({...P,rawAmount:"",formattedAmount:""}));return}let a=o.slice(0,-2)||"0",r=o.slice(-2).padStart(2,"0");const S=parseFloat(`${a}.${r}`);if(isNaN(S)||S<=0){p({message:"Geçerli bir tutar girin.",color:"danger"});return}const x=`${parseInt(a,10).toLocaleString("tr-TR")},${r}`;n(P=>({...P,rawAmount:S.toString(),formattedAmount:x}))},i=async(T,w,o,a,r,S,x)=>{var P,L;try{return(await k.get(`${ee}/hesapHareket/hesapHareket-get-by-Id/${S}/${w}/${x}`)).data.find(c=>c.hesapId===w&&c.etkilenenHesapId===T&&parseFloat(c.tutar)===parseFloat(o)&&D(c.islemTarihi).isSame(D(a),"second")&&c.islemTuruId===(r?4:3))||null}catch(N){return console.error("Related transaction fetch error:",{error:N.message,response:(P=N.response)==null?void 0:P.data,status:(L=N.response)==null?void 0:L.status}),null}},b=async T=>{var P,L,N,v,c,z,G,A,q,te,oe;if(T.preventDefault(),O||h.current)return;if(h.current=!0,d(!0),!s){p({message:"Lütfen önce bir kullanıcı seçin.",color:"danger"}),d(!1),h.current=!1;return}const w=Date.now();if(V.current.has(w)){d(!1),h.current=!1;return}n(m=>({...m,submissionTimestamp:w}));const o=parseFloat(f.rawAmount);if(isNaN(o)||o<=0){p({message:"Lütfen geçerli bir tutar girin.",color:"danger"}),d(!1),h.current=!1;return}let a,r;if(u==="outgoing"?(a=s,r=K.find(m=>m.accountNumber===f.recipientAccount)):(a=K.find(m=>m.accountNumber===f.recipientAccount),r=s),console.log("Sender:",a),console.log("Recipient:",r),console.log("Amount:",o),!a||!r){p({message:"Gönderen veya alıcı hesap bulunamadı.",color:"danger"}),d(!1),h.current=!1;return}if(a.accountNumber===r.accountNumber){p({message:"Aynı hesaba transfer yapılamaz.",color:"danger"}),d(!1),h.current=!1;return}if(console.log("Sender Currency:",a.currency),console.log("Recipient Currency:",r.currency),a.currency!==r.currency){p({message:"Hesaplar farklı para birimlerinde, transfer yapılamaz.",color:"danger"}),d(!1),h.current=!1;return}let S=null,x=null;try{const[m,$]=await Promise.all([k.get(`${ee}/Hesap/Hesap-get-by-Id/${a.id}`),k.get(`${ee}/Hesap/Hesap-get-by-Id/${r.id}`)]);console.log("Sender API Response:",m.data),console.log("Recipient API Response:",$.data);let R=parseFloat((P=m.data[0])==null?void 0:P.guncelBakiye)||a.balance||0,re=parseFloat((L=$.data[0])==null?void 0:L.guncelBakiye)||r.balance||0;console.log("Initial Sender Balance:",R),console.log("Initial Recipient Balance:",re);let y=0,E=null,Z=null;if(Y){if(!Y.id){p({message:"Geçersiz işlem ID'si.",color:"danger"}),d(!1),h.current=!1;return}try{if(E=(await k.get(`${ee}/hesapHareket/hesapHareket-get-by-Id/${Q}/${a.id}/${a.hesapKategoriId}`)).data.find(He=>He.id===Y.id),!E){p({message:"Düzenlenecek gönderici işlemi bulunamadı.",color:"danger"}),d(!1),h.current=!1;return}y=parseFloat(E.tutar)||0;const ie=E.islemTuruId===3;if(ie?(R+=y,re-=y):(R-=y,re+=y),console.log("Old Amount:",y),console.log("Adjusted Sender Balance:",R),console.log("Adjusted Recipient Balance:",re),Z=await i(a.id,r.id,y,E.islemTarihi,ie,Q,r.hesapKategoriId),!Z){p({message:"İlgili alıcı işlemi bulunamadı.",color:"danger"}),d(!1),h.current=!1;return}try{await Promise.all([k.delete(`${ee}/hesapHareket/hesapHareket-delete/${E.id}`),k.delete(`${ee}/hesapHareket/hesapHareket-delete/${Z.id}`)]),console.log("Old transactions deleted successfully")}catch(He){console.error("Delete Transaction Error:",He),p({message:"Eski işlemler silinirken hata oluştu.",color:"danger"}),d(!1),h.current=!1;return}}catch(J){console.error("Eski işlem silme hatası:",{error:J.message,response:(N=J.response)==null?void 0:N.data,status:(v=J.response)==null?void 0:v.status}),p({message:"Eski işlemler silinirken hata oluştu.",color:"danger"}),d(!1),h.current=!1;return}}if(console.log("Final Sender Balance:",R),console.log("Final Recipient Balance:",re),o>R){p({message:"Yetersiz bakiye.",color:"danger"}),d(!1),h.current=!1;return}const pe=R-o,ne=re+o,we=f.date?D(f.date,"DD.MM.YYYY").isValid()?D(f.date,"DD.MM.YYYY").toISOString():new Date().toISOString():new Date().toISOString();S={id:Y?Y.id:0,kullanicilarId:Q,hesapId:a.id,etkilenenHesapId:r.id,hesapKategoriId:a.hesapKategoriId,islemTarihi:we,islemTuruId:3,bilgi:f.description||`Transfer - ${r.userName} (${r.accountNumber})`,aciklama:`${r.userName} hesabına transfer`,tutar:o,borc:o,alacak:0,bakiye:pe,eklenmeTarihi:Y?(E==null?void 0:E.eklenmeTarihi)||new Date().toISOString():new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),durumu:1},x={id:Y&&Z?Z.id:0,kullanicilarId:Q,hesapId:r.id,etkilenenHesapId:a.id,hesapKategoriId:r.hesapKategoriId,islemTarihi:we,islemTuruId:4,bilgi:f.description||`Transfer - ${a.userName} (${a.accountNumber})`,aciklama:`${a.userName} hesabından transfer`,tutar:o,borc:0,alacak:o,bakiye:ne,eklenmeTarihi:Y?(Z==null?void 0:Z.eklenmeTarihi)||new Date().toISOString():new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),durumu:1};const[Ne,De]=await Promise.all([Y?k.put(`${ee}/hesapHareket/hesapHareket-update`,S):k.post(`${ee}/hesapHareket/hesapHareket-create`,S),Y?k.put(`${ee}/hesapHareket/hesapHareket-update`,x):k.post(`${ee}/hesapHareket/hesapHareket-create`,x)]);await Promise.all([k.put(`${ee}/Hesap/hesap-update`,{id:a.id,tanim:a.userName,hesapNo:a.accountNumber,guncelBakiye:pe,paraBirimi:a.currency,etiketRengi:a.labelColor,harcamaLimiti:a.spendingLimit||0,guncellenmeTarihi:new Date().toISOString(),hesapKategoriId:a.hesapKategoriId,durumu:Ne.data.durumu||1,aktif:Ne.data.aktif||1,eklenmeTarihi:((c=m.data[0])==null?void 0:c.eklenmeTarihi)||new Date().toISOString()}),k.put(`${ee}/Hesap/hesap-update`,{id:r.id,tanim:r.userName,hesapNo:r.accountNumber,guncelBakiye:ne,paraBirimi:r.currency,etiketRengi:r.labelColor,harcamaLimiti:r.spendingLimit||0,guncellenmeTarihi:new Date().toISOString(),hesapKategoriId:r.hesapKategoriId,durumu:De.data.durumu||1,aktif:De.data.aktif||1,eklenmeTarihi:((z=$.data[0])==null?void 0:z.eklenmeTarihi)||new Date().toISOString()})]);const Ge={id:Ne.data.id||Date.now(),date:f.date||D().format("DD.MM.YYYY"),type:"Transfer Çıkış",userName:a.userName,accountNumber:r.accountNumber,description:`${r.userName} hesabına transfer`,debit:`${o.toLocaleString("tr-TR",{minimumFractionDigits:2})}`,credit:"-",islemTarihi:we,islemTuruId:3,tutar:o,etkilenenHesapId:r.id,hesapId:a.id},Ee={id:De.data.id||Date.now()+1,date:f.date||D().format("DD.MM.YYYY"),type:"Transfer Giriş",userName:r.userName,accountNumber:a.accountNumber,description:`${a.userName} hesabından transfer`,debit:"-",credit:`${o.toLocaleString("tr-TR",{minimumFractionDigits:2})}`,islemTarihi:we,islemTuruId:4,tutar:o,etkilenenHesapId:a.id,hesapId:r.id};let Se=W.filter(J=>J.id!==(E==null?void 0:E.id)&&J.id!==(Z==null?void 0:Z.id));Se.push(Ge,Ee),Se.sort((J,ie)=>D(ie.islemTarihi).isAfter(D(J.islemTarihi))?1:-1),I(Se),F(Se.filter(J=>J.hesapId===(s==null?void 0:s.id))),g(J=>J.map(ie=>ie.id===a.id?{...ie,balance:pe}:ie.id===r.id?{...ie,balance:ne}:ie)),a.id===s.id?se({...a,balance:pe}):r.id===s.id&&se({...r,balance:ne}),V.current.add(w),p({message:Y?"Transfer başarıyla güncellendi.":"Transfer başarıyla gerçekleştirildi.",color:"success"}),H(!1),j(null),n({rawAmount:"",formattedAmount:"",description:"",date:D().format("DD.MM.YYYY"),recipientAccount:"",submissionTimestamp:null})}catch(m){console.error("Transfer error:",{message:m.message,response:(G=m.response)==null?void 0:G.data,status:(A=m.response)==null?void 0:A.status,url:(q=m.config)==null?void 0:q.url,senderPayload:S||"Not defined",recipientPayload:x||"Not defined"}),p({message:`Transfer sırasında hata oluştu: ${((oe=(te=m.response)==null?void 0:te.data)==null?void 0:oe.message)||m.message}`,color:"danger"})}finally{d(!1),h.current=!1}};return e.jsxs(ge,{visible:C,backdrop:"static",keyboard:!1,onClose:()=>{H(!1),j(null),n({id:"",rawAmount:"",formattedAmount:"",description:"",date:D().format("DD.MM.YYYY"),recipientAccount:"",submissionTimestamp:null})},children:[e.jsx(fe,{style:{backgroundColor:"var(--warning-color)",color:"var(--white-color)"},children:e.jsx(ke,{children:u==="outgoing"?"Bu hesaptan başka hesaba para aktar":"Başka hesaptan bu hesaba para aktar"})}),e.jsxs(be,{children:[K.length===0&&e.jsx("p",{children:"Hesaplar yükleniyor..."}),e.jsxs($e,{onSubmit:b,children:[e.jsx(ae,{htmlFor:"date",className:"block text-sm font-semibold mb-3",children:"İşlem Tarihi"}),e.jsx(Ke,{dateAdapter:Pe,children:e.jsx(ze,{value:t,onChange:T=>{l(T),n(w=>({...w,date:T?T.format("DD.MM.YYYY"):""}))},format:"DD.MM.YYYY",slotProps:{textField:{fullWidth:!0,variant:"outlined",size:"small"}}})}),e.jsx(ae,{htmlFor:"amount",className:"mt-3",children:"Tutar"}),e.jsx(le,{type:"text",id:"amount",name:"amount",value:f.formattedAmount,onChange:_,placeholder:"0,00"}),e.jsx(ae,{htmlFor:"description",className:"mt-3",children:"Açıklama"}),e.jsx(le,{type:"text",name:"description",value:f.description,onChange:B}),e.jsx(ae,{htmlFor:"recipientAccount",className:"mt-3",children:u==="outgoing"?"Alıcı Hesap":"Gönderen Hesap"}),e.jsxs(aa,{id:"recipientAccount",name:"recipientAccount",value:f.recipientAccount,onChange:B,children:[e.jsx("option",{value:"",children:"Hesap Seç"}),fa.map(T=>{const w=K.filter(o=>o.hesapKategoriId===T.categoryId&&o.id!==(s==null?void 0:s.id));return w.length>0?e.jsx("optgroup",{label:T.accountName,children:w.map(o=>e.jsxs("option",{value:o.accountNumber,children:[o.userName||"İsim Yok"," -"," ",o.accountNumber||"-"," (",o.currency,")"]},o.id))},T.categoryId):null})]}),e.jsxs(xe,{children:[e.jsx(M,{color:"primary",type:"submit",disabled:O||K.length===0||h.current,children:O?"İşleniyor...":Y?"Güncelle":"Transferi Gerçekleştir"}),e.jsx(M,{color:"secondary",onClick:()=>{H(!1),j(null),n({id:"",rawAmount:"",formattedAmount:"",description:"",date:D().format("DD.MM.YYYY"),recipientAccount:"",submissionTimestamp:null})},children:"İptal"})]})]})]})]})},ba=()=>{const{toast:C,setToast:H,toaster:u}=ue(),[f,n]=ye.useState([]);return ye.useEffect(()=>{if(C){n(t=>[...t,C]);const F=setTimeout(()=>{n(t=>t.slice(1)),H(null)},5e3);return()=>clearTimeout(F)}},[C,H]),e.jsx(sa,{ref:u,placement:"top-end",className:"p-3",children:f.map((F,t)=>e.jsxs(ra,{autohide:5e3,visible:!0,color:F.color,className:"text-white shadow-lg",onClose:()=>{n(l=>l.filter((O,d)=>d!==t)),t===0&&H(null)},children:[e.jsx(ia,{closeButton:{label:"Kapat"},style:{color:"var(--jetBlack-color)"},children:e.jsx("strong",{className:"me-auto",children:"Bildirim"})}),e.jsx(ta,{children:F.message})]},t))})},xa=()=>{const{loading:C,error:H,selectedUser:u}=ue(),f=Le();return C?e.jsx(Ie,{children:e.jsx(Te,{children:"Yükleniyor..."})}):H?e.jsxs(Ie,{className:"mt-4",children:[e.jsx(Ce,{children:"Hesap Bilgisi"}),e.jsxs(Te,{children:[e.jsx(Re,{children:H}),e.jsx(M,{color:"primary",onClick:()=>f("/app/dashboard"),children:"Geri Dön"})]})]}):u?e.jsxs(e.Fragment,{children:[e.jsx(ba,{}),e.jsx(da,{}),e.jsx(ma,{}),e.jsx(Me,{children:e.jsx(Oe,{xs:12,children:e.jsx(ua,{})})}),e.jsx(pa,{}),e.jsx(ga,{}),e.jsx(ka,{})]}):e.jsxs(Ie,{className:"mt-4",children:[e.jsx(Ce,{children:"Hesap Bilgisi"}),e.jsxs(Te,{children:[e.jsx(Re,{children:"Lütfen bir kullanıcı seçin."}),e.jsx(M,{color:"primary",onClick:()=>f("/app/dashboard"),children:"Geri Dön"})]})]})},Sa=()=>e.jsx(na,{children:e.jsx(xa,{})});export{Sa as default};
