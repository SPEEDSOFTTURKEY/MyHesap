import{j as e,g as Ie,s as ve,h as De,m as z,n as Ee,f as ke,q as I,X as Ne,a7 as Re,B as $e,D as Oe,E as Pe,F as je,ae as He,af as Ue,r as h,Z as t,C as Le,a as Ve,b as Ge,c as qe,$ as _e,a0 as We,a1 as Ye,a2 as me,a3 as Je,a4 as ue,ag as Qe,N as ne,Q as ie,S as te,T as le,i as pe,ah as xe,U as g,V as B,a8 as ge,o as Q,W as oe,t as F,u as Xe,ai as Ze,J as ea,ad as aa,K as ra,aj as sa,e as na}from"./index-DAwD_DDx.js";import{c as ia}from"./cil-money-Dk3vHnQB.js";import{c as ta}from"./cil-transfer-BeKoe_Wl.js";import{c as Me}from"./cil-file-CeQgYs_D.js";import{c as Te}from"./cil-warning-C7g3f07Q.js";const la=({employee:n})=>e.jsxs(Ie,{className:"mb-3 shadow-sm w-50",children:[e.jsx(ve,{className:"p-3",style:{backgroundColor:"#2965A8",color:"#FFFFFF"},children:e.jsx("h4",{children:e.jsx("strong",{children:(n==null?void 0:n.adiSoyadi)||"Çalışan Bilgisi"})})}),e.jsxs(De,{className:"d-flex",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-center me-4",style:{width:"70px",height:"70px",borderRadius:"50%",overflow:"hidden",backgroundColor:"#e9ecef"},children:[n!=null&&n.fotograf?e.jsx("img",{src:n.fotograf,alt:"Çalışan Fotoğrafı",style:{width:"100%",height:"100%",objectFit:"cover"},onError:u=>{u.target.style.display="none",u.target.nextSibling.style.display="block"}}):null,e.jsx(z,{icon:Ee,size:"xl",style:{display:n!=null&&n.fotograf?"none":"block"}})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Telefon:"})," ",(n==null?void 0:n.telefon)||"Bilinmiyor"]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"E-posta:"})," ",(n==null?void 0:n.email)||"Bilinmiyor"]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Bakiye:"})," ",(n==null?void 0:n.balance)||"Veri bulunamadı"]})]})]})]}),oa=({onUpdate:n,onDelete:u,onModalToggle:b,onExpense:N,onStatement:f,onDocuments:Y,disableDocuments:K})=>{const R={cursor:"pointer",padding:"8px 16px",fontSize:"14px","--cui-dropdown-link-hover-color":"#ffffff","--cui-dropdown-link-hover-bg":"#34A149","--cui-dropdown-link-active-color":"#ffffff","--cui-dropdown-link-active-bg":"#34A149"};return e.jsxs(ke,{className:"d-flex gap-2 flex-wrap",children:[e.jsxs(I,{className:"mx-1 text-white",color:"info",size:"sm",onClick:n,children:[e.jsx(z,{icon:Ne})," Güncelle"]}),e.jsxs(I,{className:"mx-1 text-white",color:"danger",size:"sm",onClick:u,children:[e.jsx(z,{icon:Re})," Sil"]}),e.jsxs($e,{children:[e.jsxs(Oe,{className:"mx-1 text-white",color:"success",size:"sm",children:[e.jsx("span",{style:{fontSize:"medium"},children:"₺"})," Ödeme İşlemleri"]}),e.jsxs(Pe,{children:[e.jsx(je,{style:R,onClick:()=>b("accrual"),children:"Maaş/Prim Tahakkuku Yap"}),e.jsxs(je,{style:R,onClick:()=>b("payment"),children:[e.jsx(z,{icon:ia})," Ödeme Yap (Maaş/Prim/Avans)"]}),e.jsxs(je,{style:R,onClick:()=>b("advanceReturn"),children:[e.jsx(z,{icon:He})," Avans İadesi Al"]}),e.jsxs(je,{style:R,onClick:()=>b("debtCredit"),children:[e.jsx(z,{icon:ta})," Borç-Alacak Fişleri"]})]})]}),e.jsxs(I,{className:"mx-1 text-white",color:"danger",size:"sm",onClick:N,children:[e.jsx(z,{icon:Ue})," Masraf Kaydet"]}),e.jsxs(I,{className:"mx-1 text-white",color:"warning",size:"sm",onClick:f,children:[e.jsx(z,{icon:Me})," Hesap Ekstresi"]}),e.jsxs(I,{className:"mx-1 text-white",color:"secondary",size:"sm",onClick:Y,disabled:K,children:[e.jsx(z,{icon:Me})," Dökümanlar"]})]})},we="https://speedsofttest.com/api",ca=({transactions:n,loading:u,error:b,currency:N="TRY",onPrint:f,addToast:Y,onRefresh:K,expenseMainCategories:R,expenseSubCategories:v})=>{const[_,X]=h.useState(!1),[M,P]=h.useState(!1),[j,H]=h.useState(null),[c,U]=h.useState({id:0,tarih:t(),masrafAnaKategoriId:"",masrafAltKategoriId:"",calisanId:0,durumu:"1",aciklama:"",borc:"",alacak:"",bakiye:""}),[d,L]=h.useState(!1),D=r=>{var p,y,k,J,m,l;H(r),U({id:r.id,tarih:r.tarih?t(r.tarih):t(),masrafAnaKategoriId:((p=r.masrafAnaKategoriId)==null?void 0:p.toString())||"",masrafAltKategoriId:((y=r.masrafAltKategoriId)==null?void 0:y.toString())||"",calisanId:r.calisanId,durumu:((k=r.durumu)==null?void 0:k.toString())||"1",aciklama:r.aciklama||"",borc:((J=r.borc)==null?void 0:J.toString())||"",alacak:((m=r.alacak)==null?void 0:m.toString())||"",bakiye:((l=r.bakiye)==null?void 0:l.toString())||""}),X(!0)},W=r=>{H(r),P(!0)},ye=async()=>{var r,p;if(!(j!=null&&j.id)){Y("Cari işlem ID'si eksik","hata");return}L(!0);try{await F.delete(`${we}/calisancari/calisancari-delete/${j.id}`,{headers:{accept:"*/*"}}),Y("Cari işlem başarıyla silindi","başarılı"),K()}catch(y){console.error("Cari işlem silinirken hata:",y),Y("Cari işlem silinemedi: "+(((p=(r=y.response)==null?void 0:r.data)==null?void 0:p.message)||y.message),"hata")}finally{L(!1),P(!1),H(null)}},w=r=>{const{name:p,value:y}=r.target;U(k=>({...k,[p]:y,...p==="masrafAnaKategoriId"?{masrafAltKategoriId:""}:{}}))},be=async r=>{var p,y;r.preventDefault(),L(!0);try{const k={id:c.id,tarih:c.tarih.format("YYYY-MM-DD"),eklenmeTarihi:j.eklenmeTarihi||t().toISOString(),guncellenmeTarihi:t().toISOString(),masrafAnaKategoriId:parseInt(c.masrafAnaKategoriId)||0,masrafAltKategoriId:parseInt(c.masrafAltKategoriId)||0,calisanId:parseInt(c.calisanId),durumu:parseInt(c.durumu),aciklama:c.aciklama,borc:parseFloat(c.borc)||0,alacak:parseFloat(c.alacak)||0,bakiye:parseFloat(c.bakiye)||0};await F.put(`${we}/calisancari/calisancari-update`,k,{headers:{"Content-Type":"application/json",accept:"*/*"}}),Y("Cari işlem başarıyla güncellendi","başarılı"),X(!1),K()}catch(k){console.error("Cari işlem güncellenirken hata:",k),Y("Cari işlem güncellenemedi: "+(((y=(p=k.response)==null?void 0:p.data)==null?void 0:y.message)||k.message),"hata")}finally{L(!1)}},ae=r=>{if(!r.masrafAnaKategoriId&&!r.masrafAltKategoriId)return"-";const p=R.find(J=>J.id===r.masrafAnaKategoriId),y=v.find(J=>J.id===r.masrafAltKategoriId);let k="";return p&&(k+=p.adi),y&&(k+=k?` - ${y.adi}`:y.adi),k||"-"};return e.jsxs(e.Fragment,{children:[e.jsx(Le,{placement:"top-end",className:"p-3",children:b&&e.jsxs(Ve,{autohide:5e3,visible:!!b,color:"danger",children:[e.jsx(Ge,{closeButton:{label:"Kapat"},children:e.jsx("strong",{className:"me-auto",children:"Hata"})}),e.jsx(qe,{children:b})]})}),e.jsxs(Ie,{className:"mb-3",children:[e.jsx(ve,{className:"p-3",style:{backgroundColor:"#2965A8",color:"#ffffff"},children:e.jsx("h5",{children:"Önceki Cari İşlemler"})}),e.jsxs(De,{children:[u&&e.jsx("p",{children:"Yükleniyor..."}),!u&&!b&&n.length>0?e.jsxs(_e,{responsive:!0,children:[e.jsx(We,{children:e.jsxs(Ye,{children:[e.jsx(me,{children:"Tarih"}),e.jsx(me,{children:"Masraf Kalemi"}),e.jsx(me,{children:"Açıklama"}),e.jsx(me,{children:"Borç"}),e.jsx(me,{children:"Alacak"}),e.jsx(me,{children:"Bakiye"}),e.jsx(me,{children:"İşlemler"})]})}),e.jsx(Je,{className:"my-2",children:n.map(r=>e.jsxs(Ye,{children:[e.jsx(ue,{children:r.tarih?t(r.tarih).format("DD.MM.YYYY"):"-"}),e.jsx(ue,{children:ae(r)}),e.jsx(ue,{children:r.aciklama||"-"}),e.jsx(ue,{children:r.borc?`${r.borc.toLocaleString("tr-TR")} ${N}`:"-"}),e.jsx(ue,{children:r.alacak?`${r.alacak.toLocaleString("tr-TR")} ${N}`:"-"}),e.jsx(ue,{children:r.bakiye?`${r.bakiye.toLocaleString("tr-TR")} ${N}`:"-"}),e.jsxs(ue,{children:[e.jsx(I,{color:"info",size:"sm",style:{color:"white",marginBottom:"3px"},onClick:()=>f("Yazdırma işlemi başlatıldı","başarılı"),className:"me-2",disabled:!0,children:e.jsx(z,{icon:Qe})}),e.jsx(I,{color:"warning",size:"sm",style:{color:"white",marginBottom:"3px"},onClick:()=>D(r),className:"me-2",disabled:d,children:e.jsx(z,{icon:Ne})}),e.jsx(I,{color:"danger",size:"sm",style:{color:"white"},onClick:()=>W(r),disabled:d,children:e.jsx(z,{icon:Re})})]})]},r.id))})]}):!u&&!b&&e.jsx("p",{children:"Henüz işlem bulunmamaktadır."})]})]}),e.jsxs(ne,{visible:_,onClose:()=>X(!1),backdrop:"static",keyboard:!1,children:[e.jsx(ie,{style:{backgroundColor:"#2965A2",color:"white"},children:e.jsx(te,{children:"Cari İşlem Düzenle"})}),e.jsx(le,{children:e.jsxs(pe,{onSubmit:be,children:[e.jsx(xe,{label:"Tarih",value:c.tarih,onChange:r=>U(p=>({...p,tarih:r}))}),e.jsx(g,{htmlFor:"masrafAnaKategoriId",className:"mt-3",children:"Masraf Ana Kategorisi"}),e.jsxs(B,{id:"masrafAnaKategoriId",name:"masrafAnaKategoriId",value:c.masrafAnaKategoriId,onChange:w,className:"mb-3",disabled:d,children:[e.jsx("option",{value:"",children:"Seçiniz"}),R.map(r=>e.jsx("option",{value:r.id,children:r.adi},r.id))]}),e.jsx(g,{htmlFor:"masrafAltKategoriId",className:"mt-3",children:"Masraf Alt Kategorisi"}),e.jsxs(B,{id:"masrafAltKategoriId",name:"masrafAltKategoriId",value:c.masrafAltKategoriId,onChange:w,className:"mb-3",disabled:d||!c.masrafAnaKategoriId,children:[e.jsx("option",{value:"",children:"Seçiniz"}),v.filter(r=>{var p;return((p=r.masrafAnaKategoriId)==null?void 0:p.toString())===c.masrafAnaKategoriId}).map(r=>e.jsx("option",{value:r.id,children:r.adi},r.id))]}),e.jsx(g,{htmlFor:"durumu",className:"mt-3",children:"Durum"}),e.jsxs(B,{id:"durumu",name:"durumu",value:c.durumu,onChange:w,className:"mb-3",disabled:d,children:[e.jsx("option",{value:"1",children:"Aktif"}),e.jsx("option",{value:"0",children:"Pasif"})]}),e.jsx(g,{htmlFor:"aciklama",className:"mt-3",children:"Açıklama"}),e.jsx(ge,{id:"aciklama",name:"aciklama",rows:3,value:c.aciklama,onChange:w,className:"mb-3",disabled:d}),e.jsx(g,{htmlFor:"borc",className:"mt-3",children:"Borç"}),e.jsx(Q,{type:"number",id:"borc",name:"borc",value:c.borc,onChange:w,placeholder:"0.00",step:"0.01",className:"mb-3",disabled:d}),e.jsx(g,{htmlFor:"alacak",className:"mt-3",children:"Alacak"}),e.jsx(Q,{type:"number",id:"alacak",name:"alacak",value:c.alacak,onChange:w,placeholder:"0.00",step:"0.01",className:"mb-3",disabled:d}),e.jsx(g,{htmlFor:"bakiye",className:"mt-3",children:"Bakiye"}),e.jsx(Q,{type:"number",id:"bakiye",name:"bakiye",value:c.bakiye,onChange:w,placeholder:"0.00",step:"0.01",className:"mb-3",disabled:d}),e.jsxs(oe,{children:[e.jsx(I,{color:"primary",type:"submit",disabled:d,children:"Kaydet"}),e.jsx(I,{color:"secondary",onClick:()=>X(!1),disabled:d,children:"İptal"})]})]})})]}),e.jsxs(ne,{visible:M,onClose:()=>{P(!1),H(null)},backdrop:"static",children:[e.jsx(ie,{style:{backgroundColor:"#DC3545",color:"white"},children:e.jsx(te,{children:"Silme Onayı"})}),e.jsx(le,{children:e.jsx("p",{children:"Bu cari işlemi silmek istediğinize emin misiniz? Bu işlem geri alınamaz."})}),e.jsxs(oe,{children:[e.jsx(I,{color:"secondary",style:{color:"white"},onClick:()=>{P(!1),H(null)},disabled:d,children:"Hayır"}),e.jsx(I,{color:"danger",style:{color:"white"},onClick:ye,disabled:d,children:"Evet"})]})]})]})},q="https://speedsofttest.com/api",da=({modalState:n,setModalState:u,employeeId:b,onSubmit:N,addToast:f})=>{var Ae,Se;const[Y,K]=h.useState([]),[R,v]=h.useState([]),[_,X]=h.useState([]),[M,P]=h.useState({date:t().format("YYYY-MM-DD"),amount:"",currency:"TRY",expenseMainCategoryId:"",expenseSubCategoryId:"",description:""}),[j,H]=h.useState({date:t().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),[c,U]=h.useState({date:t().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),[d,L]=h.useState({transactionType:"Alacak",date:t().format("YYYY-MM-DD"),amount:"",currency:"TRY",description:"",expenseMainCategoryId:"",expenseSubCategoryId:""}),[D,W]=h.useState({date:t().format("YYYY-MM-DD"),documentNumber:"",expenseMainCategoryId:"",expenseSubCategoryId:"",amount:"",vatRate:"",currency:"TRY",description:""}),[ye,w]=h.useState(t()),[be,ae]=h.useState(t()),[r,p]=h.useState(t()),[y,k]=h.useState(t()),[J,m]=h.useState(t()),[l,T]=h.useState(!1),he=async()=>{var a,i,x;if(!(l||Y.length>0&&R.length>0&&_.length>0))try{if(T(!0),!Y.length){const o=await F.get(`${q}/Hesap/hesap-get-all`,{headers:{accept:"*/*"}}),A=Array.isArray(o.data)?o.data.map(C=>({id:C.id,userName:C.tanim,currency:C.paraBirimi,balance:C.guncelBakiye,accountNumber:C.hesapNo,labelColor:C.etiketRengi,spendingLimit:C.harcamaLimiti,type:C.hesapKategoriId})):[];K(A)}if(!R.length){const o=await F.get(`${q}/masrafAnaKategori/masrafAnaKategori-get-all`,{headers:{accept:"*/*"}}),A=Array.isArray(o.data)?o.data:[];v(A)}if(!_.length){const o=await F.get(`${q}/masrafAltKategori/masrafAltKategori-get-all`,{headers:{accept:"*/*"}}),A=Array.isArray(o.data)?o.data:[];X(A)}}catch(o){console.error("Veri çekme hatası:",o,(a=o.response)==null?void 0:a.data),f("Hesaplar veya masraf kategorileri yüklenemedi: "+(((x=(i=o.response)==null?void 0:i.data)==null?void 0:x.message)||o.message),"hata")}finally{T(!1)}};h.useEffect(()=>{(n.payment||n.advanceReturn||n.accrual||n.debtCredit||n.expense)&&he()},[n.payment,n.advanceReturn,n.accrual,n.debtCredit,n.expense]);const re=async()=>{try{const a=await F.get(`${q}/calisancari/calisancaricalisan-get-by-Id/${b}`);return(Array.isArray(a.data)?a.data:[]).reduce((o,A)=>{const C=A.borc||0,s=A.alacak||0;return o+(s-C)},0)}catch(a){throw console.error("Bakiye alınamadı:",a),f("Bakiye kontrolü başarısız.","hata"),a}},se=a=>{const{name:i,value:x}=a.target;P(o=>({...o,[i]:x,...i==="expenseMainCategoryId"?{expenseSubCategoryId:""}:{}}))},E=a=>{const{name:i,value:x}=a.target;H(o=>({...o,[i]:x}))},$=a=>{const{name:i,value:x}=a.target;U(o=>({...o,[i]:x}))},ce=a=>{const{name:i,value:x}=a.target;L(o=>({...o,[i]:x,...i==="expenseMainCategoryId"?{expenseSubCategoryId:""}:{}}))},Z=a=>{const{name:i,value:x}=a.target;W(o=>({...o,[i]:x,...i==="expenseMainCategoryId"?{expenseSubCategoryId:""}:{}}))},V=async a=>{var i,x,o,A,C;if(a.preventDefault(),!M.amount||!M.expenseMainCategoryId||!M.expenseSubCategoryId){f("Tutar ve masraf kategorileri zorunlu.","hata");return}try{T(!0);const s=parseFloat(M.amount),O=await re()+s,ee={id:0,tarih:new Date(M.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:parseInt(M.expenseMainCategoryId),masrafAltKategoriId:parseInt(M.expenseSubCategoryId),calisanId:parseInt(b),durumu:0,aciklama:M.description||"Maaş/Prim tahakkuku",borc:0,alacak:s,bakiye:O};await F.post(`${q}/calisancari/calisancari-create`,ee),f("Maaş tahakkuku kaydedildi","başarılı"),u(G=>({...G,accrual:!1})),P({date:t().format("YYYY-MM-DD"),amount:"",currency:"TRY",expenseMainCategoryId:"",expenseSubCategoryId:"",description:""}),w(t()),N(b)}catch(s){const S=((x=(i=s.response)==null?void 0:i.data)==null?void 0:x.message)||s.message;console.error("Tahakkuk hatası:",{message:S,status:(o=s.response)==null?void 0:o.status,url:(A=s.config)==null?void 0:A.url,data:(C=s.config)==null?void 0:C.data}),f("Maaş tahakkuku kaydedilemedi: "+S,"hata")}finally{T(!1)}},Be=async a=>{var i,x,o,A,C;if(a.preventDefault(),!j.accountId||!j.amount){f("Hesap ve tutar zorunlu.","hata");return}try{T(!0);const s=parseFloat(j.amount),O=await re()-s,ee={id:0,tarih:new Date(j.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:0,masrafAltKategoriId:0,calisanId:parseInt(b),durumu:0,aciklama:j.description||"Maaş/Prim/Avans ödemesi",borc:s,alacak:0,bakiye:O};await F.post(`${q}/calisancari/calisancari-create`,ee);const G=Y.find(de=>de.id===parseInt(j.accountId)),fe={id:0,kullanicilarId:parseInt(b),hesapId:parseInt(j.accountId),etkilenenHesapId:0,hesapKategoriId:G.type,islemTarihi:new Date(j.date).toISOString(),islemTuruId:2,bilgi:j.description,aciklama:"Maaş/Prim/Avans ödemesi",borc:s,alacak:0,bakiye:G.balance-s,eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString()};await F.post(`${q}/hesapHareket/hesapHareket-create`,fe),f("Ödeme kaydedildi","başarılı"),u(de=>({...de,payment:!1})),H({date:t().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),ae(t()),N(b)}catch(s){const S=(i=s.response)==null?void 0:i.status,O=((o=(x=s.response)==null?void 0:x.data)==null?void 0:o.message)||s.message;console.error("Ödeme hatası:",{message:O,status:S,url:(A=s.config)==null?void 0:A.url,data:(C=s.config)==null?void 0:C.data}),f(`Ödeme kaydedilemedi: ${S?`Durum ${S}, `:""}${O}`,"hata")}finally{T(!1)}},Fe=async a=>{var i,x,o,A,C;if(a.preventDefault(),!c.accountId||!c.amount){f("Hesap ve tutar zorunlu.","hata");return}try{T(!0);const s=parseFloat(c.amount),O=await re()+s,ee={id:0,tarih:new Date(c.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:0,masrafAltKategoriId:0,calisanId:parseInt(b),durumu:0,aciklama:c.description||"Avans iadesi",borc:0,alacak:s,bakiye:O};await F.post(`${q}/calisancari/calisancari-create`,ee);const G=Y.find(de=>de.id===parseInt(c.accountId)),fe={id:0,kullanicilarId:parseInt(b),hesapId:parseInt(c.accountId),etkilenenHesapId:0,hesapKategoriId:G.type,islemTarihi:new Date(c.date).toISOString(),islemTuruId:1,bilgi:c.description,aciklama:"Avans iadesi",borc:0,alacak:s,bakiye:G.balance+s,eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString()};await F.post(`${q}/hesapHareket/hesapHareket-create`,fe),f("Avans iadesi kaydedildi","başarılı"),u(de=>({...de,advanceReturn:!1})),U({date:t().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),p(t()),N(b)}catch(s){const S=((x=(i=s.response)==null?void 0:i.data)==null?void 0:x.message)||s.message;console.error("Avans iadesi hatası:",{message:S,status:(o=s.response)==null?void 0:o.status,url:(A=s.config)==null?void 0:A.url,data:(C=s.config)==null?void 0:C.data}),f("Avans iadesi kaydedilemedi: "+S,"hata")}finally{T(!1)}},Ke=async a=>{var i,x,o,A,C;if(a.preventDefault(),!d.amount){f("Tutar zorunlu.","hata");return}try{T(!0);const s=parseFloat(d.amount),S=d.transactionType==="Borç",O=await re(),ee=S?O-s:O+s,G={id:0,tarih:new Date(d.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:parseInt(d.expenseMainCategoryId)||0,masrafAltKategoriId:parseInt(d.expenseSubCategoryId)||0,calisanId:parseInt(b),durumu:0,aciklama:d.description||"Borç/Alacak fişi",borc:S?s:0,alacak:S?0:s,bakiye:ee};await F.post(`${q}/calisancari/calisancari-create`,G),f("Borç/Alacak fişi kaydedildi","başarılı"),u(fe=>({...fe,debtCredit:!1})),L({transactionType:"Alacak",date:t().format("YYYY-MM-DD"),amount:"",currency:"TRY",description:"",expenseMainCategoryId:"",expenseSubCategoryId:""}),k(t()),N(b)}catch(s){const S=((x=(i=s.response)==null?void 0:i.data)==null?void 0:x.message)||s.message;console.error("Borç/Alacak hatası:",{message:S,status:(o=s.response)==null?void 0:o.status,url:(A=s.config)==null?void 0:A.url,data:(C=s.config)==null?void 0:C.data}),f("Borç/Alacak fişi kaydedilemedi: "+S,"hata")}finally{T(!1)}},ze=async a=>{var i,x,o,A,C;if(a.preventDefault(),!D.amount||!D.expenseMainCategoryId||!D.expenseSubCategoryId){f("Tutar ve masraf kategorileri zorunlu.","hata");return}try{T(!0);const s=parseFloat(D.amount),O=await re()+s,ee={id:0,tarih:new Date(D.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:parseInt(D.expenseMainCategoryId),masrafAltKategoriId:parseInt(D.expenseSubCategoryId),calisanId:parseInt(b),durumu:0,aciklama:D.description||`Masraf kaydı: ${D.documentNumber}`,borc:0,alacak:s,bakiye:O,fisBelgeNo:D.documentNumber||"",kdvOrani:parseFloat(D.vatRate)||0};await F.post(`${q}/calisancari/calisancari-create`,ee),f("Masraf kaydı kaydedildi","başarılı"),u(G=>({...G,expense:!1})),W({date:t().format("YYYY-MM-DD"),documentNumber:"",expenseMainCategoryId:"",expenseSubCategoryId:"",amount:"",vatRate:"",currency:"TRY",description:""}),m(t()),N(b)}catch(s){const S=((x=(i=s.response)==null?void 0:i.data)==null?void 0:x.message)||s.message;console.error("Masraf hatası:",{message:S,status:(o=s.response)==null?void 0:o.status,url:(A=s.config)==null?void 0:A.url,data:(C=s.config)==null?void 0:C.data}),f("Masraf kaydı kaydedilemedi: "+S,"hata")}finally{T(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(ne,{visible:n.accrual,backdrop:"static",keyboard:!1,onClose:()=>{u(a=>({...a,accrual:!1})),P({date:t().format("YYYY-MM-DD"),amount:"",currency:"TRY",expenseMainCategoryId:"",expenseSubCategoryId:"",description:""}),w(t())},children:[e.jsx(ie,{children:e.jsx(te,{children:"Maaş/Prim Tahakkuku Yap"})}),e.jsxs(le,{children:[l&&e.jsx("p",{children:"Veriler yükleniyor..."}),e.jsxs(pe,{onSubmit:V,children:[e.jsx("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:e.jsx("p",{className:"mb-0",children:"'Hakedilen Net Maaş' alanına çalışanın hak ettiği net maaş/prim tutarını yazın. Kaydettiğinizde hem çalışan için alacak kaydı, hem de seçtiğiniz masraf kalemi için gider yazılacaktır. 'Açıklama' alanına 'Şubat maaşı' vb. yazabilirsiniz."})}),e.jsxs("p",{style:{fontWeight:"bold",color:"#dc3545",display:"flex",alignItems:"center",marginBottom:"20px"},children:[e.jsx(z,{icon:Te,style:{marginRight:"5px"}}),"Bu işlem kasa ya da banka hesabınızı etkilemez, sadece çalışanı alacaklandırır. Bu işlemden sonra, ödeme yapmak için 'Ödeme Yap' seçeneğini kullanın."]}),e.jsx(xe,{label:"Hakediş Tarihi",value:ye,onChange:a=>{w(a),P(i=>({...i,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(g,{htmlFor:"amount",children:"Hakedilen Net Maaş"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(Q,{type:"number",id:"amount",name:"amount",value:M.amount,onChange:se,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(B,{name:"currency",value:M.currency,onChange:se,style:{width:"100px"},disabled:l,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(g,{htmlFor:"expenseMainCategoryId",className:"mt-3",children:"Masraf Ana Kategorisi"}),e.jsxs(B,{id:"expenseMainCategoryId",name:"expenseMainCategoryId",value:M.expenseMainCategoryId,onChange:se,required:!0,className:"mb-3",disabled:l,children:[e.jsx("option",{value:"",children:"Seçiniz"}),R.length>0?R.map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Ana kategoriler yüklenemedi"})]}),e.jsx(g,{htmlFor:"expenseSubCategoryId",className:"mt-3",children:"Masraf Alt Kategorisi"}),e.jsxs(B,{id:"expenseSubCategoryId",name:"expenseSubCategoryId",value:M.expenseSubCategoryId,onChange:se,required:!0,className:"mb-3",disabled:l||!M.expenseMainCategoryId,children:[e.jsx("option",{value:"",children:"Seçiniz"}),_.filter(a=>{var i;return((i=a.masrafAnaKategoriId)==null?void 0:i.toString())===M.expenseMainCategoryId}).map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id))]}),e.jsx(g,{htmlFor:"description",children:"Açıklama"}),e.jsx(ge,{name:"description",rows:3,value:M.description,onChange:se,placeholder:"Ör: Şubat maaşı",className:"mb-3"}),e.jsxs(oe,{children:[e.jsx(I,{color:"primary",type:"submit",disabled:l,children:"Maaş Tahakkuku Oluştur"}),e.jsx(I,{color:"secondary",onClick:()=>{u(a=>({...a,accrual:!1})),P({date:t().format("YYYY-MM-DD"),amount:"",currency:"TRY",expenseMainCategoryId:"",expenseSubCategoryId:"",description:""}),w(t())},children:"İptal"})]})]})]})]}),e.jsxs(ne,{visible:n.payment,backdrop:"static",keyboard:!0,onClose:()=>{u(a=>({...a,payment:!1})),H({date:t().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),ae(t())},children:[e.jsx(ie,{children:e.jsx(te,{children:"Ödeme Yap (Maaş/Prim/Avans)"})}),e.jsxs(le,{children:[l&&e.jsx("p",{children:"Hesaplar yükleniyor..."}),e.jsxs(pe,{onSubmit:Be,children:[e.jsx("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:e.jsx("p",{className:"mb-0",children:"Ödemeyi kaydetiğinizde sistem seçtiğiniz kasa/banka hesabından 'Ödediğiniz Net Tutar' kadar miktarı çalışana borç yazdıracaktır."})}),e.jsxs("p",{style:{fontWeight:"bold",color:"#dc3545",display:"flex",alignItems:"center",marginBottom:"20px"},children:[e.jsx(z,{icon:Te,style:{marginRight:"5px"}}),"Maaş ya da prim ödemesi yapmadan önce 'Maaş/Prim Tahakkuku Yap' seçeneği ile çalışanıınızı alacaklandırmayı ve şirketiniz için masraf oluşturmayı unutmayın."]}),e.jsx(xe,{label:"Ödeme Tarihi",value:be,onChange:a=>{ae(a),H(i=>({...i,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(g,{htmlFor:"accountId",children:"Hesap Seç"}),e.jsxs(B,{id:"accountId",name:"accountId",value:j.accountId,onChange:E,required:!0,className:"mb-3",disabled:l,children:[e.jsx("option",{value:"",children:"Seçiniz"}),Y.length>0?Y.map(a=>e.jsxs("option",{value:a.id,children:[a.userName," (",a.currency,")"]},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Hesap bulunamadı"})]}),e.jsxs("p",{className:"mt-2 mb-3",children:[e.jsx("strong",{children:"Güncel bakiye: "}),j.accountId?`${(((Ae=Y.find(a=>a.id===parseInt(j.accountId)))==null?void 0:Ae.balance)||0).toLocaleString("tr-TR")} ${((Se=Y.find(a=>a.id===parseInt(j.accountId)))==null?void 0:Se.currency)||"TRY"}`:"0.00 TRY"]}),e.jsx(g,{htmlFor:"paymentAmount",children:"Ödediğiniz Net Tutar"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(Q,{type:"number",id:"paymentAmount",name:"amount",value:j.amount,onChange:E,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(B,{name:"currency",value:j.currency,onChange:E,style:{width:"100px"},disabled:l,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(g,{htmlFor:"paymentDescription",children:"Açıklama"}),e.jsx(ge,{name:"description",rows:3,value:j.description,onChange:E,placeholder:"Ör: Maaş ödemesi",className:"mb-3"}),e.jsxs(oe,{children:[e.jsx(I,{color:"primary",type:"submit",disabled:l,children:"Ödemeyi Kaydet"}),e.jsx(I,{color:"secondary",onClick:()=>{u(a=>({...a,payment:!1})),H({date:t().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),ae(t())},children:"İptal"})]})]})]})]}),e.jsxs(ne,{visible:n.advanceReturn,backdrop:"true",keyboard:!0,onClose:()=>{u(a=>({...a,advanceReturn:!1})),U({date:t().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),p(t())},children:[e.jsx(ie,{children:e.jsx(te,{children:"Avans İadesi Al"})}),e.jsxs(le,{children:[l&&e.jsx("p",{children:"Hesaplar yükleniyor..."}),e.jsxs(pe,{onSubmit:Fe,children:[e.jsx(xe,{label:"İşlem Tarihi",value:r,onChange:a=>{p(a),U(i=>({...i,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(g,{htmlFor:"advanceReturnAccountId",children:"Hesap Seç"}),e.jsxs(B,{id:"advanceReturnAccountId",name:"accountId",value:c.accountId,onChange:$,required:!0,className:"mb-3",disabled:l,children:[e.jsx("option",{value:"",children:"Seçiniz"}),Y.length>0?Y.map(a=>e.jsxs("option",{value:a.id,children:[a.userName," (",a.currency,")"]},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Hesap bulunamadı"})]}),e.jsx(g,{htmlFor:"advanceReturnAmount",children:"İade Tutarı"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(Q,{type:"number",id:"advanceReturnAmount",name:"amount",value:c.amount,onChange:$,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(B,{name:"currency",value:c.currency,onChange:$,style:{width:"100px"},disabled:l,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(g,{htmlFor:"advanceReturnDescription",children:"Açıklama"}),e.jsx(ge,{name:"description",rows:3,value:c.description,onChange:$,placeholder:"Ör: Avans iadesi",className:"mb-3"}),e.jsxs(oe,{children:[e.jsx(I,{color:"primary",type:"submit",disabled:l,children:"Avans İadesi Kaydet"}),e.jsx(I,{color:"secondary",onClick:()=>{u(a=>({...a,advanceReturn:!1})),U({date:t().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),p(t())},children:"İptal"})]})]})]})]}),e.jsxs(ne,{visible:n.debtCredit,backdrop:"true",keyboard:!0,onClose:()=>{u(a=>({...a,debtCredit:!1})),L({transactionType:"Alacak",date:t().format("YYYY-MM-DD"),amount:"",currency:"TRY",description:"",expenseMainCategoryId:"",expenseSubCategoryId:""}),k(t())},children:[e.jsx(ie,{children:e.jsx(te,{children:"Borç/Alacak Fişleri"})}),e.jsx(le,{children:e.jsxs(pe,{onSubmit:Ke,children:[e.jsx("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:e.jsx("p",{className:"mb-0",children:"Herhangi bir ödeme, masraf, maaş ya da prim işlemi olmadan çalışanın bakiyesini değiştirmek için borç ya da alacak fişi kaydı oluşturabilirsiniz. Çalışanın güncel bakiyesi burada gireceğiniz tutar kadar değişecektir."})}),e.jsx(g,{htmlFor:"transactionType",children:"İşlem Tipi"}),e.jsxs(B,{id:"transactionType",name:"transactionType",value:d.transactionType,onChange:ce,className:"mb-3",children:[e.jsx("option",{value:"Alacak",children:"Alacak Fişi"}),e.jsx("option",{value:"Borç",children:"Borç Fişi"})]}),e.jsx("p",{className:"mb-3",children:d.transactionType==="Alacak"?"Çalışan alacaklanacak.":"Çalışan borçlanacak."}),e.jsx(g,{htmlFor:"expenseMainCategoryId",className:"mt-3",children:"Masraf Ana Kategorisi"}),e.jsxs(B,{id:"expenseMainCategoryId",name:"expenseMainCategoryId",value:d.expenseMainCategoryId,onChange:ce,className:"mb-3",disabled:l,children:[e.jsx("option",{value:"",children:"Seçiniz (İsteğe bağlı)"}),R.length>0?R.map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Ana kategoriler yüklenemedi"})]}),e.jsx(g,{htmlFor:"expenseSubCategoryId",className:"mt-3",children:"Masraf Alt Kategorisi"}),e.jsxs(B,{id:"expenseSubCategoryId",name:"expenseSubCategoryId",value:d.expenseSubCategoryId,onChange:ce,className:"mb-3",disabled:l||!d.expenseMainCategoryId,children:[e.jsx("option",{value:"",children:"Seçiniz (İsteğe bağlı)"}),_.filter(a=>{var i;return((i=a.masrafAnaKategoriId)==null?void 0:i.toString())===d.expenseMainCategoryId}).map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id))]}),e.jsx(xe,{label:"İşlem Tarihi",value:y,onChange:a=>{k(a),L(i=>({...i,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(g,{htmlFor:"debtCreditAmount",children:"Tutar"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(Q,{type:"number",name:"amount",id:"debtCreditAmount",value:d.amount,onChange:ce,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(B,{name:"currency",value:d.currency,onChange:ce,style:{width:"100px"},disabled:l,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(g,{htmlFor:"debtCreditDescription",children:"Açıklama"}),e.jsx(ge,{name:"description",rows:3,value:d.description,onChange:ce,placeholder:"Ör: Borç/Alacak düzeltmesi",className:"mb-3"}),e.jsxs(oe,{children:[e.jsx(I,{color:"primary",type:"submit",disabled:l,children:"Kaydet"}),e.jsx(I,{color:"secondary",onClick:()=>{u(a=>({...a,debtCredit:!1})),L({transactionType:"Alacak",date:t().format("YYYY-MM-DD"),amount:"",currency:"TRY",description:"",expenseMainCategoryId:"",expenseSubCategoryId:""}),k(t())},children:"Vazgeç"})]})]})})]}),e.jsxs(ne,{visible:n.expense,backdrop:"true",keyboard:!0,onClose:()=>{u(a=>({...a,expense:!1})),W({date:t().format("YYYY-MM-DD"),documentNumber:"",expenseMainCategoryId:"",expenseSubCategoryId:"",amount:"",vatRate:"",currency:"TRY",description:""}),m(t())},children:[e.jsx(ie,{children:e.jsx(te,{children:"Masraf Girişi"})}),e.jsxs(le,{children:[l&&e.jsx("p",{children:"Veriler yükleniyor..."}),e.jsxs(pe,{onSubmit:ze,children:[e.jsx("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:e.jsx("p",{className:"mb-0",children:"Çalışanınızın size getirdiği masrafları buradan girebilirsiniz. Masraf kaydından sonra çalışan alacaklanır."})}),e.jsx(xe,{label:"Masraf Tarihi",value:J,onChange:a=>{m(a),W(i=>({...i,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(g,{htmlFor:"documentNumber",children:"Fiş/Belge No"}),e.jsx(Q,{id:"documentNumber",name:"documentNumber",value:D.documentNumber,onChange:Z,placeholder:"Ör: Fatura123",className:"mb-3"}),e.jsx(g,{htmlFor:"expenseMainCategoryId",children:"Masraf Ana Kategorisi"}),e.jsxs(B,{id:"expenseMainCategoryId",name:"expenseMainCategoryId",value:D.expenseMainCategoryId,onChange:Z,required:!0,className:"mb-3",disabled:l,children:[e.jsx("option",{value:"",children:"Seçiniz"}),R.length>0?R.map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Ana kategoriler yüklenemedi"})]}),e.jsx(g,{htmlFor:"expenseSubCategoryId",children:"Masraf Alt Kategorisi"}),e.jsxs(B,{id:"expenseSubCategoryId",name:"expenseSubCategoryId",value:D.expenseSubCategoryId,onChange:Z,required:!0,className:"mb-3",disabled:l||!D.expenseMainCategoryId,children:[e.jsx("option",{value:"",children:"Seçiniz"}),_.filter(a=>{var i;return((i=a.masrafAnaKategoriId)==null?void 0:i.toString())===D.expenseMainCategoryId}).map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id))]}),e.jsx(g,{htmlFor:"amount",children:"Tutar (KDV Dahil)"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(Q,{type:"number",id:"amount",name:"amount",value:D.amount,onChange:Z,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(B,{name:"currency",value:D.currency,onChange:Z,style:{width:"100px"},disabled:l,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(g,{htmlFor:"vatRate",children:"KDV Oranı (%)"}),e.jsx(Q,{type:"number",id:"vatRate",name:"vatRate",value:D.vatRate,onChange:Z,placeholder:"Ör: 20",step:"0.01",className:"mb-3"}),e.jsx(g,{htmlFor:"description",children:"Açıklama"}),e.jsx(ge,{name:"description",rows:3,value:D.description,onChange:Z,placeholder:"Ör: Seyahat masrafı",className:"mb-3"}),e.jsxs(oe,{children:[e.jsx(I,{color:"primary",type:"submit",disabled:l,children:"Masrafı Kaydet"}),e.jsx(I,{color:"secondary",onClick:()=>{u(a=>({...a,expense:!1})),W({date:t().format("YYYY-MM-DD"),documentNumber:"",expenseMainCategoryId:"",expenseSubCategoryId:"",amount:"",vatRate:"",currency:"TRY",description:""}),m(t())},children:"İptal"})]})]})]})]})]})},Ce="https://speedsofttest.com/api",ma="https://speedsofttest.com",ua="/default-profile.png",ha=n=>{if(!n||typeof n!="string"||n==="null")return ua;if(n.startsWith("https"))return`${n}?t=${new Date().getTime()}`;const u=n.startsWith("/")?n:`/${n}`;return`${ma}${u}?t=${new Date().getTime()}`},fa=()=>{const[n,u]=h.useState(!1),b=async()=>{u(!0)},N=Xe(),f=(m,l={})=>{N(m,{state:l})},Y=async()=>{console.log("silme baslası");const m=await deleteEmployee(v.id);y(m.message,m.success?"başarılı":"hata"),m.success&&N("/app/employees"),u(!1)},{employeeId:K}=Ze(),{state:R}=ea(),{selectedEmployee:v,fetchEmployeeById:_,employeeBalances:X,fetchEmployeeBalance:M,loading:P,error:j}=aa(),{users:H}=ra(),[c,U]=h.useState([]),[d,L]=h.useState({mainCategories:[],subCategories:[]}),[D,W]=h.useState(!1),[ye,w]=h.useState(null),[be,ae]=h.useState([]),[r,p]=h.useState({accrual:!1,payment:!1,advanceReturn:!1,debtCredit:!1,expense:!1}),y=(m,l="başarılı")=>{ae(T=>[...T,{id:Date.now(),message:m,type:l}])},k=h.useCallback(async m=>{var l,T,he,re,se;if(!m||isNaN(m)){w("Çalışan ID'si eksik veya geçersiz."),y("Çalışan bilgisi eksik","hata");return}W(!0);try{const E=await F.get(`${Ce}/calisancari/calisancaricalisan-get-by-Id/${m}`,{headers:{accept:"*/*"}});console.log("ÇalışanCari Get By ID: ",E);const $=E.data,Z=(Array.isArray($)?$:$?[$]:[]).map(V=>({id:V.id,tarih:V.tarih||"",masrafAnaKategoriId:V.masrafAnaKategoriId||0,masrafAltKategoriId:V.masrafAltKategoriId||0,aciklama:V.aciklama||"-",borc:V.borc||0,alacak:V.alacak||0,bakiye:V.bakiye||0,calisanId:V.calisanId||m,durumu:V.durumu||0}));U(Z),w(null),await M(m)}catch(E){const $=((T=(l=E.response)==null?void 0:l.data)==null?void 0:T.message)||E.message;console.error("Cari işlemler hatası:",{message:$,status:(he=E.response)==null?void 0:he.status,url:(re=E.config)==null?void 0:re.url}),((se=E.response)==null?void 0:se.status)===404?(w(`Çalışan ID ${m} için cari işlem bulunamadı.`),y(`Çalışan ID ${m} için cari işlem bulunamadı`,"hata")):(w("Cari işlemler alınamadı: "+$),y("Cari işlemler yüklenemedi: "+$,"hata")),U([])}finally{W(!1)}},[M]),J=async()=>{try{const m=await F.get(`${Ce}/masrafAnaKategori/masrafAnaKategori-get-all`,{headers:{accept:"*/*"}}),l=await F.get(`${Ce}/masrafAltKategori/masrafAltKategori-get-all`,{headers:{accept:"*/*"}}),T=Array.isArray(m.data)?m.data:[],he=Array.isArray(l.data)?l.data:[];L({mainCategories:T,subCategories:he})}catch(m){console.error("Masraf kategorileri alınamadı:",m),y("Masraf kategorileri yüklenemedi","hata")}};return h.useEffect(()=>{K&&K!=="new"&&!isNaN(K)?(_(Number(K)),k(Number(K)),J()):(w("Çalışan ID'si eksik veya geçersiz."),y("Çalışan bilgisi eksik veya geçersiz","hata"),N("/app/employees"))},[K,_,k,N]),P?e.jsx("div",{children:"Yükleniyor..."}):j||!v?e.jsxs(Ie,{children:[e.jsx(ve,{children:"Çalışan Bilgisi"}),e.jsxs(De,{children:[e.jsx("p",{children:j||"Çalışan bulunamadı."}),e.jsx(I,{color:"primary",onClick:()=>N("/app/employees"),children:"Geri Dön"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(sa,{toasts:be}),e.jsxs(na,{children:[e.jsx(ke,{xs:12,children:e.jsx(la,{employee:{...v,fotograf:ha(v.fotograf),balance:X[v.id]!==void 0?`${X[v.id].toLocaleString("tr-TR")} ${v.paraBirimi||"TRY"}`:"Veri bulunamadı"}})}),e.jsx(ke,{xs:12,className:"mb-3",children:e.jsx(oa,{onUpdate:()=>f("/app/employee-update",{employee:v,mode:"update"}),onDelete:b,onModalToggle:m=>p(l=>({...l,[m]:!0})),onExpense:()=>p(m=>({...m,expense:!0})),onStatement:()=>f(`/app/employee-statement/${K}`,{employee:v,expenseCategories:d}),onDocuments:()=>f("/app/employee-documents",{employeeId:v.id}),disableDocuments:!0})}),e.jsx(ke,{xs:12,children:e.jsx(ca,{transactions:c,loading:D,error:ye,currency:(v==null?void 0:v.paraBirimi)||"TRY",onPrint:(m,l)=>y(m,l),addToast:y,onRefresh:()=>k(v.id),expenseMainCategories:d.mainCategories||[],expenseSubCategories:d.subCategories||[]})})]}),e.jsxs(ne,{visible:n,onClose:()=>u(!1),backdrop:"static",children:[e.jsx(ie,{children:e.jsx(te,{children:"Silme Onayı"})}),e.jsx(le,{children:e.jsxs("p",{children:["Çalışan ",e.jsxs("strong",{children:['"',v==null?void 0:v.adiSoyadi,'"']})," silinecek. Emin misiniz?"]})}),e.jsxs(oe,{children:[e.jsx(I,{color:"secondary",onClick:()=>u(!1),children:"İptal"}),e.jsx(I,{color:"danger",onClick:Y,children:"Sil"})]})]}),e.jsx(da,{modalState:r,setModalState:p,employeeId:v.id,onSubmit:()=>k(v.id),addToast:y})]})};export{fa as default};
