import{r as i,u as A,A as E,j as e,C as $,q as d,m as j,M as H,g as f,h as y,s as S,e as P,f as U,n as W,N as Y,Q as L,S as V,T as _,W as q,t as M,a as O,b as Q,c as G}from"./index-DAwD_DDx.js";import{c as J}from"./cil-reload-6LI_qKMh.js";const v="https://speedsofttest.com/api",ee=()=>{const[m,p]=i.useState([]),[k,C]=i.useState(!1),[b,F]=i.useState(null),[K,h]=i.useState(!1),[n,x]=i.useState(null),N=A(),[z,B]=i.useState([]),T=i.useRef(),{user:t}=E(),g=async()=>{var a;C(!0);try{const s=await M.get(`${v}/kullanicilar/kullanicilar-get-all`);console.log("API Response:",s.data);const l=Array.isArray(s.data)?s.data:s.data.data||[];p(l),F(null)}catch(s){const l=s.response?`Durum: ${s.response.status}, Mesaj: ${((a=s.response.data)==null?void 0:a.message)||s.message}`:s.message;F("KullanÄ±cÄ±lar alÄ±namadÄ±: "+l),console.log("Error Details:",l),r("KullanÄ±cÄ±lar yÃ¼klenemedi","error"),p([])}finally{C(!1)}},I=async()=>{var a;if(!(n!=null&&n.id)){r("KullanÄ±cÄ± ID'si eksik","error"),h(!1),x(null);return}try{await M.delete(`${v}/kullanicilar/kullanicilar-delete/${n.id}`),r("KullanÄ±cÄ± baÅŸarÄ±yla silindi"),await g()}catch(s){const l=s.response&&((a=s.response.data)==null?void 0:a.message)||s.message;r(`KullanÄ±cÄ± silinirken hata oluÅŸtu: ${l}`,"error")}finally{h(!1),x(null)}},r=(a,s="success")=>{const l=Date.now(),c=e.jsxs(O,{autohide:!0,visible:!0,delay:5e3,className:s==="error"?"bg-danger text-white":"bg-success text-white",children:[e.jsx(Q,{closeButton:!0,children:e.jsx("strong",{className:"me-auto",children:s==="error"?"Hata":"BaÅŸarÄ±lÄ±"})}),e.jsx(G,{children:a})]},l);return B(u=>[...u,c]),l};i.useEffect(()=>{g(),console.log("Users Data:",m)},[]);const D=a=>{if((t==null?void 0:t.yetkiId)!==1&&(t==null?void 0:t.id)!==a.id){r("BaÅŸka kullanÄ±cÄ±yÄ± gÃ¶rÃ¼ntÃ¼leme/dÃ¼zenleme yetkiniz yok","error");return}if(!a.id){r("KullanÄ±cÄ± ID'si bulunamadÄ±","error"),console.error("Users - Invalid user ID:",a);return}N(`/app/user-detail/${a.id}`,{state:{user:a}})},R=()=>{if((t==null?void 0:t.yetkiId)!==1){r("Yeni kullanÄ±cÄ± ekleme yetkiniz yok","error");return}N("/app/user-detail/new",{state:{user:null}})};return e.jsxs(e.Fragment,{children:[e.jsx($,{ref:T,placement:"top-end",className:"p-3",children:z.map(a=>a)}),e.jsxs("div",{className:"d-flex gap-2 mb-3",children:[e.jsxs(d,{color:"success",className:"text-light",onClick:R,disabled:(t==null?void 0:t.yetkiId)!==1,children:[e.jsx(j,{icon:H,size:"m"})," Yeni KullanÄ±cÄ± Ekle"]}),e.jsxs(d,{color:"primary",className:"text-light",onClick:g,disabled:k,children:[e.jsx(j,{icon:J,size:"m"})," KullanÄ±cÄ±larÄ± Yenile"]})]}),k&&e.jsx(f,{className:"mb-3",children:e.jsx(y,{children:"YÃ¼kleniyor..."})}),b&&e.jsxs(f,{className:"mt-3",children:[e.jsx(S,{children:"Hata"}),e.jsxs(y,{children:[e.jsx("p",{children:b}),e.jsx(d,{color:"primary",onClick:g,children:"Tekrar Dene"})]})]}),e.jsxs(f,{className:"my-3",children:[e.jsx(S,{style:{backgroundColor:"#2965A8",color:"#FFFFFF",fontSize:"large",fontWeight:"bold"},size:"xl",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100",children:[e.jsx("span",{children:"KullanÄ±cÄ± KartlarÄ±"}),e.jsxs("div",{style:{backgroundColor:"#FFFFFF",color:"#2965A8",padding:"5px 10px",borderRadius:"4px",fontWeight:"bold",fontSize:"14px",minWidth:"40px",textAlign:"center"},children:["Toplam KullanÄ±cÄ±: ",m.length]})]})}),e.jsxs(y,{children:[e.jsx("p",{children:"Bir kullanÄ±cÄ±ya tÄ±klayarak detaylarÄ±nÄ± gÃ¶rÃ¼ntÃ¼leyebilir veya dÃ¼zenleyebilirsiniz."}),m.length>0?e.jsx(P,{children:m.filter(a=>{const s=Number(a==null?void 0:a.aktiflikDurumu)===1||Number(a==null?void 0:a.aktif)===1,l=!!(a!=null&&a.adiSoyadi)&&a.adiSoyadi.trim().length>0,c=!!(a!=null&&a.email)&&a.email.trim().length>0;return console.log("Filtreleme kontrolÃ¼:",{user:a,aktifMi:s,adiSoyadiVarMi:l,emailVarMi:c}),s&&l&&c}).map((a,s)=>{var w;const l=a.adiSoyadi.trim(),c=a.email.trim(),u=(w=a.fotograf)==null?void 0:w.trim();return console.log("ðŸ“Œ Filtre sonrasÄ± kart verisi:",a),e.jsx(U,{md:4,className:"mb-3",children:e.jsx(f,{className:"h-100 shadow-sm",style:{cursor:"pointer",transition:"background-color 0.2s, transform 0.2s"},onClick:()=>D(a),onMouseEnter:o=>{o.currentTarget.style.backgroundColor="#f8f9fa",o.currentTarget.style.transform="scale(1.02)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor="white",o.currentTarget.style.transform="scale(1)"},children:e.jsxs(y,{className:"d-flex align-items-center",children:[e.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",overflow:"hidden",marginRight:"15px",backgroundColor:"#e9ecef",display:"flex",alignItems:"center",justifyContent:"center"},children:u?e.jsx("img",{src:u,alt:"User Profile",style:{width:"100%",height:"100%",objectFit:"cover"},onError:o=>o.target.src=""}):e.jsx(j,{icon:W,size:"xl"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h6",{className:"mb-0",children:l}),e.jsx("p",{className:"mb-0 text-muted",children:c})]})]})})},a.id||s)})}):e.jsx("p",{children:"KullanÄ±cÄ± bulunamadÄ±."})]})]}),e.jsxs(Y,{visible:K,onClose:()=>{h(!1),x(null)},className:"shadow-sm",backdrop:"static",children:[e.jsx(L,{style:{backgroundColor:"#dc3545",color:"#FFFFFF",borderBottom:"2px solid #ffffff"},children:e.jsx(V,{children:"Silme OnayÄ±"})}),e.jsx(_,{children:e.jsxs("p",{children:['KullanÄ±cÄ± "',e.jsx("strong",{children:(n==null?void 0:n.adiSoyadi)||"Bilinmeyen KullanÄ±cÄ±"}),'" silinecek, emin misiniz? Bu iÅŸlem geri alÄ±namaz.']})}),e.jsxs(q,{children:[e.jsx(d,{color:"secondary",onClick:()=>{h(!1),x(null)},children:"Ä°ptal"}),e.jsx(d,{color:"danger",onClick:I,className:"text-white",children:"Sil"})]})]})]})};export{ee as default};
