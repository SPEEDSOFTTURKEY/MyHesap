import{r as h,j as l,N as A,Q as E,S as N,T as K,i as w,aq as z,q as v,W as O,ar as R,as as U,at as G,au as Y,t as q}from"./index-DAwD_DDx.js";const H="https://speedsofttest.com/api",_=({visible:B,onClose:C,onSubmit:M,customer:a,addToast:F})=>{const[i,j]=h.useState({id:(a==null?void 0:a.id)||0,unvani:(a==null?void 0:a.name)||"",fotograf:(a==null?void 0:a.fotograf)||null,vergiDairesi:(a==null?void 0:a.taxOffice)||"",vergiNumarasi:(a==null?void 0:a.taxOrIdNumber)||"",vergiMuaf:(a==null?void 0:a.isTaxExempt)||!1,iban:(a==null?void 0:a.bankInfo)||"",paraBirimi:(a==null?void 0:a.currency)||"TRY",riskLimiti:(a==null?void 0:a.riskLimit)||0,vade:(a==null?void 0:a.dueDate)||0,iskonto:(a==null?void 0:a.iskonto)||0,acilisBakiye:(a==null?void 0:a.openBalance)||0,yetkiliKisi:(a==null?void 0:a.contactPerson)||"",email:(a==null?void 0:a.email)||"",adres:(a==null?void 0:a.address)||"",telefon:(a==null?void 0:a.phone)||"",telefon2:(a==null?void 0:a.phone2)||"",diger:(a==null?void 0:a.otherContact)||"",musteriSiniflandirmaId:(a==null?void 0:a.musteriSiniflandirmaId)||0,kodu:(a==null?void 0:a.accountingCode)||"",aciklama:(a==null?void 0:a.note)||""}),[y,S]=h.useState("identity"),[s,b]=h.useState(!1),[p,f]=h.useState({}),o=n=>{const{name:d,value:t,type:g,checked:k}=n.target;j(e=>({...e,[d]:g==="checkbox"?k:t})),f(e=>({...e,[d]:""}))},D=n=>{const d=n.target.files[0];d&&j(t=>({...t,fotograf:d}))},I=()=>{var d,t;const n={};return(d=i.unvani)!=null&&d.trim()||(n.unvani="Müşteri unvanı zorunlu"),(t=i.email)!=null&&t.trim()||(n.email="E-posta zorunlu"),f(n),Object.keys(n).length===0},T=async n=>{var d,t,g,k;if(n.preventDefault(),!I()){F("Lütfen zorunlu alanları doldurun.","error");return}try{b(!0);const e={id:(a==null?void 0:a.id)||0,unvani:i.unvani,fotograf:i.fotograf,vergiDairesi:i.vergiDairesi||"",vergiNumarasi:i.vergiNumarasi||"",vergiMuaf:i.vergiMuaf?1:0,iban:i.iban||"",paraBirimi:i.paraBirimi||"TRY",riskLimiti:parseFloat(i.riskLimiti)||0,vade:parseInt(i.vade)||0,iskonto:parseFloat(i.iskonto)||0,acilisBakiye:parseFloat(i.acilisBakiye)||0,yetkiliKisi:i.yetkiliKisi||"",email:i.email||"",adres:i.adres||"",telefon:i.telefon||"",telefon2:i.telefon2||"",diger:i.diger||"",musteriSiniflandirmaId:parseInt(i.musteriSiniflandirmaId)||0,kodu:i.kodu||"",aciklama:i.aciklama||"",durumu:1,aktif:1},x=new FormData;for(const r in e)r==="fotograf"&&e[r]?x.append(r,e[r]):x.append(r,e[r]===null?"":e[r]);await q.put(`${H}/musteri/musteri-update`,x,{headers:{"Content-Type":"multipart/form-data"}}),M({id:a.id,...e})}catch(e){console.error("Müşteri Güncelleme Hatası:",{message:e.message,status:(d=e.response)==null?void 0:d.status,data:(t=e.response)==null?void 0:t.data}),F(((k=(g=e.response)==null?void 0:g.data)==null?void 0:k.message)||"Müşteri güncellenemedi. Lütfen veri formatını kontrol edin.","error")}finally{b(!1)}},L=()=>{switch(y){case"identity":return l.jsx(Y,{formData:i,handleChange:o,handleImageUpload:D,errors:p,setErrors:f});case"financial":return l.jsx(G,{formData:i,handleChange:o,errors:p,setErrors:f});case"contact":return l.jsx(U,{formData:i,handleChange:o,errors:p});case"other":return l.jsx(R,{formData:i,handleChange:o,errors:p,setErrors:f});default:return null}};return l.jsxs(A,{visible:B,onClose:C,backdrop:"static",size:"lg",children:[l.jsx(E,{style:{backgroundColor:"#2965A8",color:"#fff"},children:l.jsx(N,{children:"Müşteri Bilgilerini Güncelle"})}),l.jsxs(K,{children:[s&&l.jsx("p",{children:"Yükleniyor..."}),l.jsxs(w,{id:"customerUpdateForm",onSubmit:T,children:[l.jsx(z,{role:"group",className:"mb-3",children:["identity","financial","contact","other"].map(n=>l.jsx(v,{style:{backgroundColor:y===n?"#FFFFFF":"#2965A8",color:y===n?"#2965A8":"#FFFFFF",border:"1px solid #2965A8"},onClick:()=>S(n),disabled:s,children:n==="identity"?"Kimlik Bilgileri":n==="financial"?"Cari":n==="contact"?"İletişim":"Diğer"},n))}),L()]})]}),l.jsxs(O,{children:[l.jsx(v,{type:"submit",form:"customerUpdateForm",color:"primary",disabled:s,children:"Kaydet"}),l.jsx(v,{color:"secondary",onClick:C,disabled:s,children:"İptal"})]})]})};export{_ as C};
