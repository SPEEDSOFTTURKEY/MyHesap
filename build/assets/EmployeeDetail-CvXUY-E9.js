import{j as e,g as Ae,s as Se,h as Ye,m as U,n as Oe,f as Ie,q as D,X as Pe,a6 as Fe,B as Ue,D as He,E as Le,F as Ce,ad as Ge,ae as Ve,r as p,Z as l,C as qe,a as _e,b as We,c as Je,$ as Qe,a0 as Xe,a1 as Re,a2 as me,a3 as Ze,a4 as he,N as re,Q as se,S as ie,T as te,i as ge,af as ye,U as y,V as R,ag as be,o as J,W as le,t as K,u as ea,ah as aa,J as na,ac as ra,K as sa,ai as ia,e as ta}from"./index-DvA_wB1j.js";import{c as la}from"./cil-money-Dk3vHnQB.js";import{c as ca}from"./cil-transfer-BeKoe_Wl.js";import{c as we}from"./cil-file-CeQgYs_D.js";import{c as Te}from"./cil-warning-C7g3f07Q.js";const oa=({employee:r})=>e.jsxs(Ae,{className:"mb-3 shadow-sm w-50",children:[e.jsx(Se,{className:"p-3",style:{backgroundColor:"#2965A8",color:"#FFFFFF"},children:e.jsx("h4",{children:e.jsx("strong",{children:(r==null?void 0:r.adiSoyadi)||"Çalışan Bilgisi"})})}),e.jsxs(Ye,{className:"d-flex",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-center me-4",style:{width:"70px",height:"70px",borderRadius:"50%",overflow:"hidden",backgroundColor:"#e9ecef"},children:[r!=null&&r.fotograf?e.jsx("img",{src:r.fotograf,alt:"Çalışan Fotoğrafı",style:{width:"100%",height:"100%",objectFit:"cover"},onError:u=>{u.target.style.display="none",u.target.nextSibling.style.display="block"}}):null,e.jsx(U,{icon:Oe,size:"xl",style:{display:r!=null&&r.fotograf?"none":"block"}})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Telefon:"})," ",(r==null?void 0:r.telefon)||"Bilinmiyor"]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"E-posta:"})," ",(r==null?void 0:r.email)||"Bilinmiyor"]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Bakiye:"})," ",(r==null?void 0:r.balance)||"Veri bulunamadı"]})]})]})]}),da=({onUpdate:r,onDelete:u,onModalToggle:x,onExpense:S,onStatement:b,onDocuments:c,disableDocuments:Q})=>{const M={cursor:"pointer",padding:"8px 16px",fontSize:"14px","--cui-dropdown-link-hover-color":"#ffffff","--cui-dropdown-link-hover-bg":"#34A149","--cui-dropdown-link-active-color":"#ffffff","--cui-dropdown-link-active-bg":"#34A149"};return e.jsxs(Ie,{className:"d-flex gap-2 flex-wrap",children:[e.jsxs(D,{className:"mx-1 text-white",color:"info",size:"sm",onClick:r,children:[e.jsx(U,{icon:Pe})," Güncelle"]}),e.jsxs(D,{className:"mx-1 text-white",color:"danger",size:"sm",onClick:u,children:[e.jsx(U,{icon:Fe})," Sil"]}),e.jsxs(Ue,{children:[e.jsxs(He,{className:"mx-1 text-white",color:"success",size:"sm",children:[e.jsx("span",{style:{fontSize:"medium"},children:"₺"})," Ödeme İşlemleri"]}),e.jsxs(Le,{children:[e.jsx(Ce,{style:M,onClick:()=>x("accrual"),children:"Maaş/Prim Tahakkuku Yap"}),e.jsxs(Ce,{style:M,onClick:()=>x("payment"),children:[e.jsx(U,{icon:la})," Ödeme Yap (Maaş/Prim/Avans)"]}),e.jsxs(Ce,{style:M,onClick:()=>x("advanceReturn"),children:[e.jsx(U,{icon:Ge})," Avans İadesi Al"]}),e.jsxs(Ce,{style:M,onClick:()=>x("debtCredit"),children:[e.jsx(U,{icon:ca})," Borç-Alacak Fişleri"]})]})]}),e.jsxs(D,{className:"mx-1 text-white",color:"danger",size:"sm",onClick:S,children:[e.jsx(U,{icon:Ve})," Masraf Kaydet"]}),e.jsxs(D,{className:"mx-1 text-white",color:"warning",size:"sm",onClick:b,children:[e.jsx(U,{icon:we})," Hesap Ekstresi"]}),e.jsxs(D,{className:"mx-1 text-white",color:"secondary",size:"sm",onClick:c,disabled:Q,children:[e.jsx(U,{icon:we})," Dökümanlar"]})]})},Ke="https://speedsofttest.com/api",Be=()=>{try{return(JSON.parse(localStorage.getItem("user"))||{id:0}).id}catch(r){return console.error("Kullanıcı ID'si alınırken hata:",r),0}},ua=({transactions:r,loading:u,error:x,currency:S="TRY",onPrint:b,addToast:c,onRefresh:Q,expenseMainCategories:M,expenseSubCategories:ce})=>{const[q,oe]=p.useState(!1),[A,H]=p.useState(!1),[k,F]=p.useState(null),[d,_]=p.useState({id:0,tarih:l(),masrafAnaKategoriId:"",masrafAltKategoriId:"",calisanId:0,durumu:"1",aciklama:"",borc:"",alacak:"",bakiye:""}),[m,z]=p.useState(!1),C=t=>{F(t),H(!0)},$=async()=>{var h,N;if(!(k!=null&&k.id)){c("Cari işlem ID'si eksik","hata");return}const t=Be();if(!t){c("Geçerli bir kullanıcı oturumu bulunamadı.","hata");return}z(!0);try{await K.delete(`${Ke}/calisancari/calisancari-delete/${k.id}?kullaniciId=${t}`,{headers:{accept:"*/*"}}),c("Cari işlem başarıyla silindi","başarılı"),Q()}catch(Y){console.error("Cari işlem silinirken hata:",Y),c("Cari işlem silinemedi: "+(((N=(h=Y.response)==null?void 0:h.data)==null?void 0:N.message)||Y.message),"hata")}finally{z(!1),H(!1),F(null)}},L=t=>{const{name:h,value:N}=t.target;_(Y=>({...Y,[h]:N,...h==="masrafAnaKategoriId"?{masrafAltKategoriId:""}:{}}))},Z=async t=>{var N,Y;t.preventDefault();const h=Be();if(!h){c("Geçerli bir kullanıcı oturumu bulunamadı.","hata");return}z(!0);try{const w={id:d.id,tarih:d.tarih.format("YYYY-MM-DD"),eklenmeTarihi:k.eklenmeTarihi||l().toISOString(),guncellenmeTarihi:l().toISOString(),masrafAnaKategoriId:parseInt(d.masrafAnaKategoriId)||0,masrafAltKategoriId:parseInt(d.masrafAltKategoriId)||0,calisanId:parseInt(d.calisanId),durumu:parseInt(d.durumu),aciklama:d.aciklama,borc:parseFloat(d.borc)||0,alacak:parseFloat(d.alacak)||0,bakiye:parseFloat(d.bakiye)||0,kullaniciId:h,guncelleyenKullaniciId:h};await K.put(`${Ke}/calisancari/calisancari-update`,w,{headers:{"Content-Type":"application/json",accept:"*/*"}}),c("Cari işlem başarıyla güncellendi","başarılı"),oe(!1),Q()}catch(w){console.error("Cari işlem güncellenirken hata:",w),c("Cari işlem güncellenemedi: "+(((Y=(N=w.response)==null?void 0:N.data)==null?void 0:Y.message)||w.message),"hata")}finally{z(!1)}},fe=t=>{if(!t.masrafAnaKategoriId&&!t.masrafAltKategoriId)return"-";const h=M.find(w=>w.id===t.masrafAnaKategoriId),N=ce.find(w=>w.id===t.masrafAltKategoriId);let Y="";return h&&(Y+=h.adi),N&&(Y+=Y?` - ${N.adi}`:N.adi),Y||"-"};return e.jsxs(e.Fragment,{children:[e.jsx(qe,{placement:"top-end",className:"p-3",children:x&&e.jsxs(_e,{autohide:5e3,visible:!!x,color:"danger",children:[e.jsx(We,{closeButton:{label:"Kapat"},children:e.jsx("strong",{className:"me-auto",children:"Hata"})}),e.jsx(Je,{children:x})]})}),e.jsxs(Ae,{className:"mb-3",children:[e.jsx(Se,{className:"p-3",style:{backgroundColor:"#2965A8",color:"#ffffff"},children:e.jsx("h5",{children:"Önceki Cari İşlemler"})}),e.jsxs(Ye,{children:[u&&e.jsx("p",{children:"Yükleniyor..."}),!u&&!x&&r.length>0?e.jsxs(Qe,{responsive:!0,children:[e.jsx(Xe,{children:e.jsxs(Re,{children:[e.jsx(me,{children:"Tarih"}),e.jsx(me,{children:"Masraf Kalemi"}),e.jsx(me,{children:"Açıklama"}),e.jsx(me,{children:"Borç"}),e.jsx(me,{children:"Alacak"}),e.jsx(me,{children:"Bakiye"}),e.jsx(me,{children:"İşlemler"})]})}),e.jsx(Ze,{className:"my-2",children:r.map(t=>e.jsxs(Re,{children:[e.jsx(he,{children:t.tarih?l(t.tarih).format("DD.MM.YYYY"):"-"}),e.jsx(he,{children:fe(t)}),e.jsx(he,{children:t.aciklama||"-"}),e.jsx(he,{children:t.borc?`${t.borc.toLocaleString("tr-TR")} ${S}`:"-"}),e.jsx(he,{children:t.alacak?`${t.alacak.toLocaleString("tr-TR")} ${S}`:"-"}),e.jsx(he,{children:t.bakiye?`${t.bakiye.toLocaleString("tr-TR")} ${S}`:"-"}),e.jsx(he,{children:e.jsx(D,{color:"danger",size:"sm",style:{color:"white"},onClick:()=>C(t),disabled:m,children:e.jsx(U,{icon:Fe})})})]},t.id))})]}):!u&&!x&&e.jsx("p",{children:"Henüz işlem bulunmamaktadır."})]})]}),e.jsxs(re,{visible:q,onClose:()=>oe(!1),backdrop:"static",keyboard:!1,children:[e.jsx(se,{style:{backgroundColor:"#2965A2",color:"white"},children:e.jsx(ie,{children:"Cari İşlem Düzenle"})}),e.jsx(te,{children:e.jsxs(ge,{onSubmit:Z,children:[e.jsx(ye,{label:"Tarih",value:d.tarih,onChange:t=>_(h=>({...h,tarih:t}))}),e.jsx(y,{htmlFor:"masrafAnaKategoriId",className:"mt-3",children:"Masraf Ana Kategorisi"}),e.jsxs(R,{id:"masrafAnaKategoriId",name:"masrafAnaKategoriId",value:d.masrafAnaKategoriId,onChange:L,className:"mb-3",disabled:m,children:[e.jsx("option",{value:"",children:"Seçiniz"}),M.map(t=>e.jsx("option",{value:t.id,children:t.adi},t.id))]}),e.jsx(y,{htmlFor:"masrafAltKategoriId",className:"mt-3",children:"Masraf Alt Kategorisi"}),e.jsxs(R,{id:"masrafAltKategoriId",name:"masrafAltKategoriId",value:d.masrafAltKategoriId,onChange:L,className:"mb-3",disabled:m||!d.masrafAnaKategoriId,children:[e.jsx("option",{value:"",children:"Seçiniz"}),ce.filter(t=>{var h;return((h=t.masrafAnaKategoriId)==null?void 0:h.toString())===d.masrafAnaKategoriId}).map(t=>e.jsx("option",{value:t.id,children:t.adi},t.id))]}),e.jsx(y,{htmlFor:"durumu",className:"mt-3",children:"Durum"}),e.jsxs(R,{id:"durumu",name:"durumu",value:d.durumu,onChange:L,className:"mb-3",disabled:m,children:[e.jsx("option",{value:"1",children:"Aktif"}),e.jsx("option",{value:"0",children:"Pasif"})]}),e.jsx(y,{htmlFor:"aciklama",className:"mt-3",children:"Açıklama"}),e.jsx(be,{id:"aciklama",name:"aciklama",rows:3,value:d.aciklama,onChange:L,className:"mb-3",disabled:m}),e.jsx(y,{htmlFor:"borc",className:"mt-3",children:"Borç"}),e.jsx(J,{type:"number",id:"borc",name:"borc",value:d.borc,onChange:L,placeholder:"0.00",step:"0.01",className:"mb-3",disabled:m}),e.jsx(y,{htmlFor:"alacak",className:"mt-3",children:"Alacak"}),e.jsx(J,{type:"number",id:"alacak",name:"alacak",value:d.alacak,onChange:L,placeholder:"0.00",step:"0.01",className:"mb-3",disabled:m}),e.jsx(y,{htmlFor:"bakiye",className:"mt-3",children:"Bakiye"}),e.jsx(J,{type:"number",id:"bakiye",name:"bakiye",value:d.bakiye,onChange:L,placeholder:"0.00",step:"0.01",className:"mb-3",disabled:m}),e.jsxs(le,{children:[e.jsx(D,{color:"primary",type:"submit",disabled:m,children:"Kaydet"}),e.jsx(D,{color:"secondary",onClick:()=>oe(!1),disabled:m,children:"İptal"})]})]})})]}),e.jsxs(re,{visible:A,onClose:()=>{H(!1),F(null)},backdrop:"static",children:[e.jsx(se,{style:{backgroundColor:"#DC3545",color:"white"},children:e.jsx(ie,{children:"Silme Onayı"})}),e.jsx(te,{children:e.jsx("p",{children:"Bu cari işlemi silmek istediğinize emin misiniz? Bu işlem geri alınamaz."})}),e.jsxs(le,{children:[e.jsx(D,{color:"secondary",style:{color:"white"},onClick:()=>{H(!1),F(null)},disabled:m,children:"Hayır"}),e.jsx(D,{color:"danger",style:{color:"white"},onClick:$,disabled:m,children:"Evet"})]})]})]})},V="https://speedsofttest.com/api",ke=()=>{try{return(JSON.parse(localStorage.getItem("user"))||{id:0}).id}catch(r){return console.error("Kullanıcı ID'si alınırken hata:",r),0}},ma=({modalState:r,setModalState:u,employeeId:x,onSubmit:S,addToast:b})=>{var Me,Ne;const[c,Q]=p.useState([]),[M,ce]=p.useState([]),[q,oe]=p.useState([]),[A,H]=p.useState({date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",expenseMainCategoryId:"",expenseSubCategoryId:"",description:""}),[k,F]=p.useState({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),[d,_]=p.useState({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),[m,z]=p.useState({transactionType:"Alacak",date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",description:"",expenseMainCategoryId:"",expenseSubCategoryId:""}),[C,$]=p.useState({date:l().format("YYYY-MM-DD"),documentNumber:"",expenseMainCategoryId:"",expenseSubCategoryId:"",amount:"",vatRate:"",currency:"TRY",description:""}),[L,Z]=p.useState(l()),[fe,t]=p.useState(l()),[h,N]=p.useState(l()),[Y,w]=p.useState(l()),[pe,xe]=p.useState(l()),[i,f]=p.useState(!1),ee=async()=>{var a,n,g;if(!(i||c.length>0&&M.length>0&&q.length>0))try{if(f(!0),!c.length){const o=await K.get(`${V}/Hesap/hesap-get-all`,{headers:{accept:"*/*"}}),I=Array.isArray(o.data)?o.data.map(j=>({id:j.id,userName:j.tanim,currency:j.paraBirimi,balance:j.guncelBakiye,accountNumber:j.hesapNo,labelColor:j.etiketRengi,spendingLimit:j.harcamaLimiti,type:j.hesapKategoriId})):[];Q(I)}if(!M.length){const o=await K.get(`${V}/masrafAnaKategori/masrafAnaKategori-get-all`,{headers:{accept:"*/*"}}),I=Array.isArray(o.data)?o.data:[];ce(I)}if(!q.length){const o=await K.get(`${V}/masrafAltKategori/masrafAltKategori-get-all`,{headers:{accept:"*/*"}}),I=Array.isArray(o.data)?o.data:[];oe(I)}}catch(o){console.error("Veri çekme hatası:",o,(a=o.response)==null?void 0:a.data),b("Hesaplar veya masraf kategorileri yüklenemedi: "+(((g=(n=o.response)==null?void 0:n.data)==null?void 0:g.message)||o.message),"hata")}finally{f(!1)}};p.useEffect(()=>{(r.payment||r.advanceReturn||r.accrual||r.debtCredit||r.expense)&&ee()},[r.payment,r.advanceReturn,r.accrual,r.debtCredit,r.expense]);const W=async()=>{try{const a=await K.get(`${V}/calisancari/calisancaricalisan-get-by-Id/${x}`);return(Array.isArray(a.data)?a.data:[]).reduce((o,I)=>{const j=I.borc||0,T=I.alacak||0;return o+(T-j)},0)}catch(a){throw console.error("Bakiye alınamadı:",a),b("Bakiye kontrolü başarısız.","hata"),a}},ae=a=>{const{name:n,value:g}=a.target;H(o=>({...o,[n]:g,...n==="expenseMainCategoryId"?{expenseSubCategoryId:""}:{}}))},de=a=>{const{name:n,value:g}=a.target;F(o=>({...o,[n]:g}))},E=a=>{const{name:n,value:g}=a.target;_(o=>({...o,[n]:g}))},B=a=>{const{name:n,value:g}=a.target;z(o=>({...o,[n]:g,...n==="expenseMainCategoryId"?{expenseSubCategoryId:""}:{}}))},ne=a=>{const{name:n,value:g}=a.target;$(o=>({...o,[n]:g,...n==="expenseMainCategoryId"?{expenseSubCategoryId:""}:{}}))},ve=async a=>{var g,o,I,j,T;a.preventDefault();const n=ke();if(!n){b("Geçerli bir kullanıcı oturumu bulunamadı.","hata");return}if(!A.amount||!A.expenseMainCategoryId||!A.expenseSubCategoryId){b("Tutar ve masraf kategorileri zorunlu.","hata");return}try{f(!0);const s=parseFloat(A.amount),O=await W()+s,X={id:0,tarih:new Date(A.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:parseInt(A.expenseMainCategoryId),masrafAltKategoriId:parseInt(A.expenseSubCategoryId),calisanId:parseInt(x),durumu:0,aciklama:A.description||"Maaş/Prim tahakkuku",borc:0,alacak:s,bakiye:O,kullaniciId:n,ekleyenKullaniciId:n,guncelleyenKullaniciId:n};await K.post(`${V}/calisancari/calisancari-create`,X),b("Maaş tahakkuku kaydedildi","başarılı"),u(G=>({...G,accrual:!1})),H({date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",expenseMainCategoryId:"",expenseSubCategoryId:"",description:""}),Z(l()),S(x)}catch(s){const v=((o=(g=s.response)==null?void 0:g.data)==null?void 0:o.message)||s.message;console.error("Tahakkuk hatası:",{message:v,status:(I=s.response)==null?void 0:I.status,url:(j=s.config)==null?void 0:j.url,data:(T=s.config)==null?void 0:T.data}),b("Maaş tahakkuku kaydedilemedi: "+v,"hata")}finally{f(!1)}},P=async a=>{var g,o,I,j,T;a.preventDefault();const n=ke();if(!n){b("Geçerli bir kullanıcı oturumu bulunamadı.","hata");return}if(!k.accountId||!k.amount){b("Hesap ve tutar zorunlu.","hata");return}try{f(!0);const s=parseFloat(k.amount),O=await W()-s,X={id:0,tarih:new Date(k.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:0,masrafAltKategoriId:0,calisanId:parseInt(x),durumu:0,aciklama:k.description||"Maaş/Prim/Avans ödemesi",borc:s,alacak:0,bakiye:O,kullaniciId:n,ekleyenKullaniciId:n,guncelleyenKullaniciId:n};await K.post(`${V}/calisancari/calisancari-create`,X);const G=c.find(ue=>ue.id===parseInt(k.accountId)),je={id:0,kullanicilarId:n,hesapId:parseInt(k.accountId),etkilenenHesapId:0,hesapKategoriId:G.type,islemTarihi:new Date(k.date).toISOString(),islemTuruId:2,bilgi:k.description||"Maaş/Prim/Avans ödemesi",aciklama:"Maaş/Prim/Avans ödemesi",borc:s,alacak:0,tutar:s,bakiye:G.balance-s,eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),kullaniciId:n,ekleyenKullaniciId:n,guncelleyenKullaniciId:n};await K.post(`${V}/hesapHareket/hesapHareket-create`,je),b("Ödeme kaydedildi","başarılı"),u(ue=>({...ue,payment:!1})),F({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),t(l()),S(x)}catch(s){const v=(g=s.response)==null?void 0:g.status,O=((I=(o=s.response)==null?void 0:o.data)==null?void 0:I.message)||s.message;console.error("Ödeme hatası:",{message:O,status:v,url:(j=s.config)==null?void 0:j.url,data:(T=s.config)==null?void 0:T.data}),b(`Ödeme kaydedilemedi: ${v?`Durum ${v}, `:""}${O}`,"hata")}finally{f(!1)}},ze=async a=>{var g,o,I,j,T;a.preventDefault();const n=ke();if(!n){b("Geçerli bir kullanıcı oturumu bulunamadı.","hata");return}if(!d.accountId||!d.amount){b("Hesap ve tutar zorunlu.","hata");return}try{f(!0);const s=parseFloat(d.amount),O=await W()+s,X={id:0,tarih:new Date(d.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:0,masrafAltKategoriId:0,calisanId:parseInt(x),durumu:0,aciklama:d.description||"Avans iadesi",borc:0,alacak:s,bakiye:O,kullaniciId:n,ekleyenKullaniciId:n,guncelleyenKullaniciId:n};await K.post(`${V}/calisancari/calisancari-create`,X);const G=c.find(ue=>ue.id===parseInt(d.accountId)),je={id:0,kullanicilarId:n,hesapId:parseInt(d.accountId),etkilenenHesapId:0,hesapKategoriId:G.type,islemTarihi:new Date(d.date).toISOString(),islemTuruId:1,bilgi:d.description||"Avans iadesi",aciklama:"Avans iadesi",borc:0,alacak:s,tutar:s,bakiye:G.balance+s,eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),kullaniciId:n,ekleyenKullaniciId:n,guncelleyenKullaniciId:n};await K.post(`${V}/hesapHareket/hesapHareket-create`,je),b("Avans iadesi kaydedildi","başarılı"),u(ue=>({...ue,advanceReturn:!1})),_({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),N(l()),S(x)}catch(s){const v=((o=(g=s.response)==null?void 0:g.data)==null?void 0:o.message)||s.message;console.error("Avans iadesi hatası:",{message:v,status:(I=s.response)==null?void 0:I.status,url:(j=s.config)==null?void 0:j.url,data:(T=s.config)==null?void 0:T.data}),b("Avans iadesi kaydedilemedi: "+v,"hata")}finally{f(!1)}},$e=async a=>{var g,o,I,j,T;a.preventDefault();const n=ke();if(!n){b("Geçerli bir kullanıcı oturumu bulunamadı.","hata");return}if(!m.amount){b("Tutar zorunlu.","hata");return}try{f(!0);const s=parseFloat(m.amount),v=m.transactionType==="Borç",O=await W(),X=v?O-s:O+s,G={id:0,tarih:new Date(m.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:parseInt(m.expenseMainCategoryId)||0,masrafAltKategoriId:parseInt(m.expenseSubCategoryId)||0,calisanId:parseInt(x),durumu:0,aciklama:m.description||"Borç/Alacak fişi",borc:v?s:0,alacak:v?0:s,bakiye:X,kullaniciId:n,ekleyenKullaniciId:n,guncelleyenKullaniciId:n};await K.post(`${V}/calisancari/calisancari-create`,G),b("Borç/Alacak fişi kaydedildi","başarılı"),u(je=>({...je,debtCredit:!1})),z({transactionType:"Alacak",date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",description:"",expenseMainCategoryId:"",expenseSubCategoryId:""}),w(l()),S(x)}catch(s){const v=((o=(g=s.response)==null?void 0:g.data)==null?void 0:o.message)||s.message;console.error("Borç/Alacak hatası:",{message:v,status:(I=s.response)==null?void 0:I.status,url:(j=s.config)==null?void 0:j.url,data:(T=s.config)==null?void 0:T.data}),b("Borç/Alacak fişi kaydedilemedi: "+v,"hata")}finally{f(!1)}},Ee=async a=>{var g,o,I,j,T;a.preventDefault();const n=ke();if(!n){b("Geçerli bir kullanıcı oturumu bulunamadı.","hata");return}if(!C.amount||!C.expenseMainCategoryId||!C.expenseSubCategoryId){b("Tutar ve masraf kategorileri zorunlu.","hata");return}try{f(!0);const s=parseFloat(C.amount),O=await W()+s,X={id:0,tarih:new Date(C.date).toISOString(),eklenmeTarihi:new Date().toISOString(),guncellenmeTarihi:new Date().toISOString(),masrafAnaKategoriId:parseInt(C.expenseMainCategoryId),masrafAltKategoriId:parseInt(C.expenseSubCategoryId),calisanId:parseInt(x),durumu:0,aciklama:C.description||`Masraf kaydı: ${C.documentNumber}`,borc:0,alacak:s,bakiye:O,fisBelgeNo:C.documentNumber||"",kdvOrani:parseFloat(C.vatRate)||0,kullaniciId:n,ekleyenKullaniciId:n,guncelleyenKullaniciId:n};await K.post(`${V}/calisancari/calisancari-create`,X),b("Masraf kaydı kaydedildi","başarılı"),u(G=>({...G,expense:!1})),$({date:l().format("YYYY-MM-DD"),documentNumber:"",expenseMainCategoryId:"",expenseSubCategoryId:"",amount:"",vatRate:"",currency:"TRY",description:""}),xe(l()),S(x)}catch(s){const v=((o=(g=s.response)==null?void 0:g.data)==null?void 0:o.message)||s.message;console.error("Masraf hatası:",{message:v,status:(I=s.response)==null?void 0:I.status,url:(j=s.config)==null?void 0:j.url,data:(T=s.config)==null?void 0:T.data}),b("Masraf kaydı kaydedilemedi: "+v,"hata")}finally{f(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(re,{visible:r.accrual,backdrop:"static",keyboard:!1,onClose:()=>{u(a=>({...a,accrual:!1})),H({date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",expenseMainCategoryId:"",expenseSubCategoryId:"",description:""}),Z(l())},children:[e.jsx(se,{children:e.jsx(ie,{children:"Maaş/Prim Tahakkuku Yap"})}),e.jsxs(te,{children:[i&&e.jsx("p",{children:"Veriler yükleniyor..."}),e.jsxs(ge,{onSubmit:ve,children:[e.jsx("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:e.jsx("p",{className:"mb-0",children:"'Hakedilen Net Maaş' alanına çalışanın hak ettiği net maaş/prim tutarını yazın. Kaydettiğinizde hem çalışan için alacak kaydı, hem de seçtiğiniz masraf kalemi için gider yazılacaktır. 'Açıklama' alanına 'Şubat maaşı' vb. yazabilirsiniz."})}),e.jsxs("p",{style:{fontWeight:"bold",color:"#dc3545",display:"flex",alignItems:"center",marginBottom:"20px"},children:[e.jsx(U,{icon:Te,style:{marginRight:"5px"}}),"Bu işlem kasa ya da banka hesabınızı etkilemez, sadece çalışanı alacaklandırır. Bu işlemden sonra, ödeme yapmak için 'Ödeme Yap' seçeneğini kullanın."]}),e.jsx(ye,{label:"Hakediş Tarihi",value:L,onChange:a=>{Z(a),H(n=>({...n,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(y,{htmlFor:"amount",children:"Hakedilen Net Maaş"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(J,{type:"number",id:"amount",name:"amount",value:A.amount,onChange:ae,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(R,{name:"currency",value:A.currency,onChange:ae,style:{width:"100px"},disabled:i,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(y,{htmlFor:"expenseMainCategoryId",className:"mt-3",children:"Masraf Ana Kategorisi"}),e.jsxs(R,{id:"expenseMainCategoryId",name:"expenseMainCategoryId",value:A.expenseMainCategoryId,onChange:ae,required:!0,className:"mb-3",disabled:i,children:[e.jsx("option",{value:"",children:"Seçiniz"}),M.length>0?M.map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Ana kategoriler yüklenemedi"})]}),e.jsx(y,{htmlFor:"expenseSubCategoryId",className:"mt-3",children:"Masraf Alt Kategorisi"}),e.jsxs(R,{id:"expenseSubCategoryId",name:"expenseSubCategoryId",value:A.expenseSubCategoryId,onChange:ae,required:!0,className:"mb-3",disabled:i||!A.expenseMainCategoryId,children:[e.jsx("option",{value:"",children:"Seçiniz"}),q.filter(a=>{var n;return((n=a.masrafAnaKategoriId)==null?void 0:n.toString())===A.expenseMainCategoryId}).map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id))]}),e.jsx(y,{htmlFor:"description",children:"Açıklama"}),e.jsx(be,{name:"description",rows:3,value:A.description,onChange:ae,placeholder:"Ör: Şubat maaşı",className:"mb-3"}),e.jsxs(le,{children:[e.jsx(D,{color:"primary",type:"submit",disabled:i,children:"Maaş Tahakkuku Oluştur"}),e.jsx(D,{color:"secondary",onClick:()=>{u(a=>({...a,accrual:!1})),H({date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",expenseMainCategoryId:"",expenseSubCategoryId:"",description:""}),Z(l())},children:"İptal"})]})]})]})]}),e.jsxs(re,{visible:r.payment,backdrop:"static",keyboard:!0,onClose:()=>{u(a=>({...a,payment:!1})),F({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),t(l())},children:[e.jsx(se,{children:e.jsx(ie,{children:"Ödeme Yap (Maaş/Prim/Avans)"})}),e.jsxs(te,{children:[i&&e.jsx("p",{children:"Hesaplar yükleniyor..."}),e.jsxs(ge,{onSubmit:P,children:[e.jsx("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:e.jsx("p",{className:"mb-0",children:"Ödemeyi kaydetiğinizde sistem seçtiğiniz kasa/banka hesabından 'Ödediğiniz Net Tutar' kadar miktarı çalışana borç yazdıracaktır."})}),e.jsxs("p",{style:{fontWeight:"bold",color:"#dc3545",display:"flex",alignItems:"center",marginBottom:"20px"},children:[e.jsx(U,{icon:Te,style:{marginRight:"5px"}}),"Maaş ya da prim ödemesi yapmadan önce 'Maaş/Prim Tahakkuku Yap' seçeneği ile çalışanıınızı alacaklandırmayı ve şirketiniz için masraf oluşturmayı unutmayın."]}),e.jsx(ye,{label:"Ödeme Tarihi",value:fe,onChange:a=>{t(a),F(n=>({...n,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(y,{htmlFor:"accountId",children:"Hesap Seç"}),e.jsxs(R,{id:"accountId",name:"accountId",value:k.accountId,onChange:de,required:!0,className:"mb-3",disabled:i,children:[e.jsx("option",{value:"",children:"Seçiniz"}),c.length>0?c.map(a=>e.jsxs("option",{value:a.id,children:[a.userName," (",a.currency,")"]},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Hesap bulunamadı"})]}),e.jsxs("p",{className:"mt-2 mb-3",children:[e.jsx("strong",{children:"Güncel bakiye: "}),k.accountId?`${(((Me=c.find(a=>a.id===parseInt(k.accountId)))==null?void 0:Me.balance)||0).toLocaleString("tr-TR")} ${((Ne=c.find(a=>a.id===parseInt(k.accountId)))==null?void 0:Ne.currency)||"TRY"}`:"0.00 TRY"]}),e.jsx(y,{htmlFor:"paymentAmount",children:"Ödediğiniz Net Tutar"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(J,{type:"number",id:"paymentAmount",name:"amount",value:k.amount,onChange:de,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(R,{name:"currency",value:k.currency,onChange:de,style:{width:"100px"},disabled:i,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(y,{htmlFor:"paymentDescription",children:"Açıklama"}),e.jsx(be,{name:"description",rows:3,value:k.description,onChange:de,placeholder:"Ör: Maaş ödemesi",className:"mb-3"}),e.jsxs(le,{children:[e.jsx(D,{color:"primary",type:"submit",disabled:i,children:"Ödemeyi Kaydet"}),e.jsx(D,{color:"secondary",onClick:()=>{u(a=>({...a,payment:!1})),F({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),t(l())},children:"İptal"})]})]})]})]}),e.jsxs(re,{visible:r.advanceReturn,backdrop:"true",keyboard:!0,onClose:()=>{u(a=>({...a,advanceReturn:!1})),_({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),N(l())},children:[e.jsx(se,{children:e.jsx(ie,{children:"Avans İadesi Al"})}),e.jsxs(te,{children:[i&&e.jsx("p",{children:"Hesaplar yükleniyor..."}),e.jsxs(ge,{onSubmit:ze,children:[e.jsx(ye,{label:"İşlem Tarihi",value:h,onChange:a=>{N(a),_(n=>({...n,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(y,{htmlFor:"advanceReturnAccountId",children:"Hesap Seç"}),e.jsxs(R,{id:"advanceReturnAccountId",name:"accountId",value:d.accountId,onChange:E,required:!0,className:"mb-3",disabled:i,children:[e.jsx("option",{value:"",children:"Seçiniz"}),c.length>0?c.map(a=>e.jsxs("option",{value:a.id,children:[a.userName," (",a.currency,")"]},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Hesap bulunamadı"})]}),e.jsx(y,{htmlFor:"advanceReturnAmount",children:"İade Tutarı"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(J,{type:"number",id:"advanceReturnAmount",name:"amount",value:d.amount,onChange:E,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(R,{name:"currency",value:d.currency,onChange:E,style:{width:"100px"},disabled:i,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(y,{htmlFor:"advanceReturnDescription",children:"Açıklama"}),e.jsx(be,{name:"description",rows:3,value:d.description,onChange:E,placeholder:"Ör: Avans iadesi",className:"mb-3"}),e.jsxs(le,{children:[e.jsx(D,{color:"primary",type:"submit",disabled:i,children:"Avans İadesi Kaydet"}),e.jsx(D,{color:"secondary",onClick:()=>{u(a=>({...a,advanceReturn:!1})),_({date:l().format("YYYY-MM-DD"),accountId:"",amount:"",currency:"TRY",description:""}),N(l())},children:"İptal"})]})]})]})]}),e.jsxs(re,{visible:r.debtCredit,backdrop:"true",keyboard:!0,onClose:()=>{u(a=>({...a,debtCredit:!1})),z({transactionType:"Alacak",date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",description:"",expenseMainCategoryId:"",expenseSubCategoryId:""}),w(l())},children:[e.jsx(se,{children:e.jsx(ie,{children:"Borç/Alacak Fişleri"})}),e.jsx(te,{children:e.jsxs(ge,{onSubmit:$e,children:[e.jsx("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:e.jsx("p",{className:"mb-0",children:"Herhangi bir ödeme, masraf, maaş ya da prim işlemi olmadan çalışanın bakiyesini değiştirmek için borç ya da alacak fişi kaydı oluşturabilirsiniz. Çalışanın güncel bakiyesi burada gireceğiniz tutar kadar değişecektir."})}),e.jsx(y,{htmlFor:"transactionType",children:"İşlem Tipi"}),e.jsxs(R,{id:"transactionType",name:"transactionType",value:m.transactionType,onChange:B,className:"mb-3",children:[e.jsx("option",{value:"Alacak",children:"Alacak Fişi"}),e.jsx("option",{value:"Borç",children:"Borç Fişi"})]}),e.jsx("p",{className:"mb-3",children:m.transactionType==="Alacak"?"Çalışan alacaklanacak.":"Çalışan borçlanacak."}),e.jsx(y,{htmlFor:"expenseMainCategoryId",className:"mt-3",children:"Masraf Ana Kategorisi"}),e.jsxs(R,{id:"expenseMainCategoryId",name:"expenseMainCategoryId",value:m.expenseMainCategoryId,onChange:B,className:"mb-3",disabled:i,children:[e.jsx("option",{value:"",children:"Seçiniz (İsteğe bağlı)"}),M.length>0?M.map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Ana kategoriler yüklenemedi"})]}),e.jsx(y,{htmlFor:"expenseSubCategoryId",className:"mt-3",children:"Masraf Alt Kategorisi"}),e.jsxs(R,{id:"expenseSubCategoryId",name:"expenseSubCategoryId",value:m.expenseSubCategoryId,onChange:B,className:"mb-3",disabled:i||!m.expenseMainCategoryId,children:[e.jsx("option",{value:"",children:"Seçiniz (İsteğe bağlı)"}),q.filter(a=>{var n;return((n=a.masrafAnaKategoriId)==null?void 0:n.toString())===m.expenseMainCategoryId}).map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id))]}),e.jsx(ye,{label:"İşlem Tarihi",value:Y,onChange:a=>{w(a),z(n=>({...n,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(y,{htmlFor:"debtCreditAmount",children:"Tutar"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(J,{type:"number",name:"amount",id:"debtCreditAmount",value:m.amount,onChange:B,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(R,{name:"currency",value:m.currency,onChange:B,style:{width:"100px"},disabled:i,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(y,{htmlFor:"debtCreditDescription",children:"Açıklama"}),e.jsx(be,{name:"description",rows:3,value:m.description,onChange:B,placeholder:"Ör: Borç/Alacak düzeltmesi",className:"mb-3"}),e.jsxs(le,{children:[e.jsx(D,{color:"primary",type:"submit",disabled:i,children:"Kaydet"}),e.jsx(D,{color:"secondary",onClick:()=>{u(a=>({...a,debtCredit:!1})),z({transactionType:"Alacak",date:l().format("YYYY-MM-DD"),amount:"",currency:"TRY",description:"",expenseMainCategoryId:"",expenseSubCategoryId:""}),w(l())},children:"Vazgeç"})]})]})})]}),e.jsxs(re,{visible:r.expense,backdrop:"true",keyboard:!0,onClose:()=>{u(a=>({...a,expense:!1})),$({date:l().format("YYYY-MM-DD"),documentNumber:"",expenseMainCategoryId:"",expenseSubCategoryId:"",amount:"",vatRate:"",currency:"TRY",description:""}),xe(l())},children:[e.jsx(se,{children:e.jsx(ie,{children:"Masraf Girişi"})}),e.jsxs(te,{children:[i&&e.jsx("p",{children:"Veriler yükleniyor..."}),e.jsxs(ge,{onSubmit:Ee,children:[e.jsx("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:e.jsx("p",{className:"mb-0",children:"Çalışanınızın size getirdiği masrafları buradan girebilirsiniz. Masraf kaydından sonra çalışan alacaklanır."})}),e.jsx(ye,{label:"Masraf Tarihi",value:pe,onChange:a=>{xe(a),$(n=>({...n,date:a?a.format("YYYY-MM-DD"):""}))}}),e.jsx(y,{htmlFor:"documentNumber",children:"Fiş/Belge No"}),e.jsx(J,{id:"documentNumber",name:"documentNumber",value:C.documentNumber,onChange:ne,placeholder:"Ör: Fatura123",className:"mb-3"}),e.jsx(y,{htmlFor:"expenseMainCategoryId",children:"Masraf Ana Kategorisi"}),e.jsxs(R,{id:"expenseMainCategoryId",name:"expenseMainCategoryId",value:C.expenseMainCategoryId,onChange:ne,required:!0,className:"mb-3",disabled:i,children:[e.jsx("option",{value:"",children:"Seçiniz"}),M.length>0?M.map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id)):e.jsx("option",{value:"",disabled:!0,children:"Ana kategoriler yüklenemedi"})]}),e.jsx(y,{htmlFor:"expenseSubCategoryId",children:"Masraf Alt Kategorisi"}),e.jsxs(R,{id:"expenseSubCategoryId",name:"expenseSubCategoryId",value:C.expenseSubCategoryId,onChange:ne,required:!0,className:"mb-3",disabled:i||!C.expenseMainCategoryId,children:[e.jsx("option",{value:"",children:"Seçiniz"}),q.filter(a=>{var n;return((n=a.masrafAnaKategoriId)==null?void 0:n.toString())===C.expenseMainCategoryId}).map(a=>e.jsx("option",{value:a.id,children:a.adi},a.id))]}),e.jsx(y,{htmlFor:"amount",children:"Tutar (KDV Dahil)"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(J,{type:"number",id:"amount",name:"amount",value:C.amount,onChange:ne,placeholder:"0.00",required:!0,step:"0.01",style:{flex:1,marginRight:"10px"}}),e.jsxs(R,{name:"currency",value:C.currency,onChange:ne,style:{width:"100px"},disabled:i,children:[e.jsx("option",{value:"TRY",children:"TL"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsx(y,{htmlFor:"vatRate",children:"KDV Oranı (%)"}),e.jsx(J,{type:"number",id:"vatRate",name:"vatRate",value:C.vatRate,onChange:ne,placeholder:"Ör: 20",step:"0.01",className:"mb-3"}),e.jsx(y,{htmlFor:"description",children:"Açıklama"}),e.jsx(be,{name:"description",rows:3,value:C.description,onChange:ne,placeholder:"Ör: Seyahat masrafı",className:"mb-3"}),e.jsxs(le,{children:[e.jsx(D,{color:"primary",type:"submit",disabled:i,children:"Masrafı Kaydet"}),e.jsx(D,{color:"secondary",onClick:()=>{u(a=>({...a,expense:!1})),$({date:l().format("YYYY-MM-DD"),documentNumber:"",expenseMainCategoryId:"",expenseSubCategoryId:"",amount:"",vatRate:"",currency:"TRY",description:""}),xe(l())},children:"İptal"})]})]})]})]})]})},De="https://speedsofttest.com/api",ha="https://speedsofttest.com",pa="/default-profile.png",xa=r=>{if(!r||typeof r!="string"||r==="null")return pa;if(r.startsWith("https"))return`${r}?t=${new Date().getTime()}`;const u=r.startsWith("/")?r:`/${r}`;return`${ha}${u}?t=${new Date().getTime()}`},ka=()=>{const[r,u]=p.useState(!1),x=ea(),{employeeId:S}=aa(),{state:b}=na(),{selectedEmployee:c,fetchEmployeeById:Q,deleteEmployee:M,employeeBalances:ce,fetchEmployeeBalance:q,loading:oe,error:A}=ra(),{users:H}=sa(),[k,F]=p.useState([]),[d,_]=p.useState({mainCategories:[],subCategories:[]}),[m,z]=p.useState(!1),[C,$]=p.useState(null),[L,Z]=p.useState([]),[fe,t]=p.useState({accrual:!1,payment:!1,advanceReturn:!1,debtCredit:!1,expense:!1}),h=(i,f="başarılı")=>{Z(ee=>[...ee,{id:Date.now(),message:i,type:f}])},N=async()=>{u(!0)},Y=(i,f={})=>{x(i,{state:f})},w=async()=>{if(console.log("silme baslası"),!(c!=null&&c.id)){h("Silinecek çalışan bulunamadı.","hata"),u(!1);return}const i=await M(c.id);h(i.message,i.success?"başarılı":"hata"),i.success&&x("/app/employees"),u(!1)},pe=p.useCallback(async i=>{var f,ee,W,ae,de;if(!i||isNaN(i)){$("Çalışan ID'si eksik veya geçersiz."),h("Çalışan bilgisi eksik","hata");return}z(!0);try{const E=await K.get(`${De}/calisancari/calisancaricalisan-get-by-Id/${i}`,{headers:{accept:"*/*"}});console.log("ÇalışanCari Get By ID: ",E);const B=E.data,ve=(Array.isArray(B)?B:B?[B]:[]).map(P=>({id:P.id,tarih:P.tarih||"",masrafAnaKategoriId:P.masrafAnaKategoriId||0,masrafAltKategoriId:P.masrafAltKategoriId||0,aciklama:P.aciklama||"-",borc:P.borc||0,alacak:P.alacak||0,bakiye:P.bakiye||0,calisanId:P.calisanId||i,durumu:P.durumu||0}));F(ve),$(null),await q(i)}catch(E){const B=((ee=(f=E.response)==null?void 0:f.data)==null?void 0:ee.message)||E.message;console.error("Cari işlemler hatası:",{message:B,status:(W=E.response)==null?void 0:W.status,url:(ae=E.config)==null?void 0:ae.url}),((de=E.response)==null?void 0:de.status)===404?($(`Çalışan ID ${i} için cari işlem bulunamadı.`),h(`Çalışan ID ${i} için cari işlem bulunamadı`,"hata")):($("Cari işlemler alınamadı: "+B),h("Cari işlemler yüklenemedi: "+B,"hata")),F([])}finally{z(!1)}},[q]),xe=async()=>{try{const i=await K.get(`${De}/masrafAnaKategori/masrafAnaKategori-get-all`,{headers:{accept:"*/*"}}),f=await K.get(`${De}/masrafAltKategori/masrafAltKategori-get-all`,{headers:{accept:"*/*"}}),ee=Array.isArray(i.data)?i.data:[],W=Array.isArray(f.data)?f.data:[];_({mainCategories:ee,subCategories:W})}catch(i){console.error("Masraf kategorileri alınamadı:",i),h("Masraf kategorileri yüklenemedi","hata")}};return p.useEffect(()=>{S&&S!=="new"&&!isNaN(S)?(Q(Number(S)),pe(Number(S)),xe()):($("Çalışan ID'si eksik veya geçersiz."),h("Çalışan bilgisi eksik veya geçersiz","hata"),x("/app/employees"))},[S,Q,pe,x]),oe?e.jsx("div",{children:"Yükleniyor..."}):A||!c?e.jsxs(Ae,{children:[e.jsx(Se,{children:"Çalışan Bilgisi"}),e.jsxs(Ye,{children:[e.jsx("p",{children:A||"Çalışan bulunamadı."}),e.jsx(D,{color:"primary",onClick:()=>x("/app/employees"),children:"Geri Dön"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(ia,{toasts:L}),e.jsxs(ta,{children:[e.jsx(Ie,{xs:12,children:e.jsx(oa,{employee:{...c,fotograf:xa(c.fotograf),balance:ce[c.id]!==void 0?`${ce[c.id].toLocaleString("tr-TR")} ${c.paraBirimi||"TRY"}`:"Veri bulunamadı"}})}),e.jsx(Ie,{xs:12,className:"mb-3",children:e.jsx(da,{onUpdate:()=>Y("/app/employee-update",{employee:c,mode:"update"}),onDelete:N,onModalToggle:i=>t(f=>({...f,[i]:!0})),onExpense:()=>t(i=>({...i,expense:!0})),onStatement:()=>Y(`/app/employee-statement/${S}`,{employee:c,expenseCategories:d}),onDocuments:()=>Y("/app/employee-documents",{employeeId:c.id}),disableDocuments:!0})}),e.jsx(Ie,{xs:12,children:e.jsx(ua,{transactions:k,loading:m,error:C,currency:(c==null?void 0:c.paraBirimi)||"TRY",onPrint:(i,f)=>h(i,f),addToast:h,onRefresh:()=>pe(c.id),expenseMainCategories:d.mainCategories||[],expenseSubCategories:d.subCategories||[]})})]}),e.jsxs(re,{visible:r,onClose:()=>u(!1),backdrop:"static",children:[e.jsx(se,{children:e.jsx(ie,{children:"Silme Onayı"})}),e.jsx(te,{children:e.jsxs("p",{children:["Çalışan ",e.jsxs("strong",{children:['"',c==null?void 0:c.adiSoyadi,'"']})," silinecek. Emin misiniz?"]})}),e.jsxs(le,{children:[e.jsx(D,{color:"secondary",onClick:()=>u(!1),children:"İptal"}),e.jsx(D,{color:"danger",onClick:w,children:"Sil"})]})]}),e.jsx(ma,{modalState:fe,setModalState:t,employeeId:c.id,onSubmit:()=>pe(c.id),addToast:h})]})};export{ka as default};
